<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.62.2" />
    <meta name="description" content="Do Learn">
<meta name="author" content="Myeongjin Kim">

    <link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
    <title>Ad Hoc Commands :: Ibiza</title>

    
    <link href="/css/nucleus.css?1583379995" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1583379995" rel="stylesheet">
    <link href="/css/hybrid.css?1583379995" rel="stylesheet">
    <link href="/css/featherlight.min.css?1583379995" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1583379995" rel="stylesheet">
    <link href="/css/auto-complete.css?1583379995" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1583379995" rel="stylesheet">
    <link href="/css/theme.css?1583379995" rel="stylesheet">
    <link href="/css/hugo-theme.css?1583379995" rel="stylesheet">
    
      <link href="/css/theme-mine.css?1583379995" rel="stylesheet">
    

    <script src="/js/jquery-3.3.1.min.js?1583379995"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-123-45', 'auto');
	
	ga('send', 'pageview');
}
</script>

  </head>
  <body class="" data-url="/ansible/ansible-for-devops/ad-hoc-commands/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <div>
<img src="https://avatars3.githubusercontent.com/u/6358016?s=460&v=4" style="border-radius: 50%"  width="50%" height="50%"/>
</div>
<h3><p style="color: white">Ibiza</p></h3>
<p style="color: white">기록하는 습관</p>
    </div>
    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/ibiza/" title="Ibiza" class="dd-item 
        
        
        
        ">
      <a href="/ibiza/">
          <i class='fas fa-angle-right'></i>&nbsp;Ibiza
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/ibiza/importance-of-record/" title="Importance of Record" class="dd-item ">
        <a href="/ibiza/importance-of-record/">
        <i class='fas fa-minus'></i>&nbsp;Importance of Record
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ibiza/2020-plan/" title="2020 Plan" class="dd-item ">
        <a href="/ibiza/2020-plan/">
        <i class='fas fa-minus'></i>&nbsp;2020 Plan
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ibiza/ibiza-project/" title="Ibiza Project" class="dd-item ">
        <a href="/ibiza/ibiza-project/">
        <i class='fas fa-minus'></i>&nbsp;Ibiza Project
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ibiza/2020-new-year-holiday-plans/" title="2020 New Year Holiday Plans" class="dd-item ">
        <a href="/ibiza/2020-new-year-holiday-plans/">
        <i class='fas fa-minus'></i>&nbsp;2020 New Year Holiday Plans
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/harbor/" title="Harbor" class="dd-item 
        
        
        
        ">
      <a href="/harbor/">
          <i class='fas fa-angle-right'></i>&nbsp;Harbor
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/harbor/install/" title="Harbor 설치" class="dd-item ">
        <a href="/harbor/install/">
        <i class='fas fa-minus'></i>&nbsp;Harbor 설치
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/git/" title="Git" class="dd-item 
        
        
        
        ">
      <a href="/git/">
          <i class='fas fa-angle-right'></i>&nbsp;Git
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/git/gitignore/" title="Gitignore 설정" class="dd-item ">
        <a href="/git/gitignore/">
        <i class='fas fa-minus'></i>&nbsp;Gitignore 설정
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/python/" title="Python" class="dd-item 
        
        
        
        ">
      <a href="/python/">
          <i class='fas fa-angle-right'></i>&nbsp;Python
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/python/python-beautiful-cli/" title="[번역]Python을 통해 이쁜 CLI 만들기" class="dd-item ">
        <a href="/python/python-beautiful-cli/">
        <i class='fas fa-minus'></i>&nbsp;[번역]Python을 통해 이쁜 CLI 만들기
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/docker/" title="Docker" class="dd-item 
        
        
        
        ">
      <a href="/docker/">
          <i class='fas fa-angle-right'></i>&nbsp;Docker
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/docker/use-docker-without-sudo/" title="Docker를 sudo없이 실행하기" class="dd-item ">
        <a href="/docker/use-docker-without-sudo/">
        <i class='fas fa-minus'></i>&nbsp;Docker를 sudo없이 실행하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docker/connect-container-to-container/" title="[docker-compose] container에서 다른 container로 접속하기" class="dd-item ">
        <a href="/docker/connect-container-to-container/">
        <i class='fas fa-minus'></i>&nbsp;[docker-compose] container에서 다른 container로 접속하기
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/jenkins/" title="Jenkins" class="dd-item 
        
        
        
        ">
      <a href="/jenkins/">
          <i class='fas fa-angle-right'></i>&nbsp;Jenkins
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/jenkins/install/" title="Jenkins Install" class="dd-item ">
        <a href="/jenkins/install/">
        <i class='fas fa-minus'></i>&nbsp;Install
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/iac/" title="IaC" class="dd-item 
        
        
        
        ">
      <a href="/iac/">
          <i class='fas fa-angle-right'></i>&nbsp;IaC
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/iac/translate-what-is-infrastructure-as-a-code/" title="[번역] What Is Infrastructure as a Code? How It Works, Best Practices, Tutorials" class="dd-item ">
        <a href="/iac/translate-what-is-infrastructure-as-a-code/">
        <i class='fas fa-minus'></i>&nbsp;[Translate] What Is Infrastructure as a Code
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/cicd/" title="CICD" class="dd-item 
        
        
        
        ">
      <a href="/cicd/">
          <i class='fas fa-angle-right'></i>&nbsp;CICD
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/cicd/deploy-strategy/" title="Deploy Strategy" class="dd-item ">
        <a href="/cicd/deploy-strategy/">
        <i class='fas fa-minus'></i>&nbsp;Deploy Strategy
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/css/" title="CSS" class="dd-item 
        
        
        
        ">
      <a href="/css/">
          <i class='fas fa-angle-right'></i>&nbsp;CSS
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/css/greater-than-sign/" title="Greater Than Sign" class="dd-item ">
        <a href="/css/greater-than-sign/">
        <i class='fas fa-minus'></i>&nbsp;Greater Than Sign
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/prometheus/" title="Prometheus" class="dd-item 
        
        
        
        ">
      <a href="/prometheus/">
          <i class='fas fa-angle-right'></i>&nbsp;Prometheus
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/prometheus/install/" title="Install Prometheus" class="dd-item ">
        <a href="/prometheus/install/">
        <i class='fas fa-minus'></i>&nbsp;Install
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/prometheus/federation/" title="Federation" class="dd-item ">
        <a href="/prometheus/federation/">
        <i class='fas fa-minus'></i>&nbsp;Federation
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/kubernetes/" title="Kubernetes" class="dd-item 
        
        
        
        ">
      <a href="/kubernetes/">
          <i class='fas fa-angle-right'></i>&nbsp;Kubernetes
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/kubernetes/installation/" title="Install" class="dd-item 
        
        
        
        ">
      <a href="/kubernetes/installation/">
          <i class='fas fa-angle-right'></i>&nbsp;Install
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/installation/overview/" title="Overview" class="dd-item ">
        <a href="/kubernetes/installation/overview/">
        <i class='fas fa-minus'></i>&nbsp;Overview
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/installation/install-kubeadm/" title="Install Kubeadm" class="dd-item ">
        <a href="/kubernetes/installation/install-kubeadm/">
        <i class='fas fa-minus'></i>&nbsp;Install Kubeadm
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/installation/create-a-single-control-plane-cluster-with-kubeadm/" title="Create a Single Control Plane Cluster With Kubeadm" class="dd-item ">
        <a href="/kubernetes/installation/create-a-single-control-plane-cluster-with-kubeadm/">
        <i class='fas fa-minus'></i>&nbsp;Create a Single Control Plane Cluster With Kubeadm
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/kubernetes/concepts/" title="Concepts" class="dd-item 
        
        
        
        ">
      <a href="/kubernetes/concepts/">
          <i class='fas fa-angle-right'></i>&nbsp;Concepts
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/concepts/controllers-overview/" title="Controllers Overview" class="dd-item ">
        <a href="/kubernetes/concepts/controllers-overview/">
        <i class='fas fa-minus'></i>&nbsp;Controllers Overview
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/concepts/pods/" title="Pods" class="dd-item ">
        <a href="/kubernetes/concepts/pods/">
        <i class='fas fa-minus'></i>&nbsp;Pods
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/stern/" title="Stern을 이용하여 여러 pod의 log를 한번에 확인하기" class="dd-item ">
        <a href="/kubernetes/stern/">
        <i class='fas fa-minus'></i>&nbsp;Stern을 이용하여 여러 pod의 log를 한번에 확인하기
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/hugo/" title="Hugo" class="dd-item 
        
        
        
        ">
      <a href="/hugo/">
          <i class='fas fa-angle-right'></i>&nbsp;Hugo
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/hugo/ibiza/" title="Ibiza" class="dd-item 
        
        
        
        ">
      <a href="/hugo/ibiza/">
          <i class='fas fa-angle-right'></i>&nbsp;Ibiza
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/hugo/ibiza/font-change/" title="Font Change" class="dd-item ">
        <a href="/hugo/ibiza/font-change/">
        <i class='fas fa-minus'></i>&nbsp;Font Change
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/hugo/insert-comment/" title="Hugo에 Comment 추가하기 (Utterance)" class="dd-item ">
        <a href="/hugo/insert-comment/">
        <i class='fas fa-minus'></i>&nbsp;Hugo에 Comment 추가하기 (Utterance)
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/hugo/hugo-with-html/" title="HUGO로 HTML이 되지 않을 때 가능하게 하는 방법" class="dd-item ">
        <a href="/hugo/hugo-with-html/">
        <i class='fas fa-minus'></i>&nbsp;hugo with html
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/spinnaker/" title="Spinnaker" class="dd-item 
        
        
        
        ">
      <a href="/spinnaker/">
          <i class='fas fa-angle-right'></i>&nbsp;Spinnaker
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/spinnaker/installation/" title="Installation" class="dd-item 
        
        
        
        ">
      <a href="/spinnaker/installation/">
          <i class='fas fa-angle-right'></i>&nbsp;Installation
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/spinnaker/installation/overview/" title="Overview" class="dd-item ">
        <a href="/spinnaker/installation/overview/">
        <i class='fas fa-minus'></i>&nbsp;Overview
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/spinnaker/installation/install-halyard/" title="Install Halyard" class="dd-item ">
        <a href="/spinnaker/installation/install-halyard/">
        <i class='fas fa-minus'></i>&nbsp;Install Halyard
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/spinnaker/installation/choose-cloud-providers/" title="Choose Cloud Providers" class="dd-item ">
        <a href="/spinnaker/installation/choose-cloud-providers/">
        <i class='fas fa-minus'></i>&nbsp;Choose Cloud Providers
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/spinnaker/installation/choose-your-environment/" title="Choose Your Environment" class="dd-item ">
        <a href="/spinnaker/installation/choose-your-environment/">
        <i class='fas fa-minus'></i>&nbsp;Choose Your Environment
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/spinnaker/installation/choose-a-storage-service/" title="Choose a Storage Service" class="dd-item ">
        <a href="/spinnaker/installation/choose-a-storage-service/">
        <i class='fas fa-minus'></i>&nbsp;Choose a Storage Service
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/spinnaker/installation/deploy-and-connect/" title="Deploy and Connect" class="dd-item ">
        <a href="/spinnaker/installation/deploy-and-connect/">
        <i class='fas fa-minus'></i>&nbsp;Deploy and Connect
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/spinnaker/installation/install-in-air-gaped-environment/" title="Install in Air Gaped Environment" class="dd-item ">
        <a href="/spinnaker/installation/install-in-air-gaped-environment/">
        <i class='fas fa-minus'></i>&nbsp;Install in Air Gaped Environment
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/spinnaker/canaryanalysis/" title="CanaryAnalysis" class="dd-item 
        
        
        
        ">
      <a href="/spinnaker/canaryanalysis/">
          <i class='fas fa-angle-right'></i>&nbsp;CanaryAnalysis
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/spinnaker/canaryanalysis/canary-analysis/" title="Canary Analysis" class="dd-item ">
        <a href="/spinnaker/canaryanalysis/canary-analysis/">
        <i class='fas fa-minus'></i>&nbsp;Canary Analysis
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/spinnaker/tips/" title="Tips" class="dd-item 
        
        
        
        ">
      <a href="/spinnaker/tips/">
          <i class='fas fa-angle-right'></i>&nbsp;Tips
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/spinnaker/tips/pipeline-expressions/" title="Pipeline Expressions" class="dd-item ">
        <a href="/spinnaker/tips/pipeline-expressions/">
        <i class='fas fa-minus'></i>&nbsp;Pipeline Expressions
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/ansible/" title="Ansible" class="dd-item 
        parent
        
        
        ">
      <a href="/ansible/">
          <i class='fas fa-angle-right'></i>&nbsp;Ansible
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/ansible/ansible-for-devops/" title="Ansible for DevOps" class="dd-item 
        parent
        
        
        ">
      <a href="/ansible/ansible-for-devops/">
          <i class='fas fa-angle-right'></i>&nbsp;Ansible for DevOps
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/ansible/ansible-for-devops/getting-started-with-ansible/" title="Chapter 1 - Getting Started With Ansible" class="dd-item ">
        <a href="/ansible/ansible-for-devops/getting-started-with-ansible/">
        <i class='fas fa-minus'></i>&nbsp;Getting Started With Ansible
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ansible/ansible-for-devops/local-infrastructure-development-ansible-and-vagrant/" title="Chapter 2 - Local Infrastructure Development: Ansible and Vagrant" class="dd-item ">
        <a href="/ansible/ansible-for-devops/local-infrastructure-development-ansible-and-vagrant/">
        <i class='fas fa-minus'></i>&nbsp;Local Infrastructure Development: Ansible and Vagrant
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ansible/ansible-for-devops/ad-hoc-commands/" title="Ad Hoc Commands" class="dd-item active">
        <a href="/ansible/ansible-for-devops/ad-hoc-commands/">
        <i class='fas fa-minus'></i>&nbsp;Ad Hoc Commands
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ansible/ansible-for-devops/ansible-playbooks/" title="Ansible Playbooks" class="dd-item ">
        <a href="/ansible/ansible-for-devops/ansible-playbooks/">
        <i class='fas fa-minus'></i>&nbsp;Ansible Playbooks
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/ansible/ansible-for-devops/chapter5/" title="Chapter5" class="dd-item 
        
        
        
        ">
      <a href="/ansible/ansible-for-devops/chapter5/">
          <i class='fas fa-angle-right'></i>&nbsp;Chapter5
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/ansible/ansible-for-devops/chapter5/ansible-playbooks-beyond-the-basics/" title="Ansible Playbooks Beyond the Basics" class="dd-item ">
        <a href="/ansible/ansible-for-devops/chapter5/ansible-playbooks-beyond-the-basics/">
        <i class='fas fa-minus'></i>&nbsp;Ansible Playbooks Beyond the Basics
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ansible/ansible-for-devops/chapter5/handover/" title="Handover" class="dd-item ">
        <a href="/ansible/ansible-for-devops/chapter5/handover/">
        <i class='fas fa-minus'></i>&nbsp;Handover
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ansible/create-vm-with-ansible-libvirt/" title="Create Vm With Ansible Libvirt" class="dd-item ">
        <a href="/ansible/create-vm-with-ansible-libvirt/">
        <i class='fas fa-minus'></i>&nbsp;Create Vm With Ansible Libvirt
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/ubuntu/" title="Ubuntu" class="dd-item 
        
        
        
        ">
      <a href="/ubuntu/">
          <i class='fas fa-angle-right'></i>&nbsp;Ubuntu
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/ubuntu/tools/" title="Tools" class="dd-item 
        
        
        
        ">
      <a href="/ubuntu/tools/">
          <i class='fas fa-angle-right'></i>&nbsp;Tools
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/tools/tmux/" title="Tmux" class="dd-item ">
        <a href="/ubuntu/tools/tmux/">
        <i class='fas fa-minus'></i>&nbsp;Tmux
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/ubuntu/network/" title="Network" class="dd-item 
        
        
        
        ">
      <a href="/ubuntu/network/">
          <i class='fas fa-angle-right'></i>&nbsp;Network
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/network/netplan/" title="Netplan으로 static IP 할당받기" class="dd-item ">
        <a href="/ubuntu/network/netplan/">
        <i class='fas fa-minus'></i>&nbsp;Netplan으로 static IP 할당받기
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/start-tmux-after-reboot/" title="reboot 후에 tmux를 실행시켜 원하는 작업을 하기" class="dd-item ">
        <a href="/ubuntu/start-tmux-after-reboot/">
        <i class='fas fa-minus'></i>&nbsp;reboot 후에 tmux를 실행시켜 원하는 작업을 하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/oh-my-zsh-home-end-key/" title="oh-my-zsh에서 home key와 end key가 안될 때 해결방법" class="dd-item ">
        <a href="/ubuntu/oh-my-zsh-home-end-key/">
        <i class='fas fa-minus'></i>&nbsp;oh-my-zsh에서 home key와 end key가 안될 때 해결방법
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/base64-encode-decode/" title="Ubuntu에서 Base64로 인코딩, 디코딩하기" class="dd-item ">
        <a href="/ubuntu/base64-encode-decode/">
        <i class='fas fa-minus'></i>&nbsp;Ubuntu에서 Base64로 인코딩, 디코딩하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/file-edit-without-editor/" title="Editor(vi)가 없을 때 파일 수정하기" class="dd-item ">
        <a href="/ubuntu/file-edit-without-editor/">
        <i class='fas fa-minus'></i>&nbsp;Editor(vi)가 없을 때 파일 수정하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/check-listen-port/" title="열려있는 포트 확인하기" class="dd-item ">
        <a href="/ubuntu/check-listen-port/">
        <i class='fas fa-minus'></i>&nbsp;열려있는 포트 확인하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/using-watch-with-pipes/" title="pipe를 사용한 명령어를 watch로 확인하기" class="dd-item ">
        <a href="/ubuntu/using-watch-with-pipes/">
        <i class='fas fa-minus'></i>&nbsp;pipe를 사용한 명령어를 watch로 확인하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/use-alias-in-watch/" title="watch를 사용할 때 alias 이용하기" class="dd-item ">
        <a href="/ubuntu/use-alias-in-watch/">
        <i class='fas fa-minus'></i>&nbsp;watch를 사용할 때 alias 이용하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/ssh-without-password/" title="password 없이 ssh 접속하기" class="dd-item ">
        <a href="/ubuntu/ssh-without-password/">
        <i class='fas fa-minus'></i>&nbsp;password 없이 ssh 접속하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/ssh-tunneling/" title="SSH Tunneling 사용법" class="dd-item ">
        <a href="/ubuntu/ssh-tunneling/">
        <i class='fas fa-minus'></i>&nbsp;SSH Tunneling 사용법
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/ssh-with-jump/" title="Gateway를 이용하여 SSH 접속하기" class="dd-item ">
        <a href="/ubuntu/ssh-with-jump/">
        <i class='fas fa-minus'></i>&nbsp;Gateway를 이용하여 SSH 접속하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/change-hostname/" title="Hostname 변경하기" class="dd-item ">
        <a href="/ubuntu/change-hostname/">
        <i class='fas fa-minus'></i>&nbsp;Hostname 변경하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/unattended-ubuntu/" title="추가 입력절차(prompt) 없이 Ubuntu 설치하는 이미지 만들기" class="dd-item ">
        <a href="/ubuntu/unattended-ubuntu/">
        <i class='fas fa-minus'></i>&nbsp;추가 입력절차(prompt) 없이 Ubuntu 설치하는 이미지 만들기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/how-to-edit-boot-parameter-during-install/" title="Ubuntu 설치 시 Boot Parameter를 수정하기" class="dd-item ">
        <a href="/ubuntu/how-to-edit-boot-parameter-during-install/">
        <i class='fas fa-minus'></i>&nbsp;Ubuntu 설치 시 Boot Parameter를 수정하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/how-to-use-sudo-without-password/" title="sudo를 password 없이 사용하기" class="dd-item ">
        <a href="/ubuntu/how-to-use-sudo-without-password/">
        <i class='fas fa-minus'></i>&nbsp;sudo를 password 없이 사용하기
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/english/" title="English" class="dd-item 
        
        
        
        ">
      <a href="/english/">
          <i class='fas fa-angle-right'></i>&nbsp;English
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/english/himym/" title="HIMWM" class="dd-item 
        
        
        
        ">
      <a href="/english/himym/">
          <i class='fas fa-angle-right'></i>&nbsp;HIMWM
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/english/himym/season1/" title="Season1" class="dd-item 
        
        
        
        ">
      <a href="/english/himym/season1/">
          <i class='fas fa-angle-right'></i>&nbsp;Season1
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/english/himym/season1/episode1/" title="Episode1" class="dd-item ">
        <a href="/english/himym/season1/episode1/">
        <i class='fas fa-minus'></i>&nbsp;Episode1
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/english/himym/season1/episode5/" title="Episode5" class="dd-item ">
        <a href="/english/himym/season1/episode5/">
        <i class='fas fa-minus'></i>&nbsp;Episode5
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/english/himym/season1/episode6/" title="Episode6" class="dd-item ">
        <a href="/english/himym/season1/episode6/">
        <i class='fas fa-minus'></i>&nbsp;Episode6
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/english/himym/season1/episode7/" title="Episode7" class="dd-item ">
        <a href="/english/himym/season1/episode7/">
        <i class='fas fa-minus'></i>&nbsp;Episode7
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/english/himym/season1/episode8/" title="Episode8" class="dd-item ">
        <a href="/english/himym/season1/episode8/">
        <i class='fas fa-minus'></i>&nbsp;Episode8
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/english/himym/season1/episode9/" title="Episode9" class="dd-item ">
        <a href="/english/himym/season1/episode9/">
        <i class='fas fa-minus'></i>&nbsp;Episode9
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/english/himym/season1/episode10/" title="Episode10" class="dd-item ">
        <a href="/english/himym/season1/episode10/">
        <i class='fas fa-minus'></i>&nbsp;Episode10
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/english/himym/season1/episode11/" title="Episode11" class="dd-item ">
        <a href="/english/himym/season1/episode11/">
        <i class='fas fa-minus'></i>&nbsp;Episode11
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/english/himym/season1/episode12/" title="Episode12" class="dd-item ">
        <a href="/english/himym/season1/episode12/">
        <i class='fas fa-minus'></i>&nbsp;Episode12
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/english/himym/season1/episode13/" title="Episode13" class="dd-item ">
        <a href="/english/himym/season1/episode13/">
        <i class='fas fa-minus'></i>&nbsp;Episode13
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/english/himym/season1/episode14/" title="Episode14" class="dd-item ">
        <a href="/english/himym/season1/episode14/">
        <i class='fas fa-minus'></i>&nbsp;Episode14
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/english/himym/season1/episode15/" title="Episode15" class="dd-item ">
        <a href="/english/himym/season1/episode15/">
        <i class='fas fa-minus'></i>&nbsp;Episode15
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/english/himym/season1/episode16/" title="Episode16" class="dd-item ">
        <a href="/english/himym/season1/episode16/">
        <i class='fas fa-minus'></i>&nbsp;Episode16
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/english/himym/season1/episode17/" title="Episode17" class="dd-item ">
        <a href="/english/himym/season1/episode17/">
        <i class='fas fa-minus'></i>&nbsp;Episode17
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/english/himym/season1/episode18/" title="Episode18" class="dd-item ">
        <a href="/english/himym/season1/episode18/">
        <i class='fas fa-minus'></i>&nbsp;Episode18
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/english/himym/season1/episode19/" title="Episode19" class="dd-item ">
        <a href="/english/himym/season1/episode19/">
        <i class='fas fa-minus'></i>&nbsp;Episode19
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/english/himym/season1/episode20/" title="Episode20" class="dd-item ">
        <a href="/english/himym/season1/episode20/">
        <i class='fas fa-minus'></i>&nbsp;Episode20
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/english/himym/season1/episode21/" title="Episode21" class="dd-item ">
        <a href="/english/himym/season1/episode21/">
        <i class='fas fa-minus'></i>&nbsp;Episode21
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/english/himym/season1/episode22/" title="Episode22" class="dd-item ">
        <a href="/english/himym/season1/episode22/">
        <i class='fas fa-minus'></i>&nbsp;Episode22
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/english/himym/season2/" title="Season2" class="dd-item 
        
        
        
        ">
      <a href="/english/himym/season2/">
          <i class='fas fa-angle-right'></i>&nbsp;Season2
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/english/himym/season2/episode01/" title="Episode01" class="dd-item ">
        <a href="/english/himym/season2/episode01/">
        <i class='fas fa-minus'></i>&nbsp;Episode01
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/english/himym/season2/episode03/" title="Episode03" class="dd-item ">
        <a href="/english/himym/season2/episode03/">
        <i class='fas fa-minus'></i>&nbsp;Episode03
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="https://github.com/KimMJ"><i class='fab fa-github'></i> Github</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://gohugo.io/"><i class='fas fa-bookmark'></i> Hugo Documentation</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://learn.netlify.com/en/"><i class='fas fa-bookmark'></i> Hugo Theme Learn</a>
              </li>
          
              <li> 
                  <a class="padding" href="http://kimmj.github.io/tags"><i class='fas fa-tags'></i> Tags</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            
            
          
          
            <a href='/'>Ibiza</a> > <a href='/ansible/'>Ansible</a> > <a href='/ansible/ansible-for-devops/'>Ansible for DevOps</a> > Ad Hoc Commands
          
         
          
         
          
         
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#conducting-an-orchestra">Conducting an orchestra</a></li>
    <li><a href="#build-infrastructure-with-vagrant-for-testing">Build infrastructure with Vagrant for testing</a>
      <ul>
        <li><a href="#inventory-file-for-multiple-servers">Inventory file for multiple servers</a></li>
      </ul>
    </li>
    <li><a href="#your-first-ad-hoc-commands">Your first ad-hoc commands</a>
      <ul>
        <li><a href="#discover-ansibles-parallel-nature">Discover Ansible's parallel nature</a></li>
      </ul>
    </li>
    <li><a href="#learning-about-your-environment">Learning about your environment</a></li>
    <li><a href="#make-changes-using-ansible-modules">Make changes using Ansible modules</a></li>
    <li><a href="#configure-groups-of-servers-or-individual-servers">Configure groups of servers, or individual servers</a>
      <ul>
        <li><a href="#configure-the-database-servers">Configure the Database servers</a></li>
        <li><a href="#make-changes-to-just-one-server">Make changes to just one server</a></li>
      </ul>
    </li>
    <li><a href="#manage-users-and-groups">Manage users and groups</a></li>
    <li><a href="#manage-files-and-directories">Manage files and directories</a>
      <ul>
        <li><a href="#get-information-about-a-file">Get information about a file</a></li>
        <li><a href="#copy-a-file-to-the-servers">Copy a file to the servers</a></li>
        <li><a href="#retrieve-a-file-from-the-servers">Retrieve a file from the servers</a></li>
        <li><a href="#create-directories-and-files">Create directories and files</a></li>
        <li><a href="#delete-directories-and-files">Delete directories and files</a></li>
      </ul>
    </li>
    <li><a href="#run-operatioins-in-the-background">Run operatioins in the background</a>
      <ul>
        <li><a href="#update-servers-asynchronously-monitoring-progress">Update servers asynchronously, monitoring progress</a></li>
        <li><a href="#fire-and-forget-tasks">Fire-and-forget tasks</a></li>
      </ul>
    </li>
    <li><a href="#check-log-files">Check log files</a></li>
    <li><a href="#manage-cron-jobs">Manage cron jobs</a></li>
    <li><a href="#deploy-a-version-controlled-application">Deploy a version-controlled application</a></li>
    <li><a href="#ansibles-ssh-connection-history">Ansible's SSH connection history</a>
      <ul>
        <li><a href="#paramiko">Paramiko</a></li>
        <li><a href="#openssh-default">OpenSSH (default)</a></li>
        <li><a href="#accelerated-mode">Accelerated Mode</a></li>
        <li><a href="#faster-openssh-in-ansible-15">Faster OpenSSH in Ansible 1.5+</a></li>
      </ul>
    </li>
    <li><a href="#summary">Summary</a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
<div class="tags">

  <a class="tag-link" href="/tags/ansible">ansible</a>

  <a class="tag-link" href="/tags/ansible-for-devops">ansible-for-devops</a>

</div>

        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Ad Hoc Commands
            </h1>
          

        



<nav id="TableOfContents">
  <ul>
    <li><a href="#conducting-an-orchestra">Conducting an orchestra</a></li>
    <li><a href="#build-infrastructure-with-vagrant-for-testing">Build infrastructure with Vagrant for testing</a>
      <ul>
        <li><a href="#inventory-file-for-multiple-servers">Inventory file for multiple servers</a></li>
      </ul>
    </li>
    <li><a href="#your-first-ad-hoc-commands">Your first ad-hoc commands</a>
      <ul>
        <li><a href="#discover-ansibles-parallel-nature">Discover Ansible's parallel nature</a></li>
      </ul>
    </li>
    <li><a href="#learning-about-your-environment">Learning about your environment</a></li>
    <li><a href="#make-changes-using-ansible-modules">Make changes using Ansible modules</a></li>
    <li><a href="#configure-groups-of-servers-or-individual-servers">Configure groups of servers, or individual servers</a>
      <ul>
        <li><a href="#configure-the-database-servers">Configure the Database servers</a></li>
        <li><a href="#make-changes-to-just-one-server">Make changes to just one server</a></li>
      </ul>
    </li>
    <li><a href="#manage-users-and-groups">Manage users and groups</a></li>
    <li><a href="#manage-files-and-directories">Manage files and directories</a>
      <ul>
        <li><a href="#get-information-about-a-file">Get information about a file</a></li>
        <li><a href="#copy-a-file-to-the-servers">Copy a file to the servers</a></li>
        <li><a href="#retrieve-a-file-from-the-servers">Retrieve a file from the servers</a></li>
        <li><a href="#create-directories-and-files">Create directories and files</a></li>
        <li><a href="#delete-directories-and-files">Delete directories and files</a></li>
      </ul>
    </li>
    <li><a href="#run-operatioins-in-the-background">Run operatioins in the background</a>
      <ul>
        <li><a href="#update-servers-asynchronously-monitoring-progress">Update servers asynchronously, monitoring progress</a></li>
        <li><a href="#fire-and-forget-tasks">Fire-and-forget tasks</a></li>
      </ul>
    </li>
    <li><a href="#check-log-files">Check log files</a></li>
    <li><a href="#manage-cron-jobs">Manage cron jobs</a></li>
    <li><a href="#deploy-a-version-controlled-application">Deploy a version-controlled application</a></li>
    <li><a href="#ansibles-ssh-connection-history">Ansible's SSH connection history</a>
      <ul>
        <li><a href="#paramiko">Paramiko</a></li>
        <li><a href="#openssh-default">OpenSSH (default)</a></li>
        <li><a href="#accelerated-mode">Accelerated Mode</a></li>
        <li><a href="#faster-openssh-in-ansible-15">Faster OpenSSH in Ansible 1.5+</a></li>
      </ul>
    </li>
    <li><a href="#summary">Summary</a></li>
  </ul>
</nav>

<p>지난 챕터에서는 <code>Vagrant</code>와 간단한 <code>Ansible playbook</code>으로 local infrastructure를 테스트해보았다.
이번에는 간단한 <code>Ansible</code> ad-hoc command를 사용하여 하나의 명령어로 다수의 remote server에 명령을 보낼 것이다.</p>
<p>나중 챕터에서는 playbook에 대해 자세히 알아볼 것이지만, 지금은 어떻게 <code>Ansible</code>이 하나 이상의 서버에 대해 ad-hoc command로 빠르게 공통적인 일을 수행하는지, 데이터를 가져오는지에 대해 알아볼 것이다.</p>
<h2 id="conducting-an-orchestra">Conducting an orchestra</h2>
<p>각 개인 administrator가 관리하는 서버의 수는 수년간 급격하게 증가했다.
특히 virtualization과 cloud application의 발전은 표준처럼 되었다.</p>
<p>어느 때든 system administrator는 여러가지 업무가 있다.</p>
<ul>
<li>patch 적용과 <code>yum</code>, <code>apt</code>, 다른 package manager를 통한 update</li>
<li>resource usage 확인 (disk space, memory, CPU, swap space, network)</li>
<li>log file 확인</li>
<li>system user와 group 관리</li>
<li>DNS 설정, hosts 파일 관리 등</li>
<li>서버에 파일 업로드/다운로드</li>
<li>application 배포하기 또는 application 유지</li>
<li>server 재부팅</li>
<li>cron jobs 관리</li>
</ul>
<p>최근에는 이런 작업들이 조금이나마 자동화 되어있다.
하지만 실시간 진단같은 문제에는 사람의 손길이 필요하긴 하다.
또한 multi-server 환경은 복잡하여 각 server에 접속하는 것은 좋은 솔루션이 아니다.</p>
<p><code>Ansible</code>은 admin이 ad-hoc command로 <code>ansible</code> 명령어를 사용하여 수백개의 서버에 동시에 명령을 전달할 수 있다.
챕터 1에서는 <code>Ansible</code> inventory file에 기록된 서버에 두개의 command를 실행했다.
이 챕터에서는 ad-hoc command와 multi-server 환경을 자세히 볼 것이다.
다른 <code>Ansible</code>의 강력한 기능들은 제쳐두고라도 이 챕터를 읽으면 더 효과적으로 server들을 관리할 수 있다.</p>
<h2 id="build-infrastructure-with-vagrant-for-testing">Build infrastructure with Vagrant for testing</h2>
<p>우리의 production server에 영향을 주지 않고 설명을 하기 위해 이 챕터의 나머지 부분에서는 <code>Vagrant</code>의 multi-machine capabilites를 사용하여 몇개의 server들을 설정해볼 것이다.
이것들은 <code>Ansible</code>을 통해 관리될 것이다.</p>
<p>먼저 <code>Vagrant</code>에서 CentOS 7을 실행시키는 하나의 virtual machine을 사용할 것이다.
이 예시에서 우리는 <code>Vagrantfile</code>에 정의된 <code>Vagrant</code>의 기본 설정들을 사용할 것이다.
이 예시에서 우리는 <code>Vagratn</code>의 강력한 multi-machine management feature를 사용할 것이다.</p>
<p><img src="/images/Ansible/Ansible-for-DevOps/multi-machine-management.png" alt="multi-machine management"></p>
<p>우린 3개의 VM을 생성할 것이다.
(두개의 app server, 하나의 database server)
이정도면 <code>Ansible</code>의 server management 능력을 확인해볼 수 있을 것이다.</p>
<p>local drive에 새로운 폴더를 생성하고 <code>Vagrantfile</code>을 생성한다.
이를 editor로 연 뒤 다음과 같이 입력한다.</p>
<pre><code class="language-Vagrantfile" data-lang="Vagrantfile"># -*- mode: ruby -*-
# vi: set ft=ruby :

VAGRANTFILE_API_VERSION = &quot;2&quot;

Vagrant.configure(VAGRANTFILE_API_VERSION) do |config|
  config.ssh.insert_key = false
  config.vm.provider :virtualbox do |vb|
    vb.customize [&quot;modifyvm&quot;, :id, &quot;--memory&quot;, &quot;256&quot;]
  end

  # Application server 1.
  config.vm.define &quot;app1&quot; do |app|
    app.vm.hostname = &quot;orc-app1.dev&quot;
    app.vm.box = &quot;geerlingguy/centos7&quot;
    app.vm.network :private_network, ip: &quot;192.168.60.4&quot;
  end
  # Application server 2.
  config.vm.define &quot;app2&quot; do |app|
    app.vm.hostname = &quot;orc-app2.dev&quot;
    app.vm.box = &quot;geerlingguy/centos7&quot;
    app.vm.network :private_network, ip: &quot;192.168.60.5&quot;
  end

  # Database server.
  config.vm.define &quot;db&quot; do |db|
    db.vm.hostname = &quot;orc-db.dev&quot;
    db.vm.box = &quot;geerlingguy/centos7&quot;
    db.vm.network :private_network, ip: &quot;192.168.60.6&quot;
  end
end
</code></pre><p>이 <code>Vagrantfile</code>은 세 server를 정의하고 각각 고유한 hostname, machine name, IP 주소를 부여한 것이다.
간단하게 하기 위해 셋 모두 CentOS 7을 사용한다.</p>
<p>터미널을 열고 <code>Vagrantfile</code>이 있는 폴더로 이동한다.
그 다음 <code>vagrant up</code>을 이용하여 세개의 VM을 생성한다.
이미 챕터 2에서 box를 다운로드 받았다면 5~10 내로 생성될 것이다.</p>
<p>진행되는 동안 서버에 대한 <code>Ansible</code>을 설명하도록 하겠다.</p>
<h3 id="inventory-file-for-multiple-servers">Inventory file for multiple servers</h3>
<p>관리하는 서버를 다루는 <code>Ansible</code>에 대해 이야기 할 것들이 많다.
하지만 대부분의 경우 서버를 시스템의 main Ansible inventory file(보통 <code>/etc/ansible/hosts</code>)에 추가하면 된다.
지난 챕터에서 파일을 생성하지 않았다면 돌아가서 파일을 생성해야한다.
또한 user가 해당 파일에 대해 read 권한이 있어야 한다.</p>
<p>다음을 파일에 추가한다.</p>
<pre><code class="language-ansible-hosts" data-lang="ansible-hosts"># Lines beginning with a # are comments, and are only included for
# illustration. These comments are overkill for most inventory files.

# Application servers
[app]
192.168.60.4
192.168.60.5

# Database server
[db]
192.168.60.6

# Group 'multi' with all servers
[multi:children]
app
db

# Variables that will be applied to all servers
[multi:vars]
ansible_ssh_user=vagrant
ansible_ssh_private_key_file=~/.vagrant.d/insecure_private_key
</code></pre><ol>
<li>첫 번째 block은 우리의 application server들을 <code>app</code> group에 추가한다.</li>
<li>두 번째 block은 database server를 <code>db</code> group에 추가한다.</li>
<li>세 번째 block은 <code>Ansible</code>이 새 그룹 <code>multi</code>를 생성하고, child group으로 <code>app</code>과 <code>db</code>를 추가한 것이다.</li>
<li>네 번째 block은 <code>multi</code> group에 variables를 추가한 것이다. 이는 <code>multi</code> group과 그 내부의 모든 children 서버에 적용된다.</li>
</ol>

<div class="notices note" ><p>나중 챕터에서 variables, group definition, group hiearchy, Inventory file topics에 대해 알아볼 것이다.
여기서는 어떻게 <code>Ansible</code>이 간단히 서버 정보를 다루는지 확인하고 빠르게 이를 이용할 것이다.</p>
</div>

<p>inventory file을 저장하고 <code>Vagrant</code>가 세개의 VM들을 성공적으로 build 하였는지 확인한다.
<code>Vagrant</code>가 성공하고 나면 이들을 <code>Ansible</code>에서 관리할 것이다.</p>
<h2 id="your-first-ad-hoc-commands">Your first ad-hoc commands</h2>
<p>가장 먼저 해야할 것은 서버 안에서 체크할 것이다.
제대로 설정이 되었는지 확인하고, 올바른 날짜 및 시간이 설정 되었는지(우린 time synchronization과 관련된 에러를 경험하고 싶지 않다!), 어플리케이션을 실행하기에 충분한 리소스가 있는지 확인해 보자.</p>

<div class="notices note" ><p>여기서 확인하는 것들은 production server에서 자동화 시스템으로 모니터링되어야 하는 것들이다.
재앙을 막는 가장 좋은 방법은 언제 올지 알고, 발생하기 전에 어떻게 문제점을 해결하는 것을 아는 것이다.
<code>Munin</code>, <code>Nagios</code>, <code>Cacti</code>, <code>Hyperic</code>과 같은 툴을 사용하여 서버에서의 과거와 현재의 리소스 사용량을 확인할 수 있다.
인터넷에서 웹사이트나 웹 어플리케이션을 돌리고 있다면 <code>Pingdom</code>이나 <code>Server Check in</code> 같은 외부 모니터링 솔루션이 필요하다.</p>
</div>

<h3 id="discover-ansibles-parallel-nature">Discover Ansible's parallel nature</h3>
<p>먼저, <code>Vagrant</code>가 설정한 VM들이 올바른 hostname을 가지고 있는지 확인할 것이다.
<code>Ansible</code>에서 <code>-a</code> argument를 &ldquo;hostname&quot;으로 줘서 모든 서버에 대해 hostname을 실행한다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ansible multi -a <span style="color:#e6db74">&#34;hostname&#34;</span>
</code></pre></div><p><code>Ansible</code>은 이 명령어를 세 서버 모두에 대해 실행하고, 결과를 리턴받는다.
(만일 <code>Ansible</code>이 하나의 서버에 도달하지 못할 경우 이는 해당 서버에 대해 error를 출력하지만 나머지 서버에 대해서는 계속해서 명령어를 수행한다.)</p>

<div class="notices note" ><p><code>Ansible</code>이 <code>No hosts matched</code>나 다른 inventory 관련 에러를 리턴하면 <code>ANSIBLE_HOSTS</code> 환경 변수를 설정해보아라.
<code>export ANSIBLE_HOSTS=/etc/ansible/hosts</code>를 하면 된다.
일반적으로 Ansible은 <code>/etc/ansible/hosts</code> 파일을 자동으로 읽지만 어떻게 Ansible을 설치했는지에 따라 명시적으로 <code>ANSIBLE_HOSTS</code>을 설정해야 할수도 있다.</p>
</div>

<p>명령어들이 각 서버에 대해서 예상했던 순서대로 실행되는 것은 아님을 확인할 수 있다.
명령어를 몇번 더 입력하여 순서를 확인해보자.</p>
<p><img src="/images/Ansible/Ansible-for-DevOps/ansible-multi-command.png" alt="ansible-multi-command"></p>
<p>기본적으로 <code>Ansible</code>은 명령어를 process fork를 이용해서 병렬적으로 실행한다.
따라서 명령어는 좀 더 빨리 완료될 수 있다.
몇개의 서버만 관리한다면 하나씩 실행하는 것에 비해 속도 체감이 별로 안들지만 5-10개의 서버만 관리한다고 하더라도 <code>Ansible</code>의 parallelism(기본적으로 활성화되어있다)을 이용하면 엄청난 속도 절감 효과가 있을 것이다.</p>
<p>fork를 하나만 한다는 것을 의미하는 <code>-f 1</code> argument를 이용해서 동일한 명령어를 다시 입력해보자.
(일반적으로 각 서버에 대해 순서대로 실행할 때 쓴다)</p>
<p><img src="/images/Ansible/Ansible-for-DevOps/ansible-multi-command-serially.png" alt="ansible-multi-command-serially"></p>
<p>동일한 명령어를 계속 반복해도 항상 같은 순서대로 결과가 나올 것이다.
이걸 사용할 일은 거의 없겠지만 값을 늘리는 일은 그래도 더 많을 것이다.
(<code>-f 10</code>이나 <code>-f 25</code>처럼 시스템과 네트워크 연결이 얼마나 감당 가능한지에 따라 수정할 수 있다)
이를 통해 수십 수백개의 서버에 대한 명령어 실행을 빠르게 할 수 있다.</p>

<div class="notices note" ><p>대부분의 사람들은 action의 target을 command/action 자체보다 더 앞에 배치한다.
(&ldquo;X 서버에서, Y 명령어를 실행해라&rdquo;)
하지만 머랫속에서 반대로 작동한다면
(&ldquo;Y 명령러를 실행해라. X 서버에서.&quot;)
target을 arguments 다음에 배치할 수도 있다.
(<code>ansible -a &quot;hostname&quot; multi</code>)
이 둘은 완전히 일치하는 것이다.</p>
</div>

<h2 id="learning-about-your-environment">Learning about your environment</h2>
<p>이제 우리는 <code>Vagrant</code>가 정상적으로 hostname을 설정한 것을 확인했다.
이제 다른것들을 확인해 보도록 하자.</p>
<p>먼저, application을 위한 hard disk space가 충분한지 확인해보자.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ansible multi -a <span style="color:#e6db74">&#34;df -h&#34;</span>
192.168.60.6 | success | rc<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span> &gt;&gt;
Filesystem Size Used Avail Use% Mounted on
/dev/mapper/centos-root 19G 1014M 18G 6% /
devtmpfs 111M <span style="color:#ae81ff">0</span> 111M 0% /dev
tmpfs 120M <span style="color:#ae81ff">0</span> 120M 0% /dev/shm
tmpfs 120M 4.3M 115M 4% /run
tmpfs 120M <span style="color:#ae81ff">0</span> 120M 0% /sys/fs/cgroup
/dev/sda1 497M 124M 374M 25% /boot
none 233G 217G 17G 94% /vagrant

192.168.60.5 | success | rc<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span> &gt;&gt;
Filesystem Size Used Avail Use% Mounted on
/dev/mapper/centos-root 19G 1014M 18G 6% /
devtmpfs 111M <span style="color:#ae81ff">0</span> 111M 0% /dev
tmpfs 120M <span style="color:#ae81ff">0</span> 120M 0% /dev/shm
tmpfs 120M 4.3M 115M 4% /run
tmpfs 120M <span style="color:#ae81ff">0</span> 120M 0% /sys/fs/cgroup
/dev/sda1 497M 124M 374M 25% /boot
none 233G 217G 17G 94% /vagrant

192.168.60.4 | success | rc<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span> &gt;&gt;
Filesystem Size Used Avail Use% Mounted on
/dev/mapper/centos-root 19G 1014M 18G 6% /
devtmpfs 111M <span style="color:#ae81ff">0</span> 111M 0% /dev
tmpfs 120M <span style="color:#ae81ff">0</span> 120M 0% /dev/shm
tmpfs 120M 4.3M 115M 4% /run
tmpfs 120M <span style="color:#ae81ff">0</span> 120M 0% /sys/fs/cgroup
/dev/sda1 497M 124M 374M 25% /boot
none 233G 217G 17G 94% /vagrant
</code></pre></div><p>현재 충분한 만큼의 공간이 있는 것처럼 보인다.
우리의 application은 가벼운 편이다.</p>
<p>두번째로 서버에 메모리가 충분한지 확인한다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ansible multi -a <span style="color:#e6db74">&#34;free -m&#34;</span>
192.168.60.4 | success | rc<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span> &gt;&gt;
total used free shared buffers cached
Mem: <span style="color:#ae81ff">238</span> <span style="color:#ae81ff">187</span> <span style="color:#ae81ff">50</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">69</span>
-/+ buffers/cache: <span style="color:#ae81ff">116</span> <span style="color:#ae81ff">121</span>
Swap: <span style="color:#ae81ff">1055</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1055</span>

192.168.60.6 | success | rc<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span> &gt;&gt;
total used free shared buffers cached
Mem: <span style="color:#ae81ff">238</span> <span style="color:#ae81ff">190</span> <span style="color:#ae81ff">47</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">72</span>
-/+ buffers/cache: <span style="color:#ae81ff">116</span> <span style="color:#ae81ff">121</span>
Swap: <span style="color:#ae81ff">1055</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1055</span>

192.168.60.5 | success | rc<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span> &gt;&gt;
total used free shared buffers cached
Mem: <span style="color:#ae81ff">238</span> <span style="color:#ae81ff">186</span> <span style="color:#ae81ff">52</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">67</span>
-/+ buffers/cache: <span style="color:#ae81ff">116</span> <span style="color:#ae81ff">121</span>
Swap: <span style="color:#ae81ff">1055</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1055</span>
</code></pre></div><p>메모리는 약간 타이트하다.
하지만 우리는 localhost에 3개의 VM을 돌리고 있음을 감안해야한다.</p>
<p>세 번째로 날짜 및 시간이 잘 맞춰졌는지 확인한다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ansible multi -a <span style="color:#e6db74">&#34;date&#34;</span>
192.168.60.5 | success | rc<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span> &gt;&gt;
Sat Feb <span style="color:#ae81ff">1</span> 20:23:08 UTC <span style="color:#ae81ff">2021</span>

192.168.60.4 | success | rc<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span> &gt;&gt;
Sat Feb <span style="color:#ae81ff">1</span> 20:23:08 UTC <span style="color:#ae81ff">2021</span>

192.168.60.6 | success | rc<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span> &gt;&gt;
Sat Feb <span style="color:#ae81ff">1</span> 20:23:08 UTC <span style="color:#ae81ff">2021</span>
</code></pre></div><p>대부분의 어플리케이션은 각 서버의 시간 jitter에 약간은 견딜 수 있게 설계되어있지만 다른 서버들의 시간들을 가능한 가깝게 하는 것은 좋은 방법이고 이를 간단하게 할 수 있는것은 설정하는 것이 쉬운 Network Time Protocol을 사용하는 것이다.
나중에 이를 <code>Ansible</code>의 modules를 이용하여 힘쓰지 않고 프로세스를 진행해 볼 것이다.</p>

<div class="notices note" ><p>특정 서버에 대해서 모든 환경적인 자세한 부분(<code>Ansible</code>의 lingo에서는 <code>facts</code>라고 한다)을 확인하고 싶으면 <code>ansible [host-or-group] -m setup</code>을 입력하면 된다.
이는 매 분마다 서버에 대한 자세한 사항들을 보여준다.
(file system, memory, OS, network interface 등이 포함된다)</p>
</div>

<h2 id="make-changes-using-ansible-modules">Make changes using Ansible modules</h2>
<p>우리는 NTP daemon을 서버에 설치하여 시간을 동기화할 것이다.
<code>yum install -y ntp</code> 명령어를 각 서버에서 실행하는 대신 ansible의 <code>yum</code> module을 이용해서 같은것을 해볼 것이다.
(우리가 앞선 playbook 예제에서 했던 것과 같지만 이번에는 ad-hoc command를 사용할 것이다.)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ansible multi -b -m yum -a <span style="color:#e6db74">&#34;name=ntp state=installed&#34;</span>
</code></pre></div><p>NTP가 이미 설치되어있기 때문에 세개의 &ldquo;success&rdquo; 메시지를 볼 수 있을 것이다.
이는 모든 작업이 순서대로 잘 되었음을 의미한다.</p>

<div class="notices note" ><p><code>-b</code> 옵션은 <code>Ansible</code>이 sudo 권한으로 명령어를 실행할 수 있게 한다.
이는 우리의 <code>Vagrant</code> VM에서는 잘 작동하지만 sudo password를 요구로 하는 서버에 대해서는 <code>-k</code> 옵션도 지정하여 <code>Ansible</code>이 필요로 하는 sudo password를 입력해야한다.</p>
</div>

<p>이제 NTP daemon이 시작되었는지 확인하고 부팅 시 시작되도록 할 것이다.
우리는 <code>service ntpd start</code> 와 <code>chkconfig ntpd on</code> 두 명령어를 사용하기 보단 <code>Ansible</code>의 <code>service</code> module을 사용할 것이다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ansible multi -b -m service -a <span style="color:#e6db74">&#34;name=ntpd state=started enabled=yes&#34;</span>
</code></pre></div><p>모든 서버에서 다음과 같은 메시지를 출력할 것이다.</p>
<pre><code>&quot;changed&quot;: true,
&quot;enabled&quot;: true,
&quot;name&quot;: &quot;ntpd&quot;,
&quot;state&quot;: &quot;started&quot;
</code></pre><p>동일한 명령어를 다시 쳐도 <code>Ansible</code>이 nothing has changed라고 리포트하는 것 빼곤 모든 결과는 같을 것이고 이 경우 <code>changed</code> 값은 <code>false</code>가 될 것 이다.</p>
<p><code>Ansible</code>의 module을 일반 shell command 대신 사용할 경우 <code>Ansible</code>이 제공하는 상화와 idempotency를 이용할 수 있다.
shell command를 실행시키더라도 이를 <code>Ansible</code>의 <code>shell</code>이나 <code>command</code> module로 감싸줘야 하지만(<code>ansible -m shell -a &quot;date&quot; multi</code>처럼), ad-hoc으로 실행하는 것들은 <code>Ansible</code> module을 사용할 필요는 없다.</p>
<p>마지막으로 체크해야하는 사항은 NTP server의 official time과 거의 일치하는지 확인하는 것이다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ansible multi -b -a <span style="color:#e6db74">&#34;service ntpd stop&#34;</span>
$ ansible multi -b -a <span style="color:#e6db74">&#34;ntpdate -q 0.rhel.pool.ntp.org&#34;</span>
$ ansible multi -b -a <span style="color:#e6db74">&#34;service ntpd start&#34;</span>
</code></pre></div><p><code>ntpdate</code> 명령어를 실행하려면 <code>ntpd</code> service가 중지되어야 하기 때문에 service를 중지했고 명령어를 실행한 뒤 다시 서비스를 시작했다.</p>
<p>나의 테스트에서 모든 세 서버에서 3/100초 내에 차이를 보여줬다.
내 목적에는 충분한 것이었다.</p>
<h2 id="configure-groups-of-servers-or-individual-servers">Configure groups of servers, or individual servers</h2>
<p>우리의 가상 웹 어플리케이션은 Django를 사용할 것이며 따라서 우리는  Django와 그 dependency들을 설치해야한다.
Django는 official CentOS yum repository에 없지만 우리는 Python의 easy_install을 통해서 설치할 것이다.
(편리한 Ansible module이 있다.)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ansible app -b -m yum -a <span style="color:#e6db74">&#34;name=MySQL-python state=present&#34;</span>
$ ansible app -b -m yum -a <span style="color:#e6db74">&#34;name=python3-setuptools state=present&#34;</span>
$ ansible app -b -m pip -a <span style="color:#e6db74">&#34;name=django executable=pip3&#34;</span>
</code></pre></div><p>우리는 <code>easy_install</code>을 통해 설치한 django를 <code>pip</code>를 통해서도 설치할 수 있다.
(<code>Ansible</code>의 <code>easy_install</code> module은 <code>pip</code>처럼 uninstall을 지원하 지않기 때문에 사용한다)
하지만 간단하게 하기 위해 <code>easy_install</code>을 사용하였다.</p>
<p>Django가 설치 되었고 제대로 동작하는지 확인해보자.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ansible app -a <span style="color:#e6db74">&#34;python3 -c &#39;import django; print (django.get_version())&#39;&#34;</span>

192.168.60.5 | CHANGED | rc<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span> &gt;&gt;
3.0.3

192.168.60.4 | CHANGED | rc<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span> &gt;&gt;
3.0.3
</code></pre></div><p>우리의 앱 서버가 정상적으로 동작하는 것처럼 보인다.
이제 우리는 database server에 대해 해볼 것이다.</p>

<div class="notices note" ><p>이 챕터에서 한 대부분의 설정은 Ansible playbook으로 하는 것이 더 좋다.
(이 책의 뒷부분에서 더 자세히 다뤄볼 것이다.)
이 챕터는 <code>Ansible</code>을 통해 얼마나 쉽게 여러 서버를 관리할 수 있는지에 대해서 좀 더 집중할 것이다.
서버를 shell command를 통해 설정했다고 하더라도 <code>Ansible</code>은 굉장히 많은 시간을 줄여줄 수 있고 더 안전하고 효과적인 방법으로 모든 것들을 처리해줄 수 있다.</p>
</div>

<h3 id="configure-the-database-servers">Configure the Database servers</h3>
<p>우리는 어플리케이션 서버를 <code>Ansible</code>의 main inventory에서 <code>app</code> group으로 정의하여 사용하였고 database server를 이와 비슷하게 <code>db</code> group으로 정의하여 설정할 것이다.</p>
<p>MariaDB를 설치하고 이를 실행시키고 서버의 방화벽에서 MariaDB의 deafult port인 3306을 허용시키자.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ansible db -b -m yum -a <span style="color:#e6db74">&#34;name=mariadb-server state=present&#34;</span>
$ ansible db -b -m service -a <span style="color:#e6db74">&#34;name=mariadb state=started enabled=yes&#34;</span>
$ ansible db -b -a <span style="color:#e6db74">&#34;iptables -F&#34;</span>
$ ansible db -b -a <span style="color:#e6db74">&#34;iptables -A INPUT -s 192.168.60.0/24 -p tcp -m tcp --dport 3306 -j ACCEPT&#34;</span>
</code></pre></div><p>여기서 app server에서 database를 연결하려고 시도할 경우 연결이 불가능하지만, 연결할 필요가 없다.
왜냐면 MariaDB를 계속해서 셋업해야하기 때문이다.
전형적으로 이를 서버에 접속하여 <code>mysql_secure_installation</code>을 통해 한다.
그러나 운좋게도 <code>Ansible</code>은 MariaDB server를 <code>mysql_*</code> module로 제어할 수 있다.
이제 app server에서 MySQL로 접속할 수 있게 허용할 것이다.
MySQL module은 <code>MySQL-python</code> module이 managed server에 설치되어있어야 한다.</p>

<div class="notices note" ><p>왜 MySQL이 아닌 MariaDB인가?
RHEL 7과 CentOS 7는 MariaDB를 default supported MySQL-compatible database server로 지원한다.
MariaDB와 관련된 몇몇 툴들은 <code>MySQL*</code> 네이밍 규칙을 가진 예전 것들을 사용하며 MySQL로 하더라도 MariaDB를 하는것과 비슷할 것이다.</p>
</div>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ansible db -b -m yum -a <span style="color:#e6db74">&#34;name=MySQL-python state=present&#34;</span>
$ ansible db -b -m mysql_user -a <span style="color:#e6db74">&#34;name=django host=% password=12345 priv=*.*:ALL state=present&#34;</span>
</code></pre></div><p>여기서 Django application을 app server에 생성하거나 배포할 수 있어야 한다.
그 뒤 database server에 username=django, password=12345로 접속할 수 있을 것이다.</p>

<div class="notices note" ><p>여기서 사용한 MySQL configuration은  예시/개발 목적으로만 사용해야 한다.
MySQL의 안전하게 하려면 test database의 삭제와 root user account에 password를 추가하고, 3306 port로 접근하는 IP address들을 제한하는 등 몇가지 더 할 일들이 있다.
이 중 몇몇은 이 책의 뒷부분에서 다루도록 하겠지만, 당신의 서버를 보호하는 것은 당신의 책임이다.
제대로 보호했는지 확실히 하라.</p>
</div>

<h3 id="make-changes-to-just-one-server">Make changes to just one server</h3>
<p>축하한다! 이제 Django와 MySQL을 실행시킬 작은 웹 어플리케이션 환경을 가지게 되었다.
앱 서버 앞단에 요청을 분배시켜줄 로드밸런서도 없어 충분하지는 않다.
하지만 서버에 접속하지 않고도 빠르게 이것들을 설정할 것이다.
더 인상깊은 점은 어느 ansible command도 다시 실행할 수 있고, 이것이 어떤 차이점도 만들지 않는다는 것이다.
이런 것들은 <code>&quot;changed&quot;: false</code>를 리턴할 것이고 기존의 설정이 변경되지 않았음을 알려준다.</p>
<p>이제 local infrastructure가 동작하는 동안 로그를 보다보면 두 앱 서버중 하나의 시간이 NTP daemon이 충돌나거나 어떤 이유로 멈췄을 경우 다른 서버와 일치하지 않을 수 있다.
빠르게 다음의 명령어를 통해 ntpd의 상태를 체크해보자.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ansible app -b -a <span style="color:#e6db74">&#34;service ntpd status&#34;</span>
</code></pre></div><p>그리고 app server의 서비스들을 재시작한다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ansible app -b -a <span style="color:#e6db74">&#34;service ntpd restart&#34;</span> --limit <span style="color:#e6db74">&#34;192.168.60.4&#34;</span>
</code></pre></div><p>이 명령어에서 <code>--limit</code> argument는 명령어를 지정된 그룹 내에서 특정한 호스트에서만 실행하도록 제한하는 것이다.
<code>--limit</code>은 정확한 string 또는 regular expression을 쓸 수 있다.
(<code>~</code>를 prefix로 쓰면 된다)
위의 명령어는 <code>.4</code> 서버에서만 실행하고 싶다면 더 간단히 할 수 있다.
(<code>.4</code>로 끝나는 IP 주소가 하나만 있다고 확신해야 한다)
다음의 명령어는 정확히 같은 동작을 한다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Limit hosts with a simple pattern (asterisk is a wildcard).</span>
$ ansible app -b -a <span style="color:#e6db74">&#34;service ntpd restart&#34;</span> --limit <span style="color:#e6db74">&#34;*.4&#34;</span>
<span style="color:#75715e"># Limit hosts with a regular expression (prefix with a tilde).</span>
$ ansible app -b -a <span style="color:#e6db74">&#34;service ntpd restart&#34;</span> --limit ~<span style="color:#e6db74">&#34;.*\.4&#34;</span>
</code></pre></div><p>이 예시에서 우리는 IP 주소를 hostname 대신에 사용하였다.
하지만 많은 실제 시나리오에서는 <code>nyc-dev-1.example.com</code>처럼 hostname을 많이 사용하게 된다.
따라서 정규식을 활용하는 것이 더 유용할 것이다.</p>

<div class="notices note" ><p>하나의 서버에 대해 명령어를 실행할때만 <code>--limit</code> 옵션을 주어라.
동일한 세트의 서버에 <code>--limit</code> 명령어를 자주 사용하게 된다면 이들을 inventory file에서 group으로 묶는 것을 고려해 보아라.
그 방법이 <code>ansible [my-new-group-name] [command]</code>를 사용할 수 있는 방법이고 타이핑을 줄일 수 있다.</p>
</div>

<h2 id="manage-users-and-groups">Manage users and groups</h2>
<p>내가 <code>Ansible</code>의 ad-hoc command를 사용하는 일반적인 사용법은 user와 group 관리이다.
내가 user를 생성하며 home folder를 생성할지 말지와, 특정 유저를 특정 group에 추가하는 방법을 얼마나 많이 구글링했는지 모른다.</p>
<p><code>Ansible</code>의 user와 group module은 이런 것들을 어느 Linux 에서나 꽤 간단하고 표준적인 방법으로 할 수 있게 해준다.</p>
<p>먼저, 간단히 server administrator를 위한 <code>admin</code> group을 app server에 추가하자.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ansible app -b -m group -a <span style="color:#e6db74">&#34;name=admin state=present&#34;</span>
</code></pre></div><p><code>group</code> module은 매우 간단하다.
group을 <code>state=absent</code>로 하면 삭제가 되고 group id는 <code>gid=[gid]</code>로 설정할 수 있으며 group이 system group인지 나타내려면 <code>system=yes</code>를 설정하면 된다.</p>
<p>이제 <code>johndoe</code>라는 user를 app server에 추가하고 생성한 group에 넣을 것이며 <code>/home/johndoe</code>에 home directory를 추가할 것이다.
(Linux 배포판에서 default location이다)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ansible app -b -m user -a <span style="color:#e6db74">&#34;name=johndoe group=admin createhome=yes&#34;</span>
</code></pre></div><p>새로운 유저에 대해 자동으로 SSH key를 생성하고 싶다면 (존재하지 않는 경우) 같은 명령어를 <code>generate_ssh_key=yes</code>를 넣어 실행하면 된다.
또한 user의 UID를 <code>uid=[uid]</code>를 통해 설정할 수 있고, user의 shell을 <code>shell=[shell]</code>로 설정할 수 있으며 password를 <code>password=[encrypted-password]</code>로 설정할 수 있다.</p>
<p>account를 삭제하려면 어떻게 해야 할까?</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ansible app -b -m user -a <span style="color:#e6db74">&#34;name=johndoe state=absent remove=yes&#34;</span>
</code></pre></div><p><code>Ansible</code>의 <code>user</code> module을 통해 <code>useradd</code>, <code>userdel</code>, <code>usermod</code>의 모든 것을 사용할 수 있으며 심지어 더 쉽다.
<a href="http://docs.ansible.com/user_module.html">공식 User module 가이드</a>에 더 자세한 설명이 있다.</p>
<h2 id="manage-files-and-directories">Manage files and directories</h2>
<p>또 다른 ad-hoc command의 일반적인 사용법은 remote file management이다.
<code>Ansible</code>은 host에서 remote server로 파일을 복사하는 것, 디렉토리를 생성하는 것, 파일과 디렉토리의 권한과 소유권을 관리하는 것, 파일과 디렉토리를 삭제하는 것이 매우 쉽다.</p>
<h3 id="get-information-about-a-file">Get information about a file</h3>
<p>파일의 권한, MD5, 소유자를 확인하려면 <code>Ansible</code>의 <code>stat</code> module을 사용하면 된다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ansible multi -m stat -a <span style="color:#e6db74">&#34;path=/etc/environment&#34;</span>
</code></pre></div><p>이는 <code>stat</code> 명령어를 실행했을 때와 같은 정보를 보여주지만 JSON 형태로 출력해주어 좀 더 쉽게 parsing할 수 있게 된다.
(또는 나중에 playbook에서 조건을 걸어 어떤일을 할지 말지 결정할 수 있게 한다)</p>
<h3 id="copy-a-file-to-the-servers">Copy a file to the servers</h3>
<p>아마도 <code>scp</code>나 <code>rsync</code>를 통해 파일과 디렉토리를 remote server로 복사해왔을 것이다.
<code>Ansible</code>은 <code>rsync</code> module을 가지고 있으며 대부분의 파일 복사관련 명령은 <code>copy</code> module로도 할 수 있다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ansible multi -m copy -a <span style="color:#e6db74">&#34;src=/etc/hosts dest=/tmp/hosts&#34;</span>
</code></pre></div><p><code>src</code>는 파일이나 디렉토리가 될 수 있다.
마지막에 슬래쉬로 끝나게 되면 디렉토리의 내용들만 <code>dest</code>로 복사가 된다.
슬래쉬를 생략하면 내용과 디렉토리 그 자체가 <code>dest</code>로 복사된다.</p>
<p><code>copy</code> module은 단일 파일 복사에 완벽하며 작은 디렉토리에서도 잘 작동한다.
수백개의 파일을 복사하려는 경우, 특히 서브 디렉토리가 많은 경우에는 <code>Ansible</code>의 <code>unarchive</code> module이나 <code>synchronize</code> module을 이용해서 복사하는 것을 고려해보면 좋을 것이다.</p>
<h3 id="retrieve-a-file-from-the-servers">Retrieve a file from the servers</h3>
<p><code>fetch</code> module은 <code>copy</code> module과 거의 비슷하게 동작하지만 반대인 것이 다르다.
가장 주요한 차이점은 파일이 local <code>dest</code>의 디렉토리로 일치하는 host의 파일을 가져온다.
예를 들어 다음의 명령어는 hosts file을 서버에서 가져오는 것이다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ansible multi -b -m fetch -a <span style="color:#e6db74">&#34;src=/etc/hosts dest=/tmp&#34;</span>
</code></pre></div><p>Fetch는 default로 각 서버의 <code>/etc/hosts</code> 파일을 destination folder 안에 host의 이름을 추가하여 저장할 것이다.
(우리의 경우 세 IP 주소이다)
따라서 <code>db</code> server의 hosts file은 <code>/tmp/192.168.60.6/etc/hosts</code>로 저장될 것이다.</p>
<p><code>flat=yes</code>라는 파라미터를 추가하고 <code>dest</code>를 <code>dest=/tmp/</code>로 설정하여(슬래쉬로 끝내기) <code>Ansible</code>이 file을 직접 <code>/tmp</code> 디렉토리로 fetch할 수 있다.
하지만 filename은 반드시 유일해야 이것이 동작하고 따라서 여러 호스트에서 파일을 가져올 때는 적합하지 않다.
<code>flat=yes</code>는 하나의 호스트에서 파일을 가져올 때만 써야한다.</p>
<h3 id="create-directories-and-files">Create directories and files</h3>
<p><code>file</code> module을 사용하여 파일과 디렉토리를 생성(<code>touch</code> 처럼)할 수 있고, 권한 관리와 파일과 디렉토리의 소유권을 관리, SELinux 속성 수정, symlink 생성을 할 수 있다.</p>
<p>디렉토리를 생성하는 방법이다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ansible multi -m file -a <span style="color:#e6db74">&#34;dest=/tmp/test mode=644 state=directory&#34;</span>
</code></pre></div><p>symlink를 생성하는 방법이다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ansible multi -m file -a <span style="color:#e6db74">&#34;src=/src/symlink dest=/dest/symlink owner=root group=root state=link&#34;</span>
</code></pre></div><h3 id="delete-directories-and-files">Delete directories and files</h3>
<p><code>state</code>를 <code>absent</code>로 설정하여 파일이나 디렉토리를 삭제할 수 있다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ansible multi -m file -a <span style="color:#e6db74">&#34;dest=/tmp/test state=absent&#34;</span>
</code></pre></div><p><code>Ansible</code>을 통해 원격 파일을 관리하는 방법은 매우 많다.
우리는 짧게 <code>copy</code>와 <code>file</code> module을 살펴보았지만, 다른 <code>lineinfile</code>, <code>ini_file</code>, <code>unarchive</code>같은 file-management module의 문서도 읽어보도록 해라.
이 책에서는 이런 module에 대해 나중 챕터에서 다루도록 하겠다.
(playbooks와 함께.)</p>
<h2 id="run-operatioins-in-the-background">Run operatioins in the background</h2>
<p>몇몇 operation은 약간 시간이 걸린다(수 분에서 몇 시간까지 걸리기도 한다).
예를 들어, <code>yum date</code>나 <code>apt-get update &amp;&amp; apt-get dist-upgrade</code>를 할 경우, 서버에서 모든 패키지가 업데이트 되기까지 수 분이 걸릴 수 있다.</p>
<p>이러한 상황에서 <code>Ansible</code>이 명령어를 asynchronous하게 실행하고 명령어가 끝났을 때 서버에서 결과를 가져오게 할 수 있다.
하나의 서버만 관리한다면 이는 그렇게 효과적이지는 않겠지만 많은 서버를 관리한다면 모든 서버에서 명령을 굉장히 빠르게 시작하고(특히 <code>--forks</code> 값을 늘리면 더욱 더 빨라진다) 이후에 서버에서 최신 상태를 polling할 수 있다.</p>
<p>명령어를 background에서 실행하려면 다음의 옵션을 설정한다.</p>
<ul>
<li><code>-B &lt;seconds&gt;</code>: job이 동작할 수 있는 최대 시간 (초)</li>
<li><code>-P &lt;seconds&gt;</code>: job 상태를 업데이트하기 위해 polling할 때 대기하는 시간 (초)</li>
</ul>
<h3 id="update-servers-asynchronously-monitoring-progress">Update servers asynchronously, monitoring progress</h3>
<p><code>yum -y update</code>를 모든 서버에서 시작하여 기다려 보자.
<code>-P</code> 옵션을 쓰지 않으면 <code>Ansible</code>은 default로 10초마다 polling 한다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ansible multi -b -B <span style="color:#ae81ff">3600</span> -a <span style="color:#e6db74">&#34;yum -y update&#34;</span>
</code></pre></div><p>조금 기다리면(VM을 설치한 host에 따라 오래 걸릴수도 있다) 다음과 같은 결과를 볼 수 있다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#960050;background-color:#1e0010">j</span><span style="color:#960050;background-color:#1e0010">o</span><span style="color:#960050;background-color:#1e0010">b</span> <span style="color:#ae81ff">763350539037</span><span style="color:#960050;background-color:#1e0010">&gt;</span> <span style="color:#960050;background-color:#1e0010">f</span><span style="color:#960050;background-color:#1e0010">i</span><span style="color:#960050;background-color:#1e0010">n</span><span style="color:#960050;background-color:#1e0010">i</span><span style="color:#960050;background-color:#1e0010">s</span><span style="color:#960050;background-color:#1e0010">h</span><span style="color:#960050;background-color:#1e0010">e</span><span style="color:#960050;background-color:#1e0010">d</span> <span style="color:#960050;background-color:#1e0010">o</span><span style="color:#960050;background-color:#1e0010">n</span> <span style="color:#ae81ff">192.168</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#ae81ff">60.6</span> <span style="color:#960050;background-color:#1e0010">=</span><span style="color:#960050;background-color:#1e0010">&gt;</span> {
<span style="color:#f92672">&#34;ansible_job_id&#34;</span>: <span style="color:#e6db74">&#34;763350539037&#34;</span>,
<span style="color:#f92672">&#34;changed&#34;</span>: <span style="color:#66d9ef">true</span>,
<span style="color:#f92672">&#34;cmd&#34;</span>: [
<span style="color:#e6db74">&#34;yum&#34;</span>,
<span style="color:#e6db74">&#34;-y&#34;</span>,
<span style="color:#e6db74">&#34;update&#34;</span>
],
<span style="color:#f92672">&#34;delta&#34;</span>: <span style="color:#e6db74">&#34;0:13:13.973892&#34;</span>,
<span style="color:#f92672">&#34;end&#34;</span>: <span style="color:#e6db74">&#34;2021-02-09 04:47:58.259723&#34;</span>,
<span style="color:#f92672">&#34;finished&#34;</span>: <span style="color:#ae81ff">1</span>,
<span style="color:#960050;background-color:#1e0010">.</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#960050;background-color:#1e0010">.</span> <span style="color:#960050;background-color:#1e0010">[</span><span style="color:#960050;background-color:#1e0010">m</span><span style="color:#960050;background-color:#1e0010">o</span><span style="color:#960050;background-color:#1e0010">r</span><span style="color:#960050;background-color:#1e0010">e</span> <span style="color:#960050;background-color:#1e0010">i</span><span style="color:#960050;background-color:#1e0010">n</span><span style="color:#960050;background-color:#1e0010">f</span><span style="color:#960050;background-color:#1e0010">o</span> <span style="color:#960050;background-color:#1e0010">a</span><span style="color:#960050;background-color:#1e0010">n</span><span style="color:#960050;background-color:#1e0010">d</span> <span style="color:#960050;background-color:#1e0010">s</span><span style="color:#960050;background-color:#1e0010">t</span><span style="color:#960050;background-color:#1e0010">d</span><span style="color:#960050;background-color:#1e0010">o</span><span style="color:#960050;background-color:#1e0010">u</span><span style="color:#960050;background-color:#1e0010">t</span> <span style="color:#960050;background-color:#1e0010">f</span><span style="color:#960050;background-color:#1e0010">r</span><span style="color:#960050;background-color:#1e0010">o</span><span style="color:#960050;background-color:#1e0010">m</span> <span style="color:#960050;background-color:#1e0010">j</span><span style="color:#960050;background-color:#1e0010">o</span><span style="color:#960050;background-color:#1e0010">b</span><span style="color:#960050;background-color:#1e0010">]</span> <span style="color:#960050;background-color:#1e0010">.</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#960050;background-color:#1e0010">.</span>
</code></pre></div><p>background 작업이 실행되는 동안 <code>Ansible</code>의 <code>async_status</code> module에 <code>jid</code>에 <code>ansible_job_id</code>를 넣어 작업 상태를 확인할 수 있다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ansible multi -m async_status -a <span style="color:#e6db74">&#34;jid=763350539037&#34;</span>
</code></pre></div><h3 id="fire-and-forget-tasks">Fire-and-forget tasks</h3>
<p>또한 장기간 동작하는 유지보수 스크립트를 돌리거나 완료되기까지 오래 걸리는 어떤 작업을 하면, 그 작업을 가만히 기다리고 싶지는 않을 것이다.
이런 경우에 <code>-B</code>를 높게 설정할 수 있다.
(그렇게 해서 작업이 <code>Ansible</code>이 이를 죽이기 전에 끝내도록 할 수 있다.)
그리고 <code>-P</code>를 <code>0</code>으로 설정하여 <code>Ansible</code>이 명령을 실행하고 잊어버리게 할 수 있다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ansible multi -B <span style="color:#ae81ff">3600</span> -P <span style="color:#ae81ff">0</span> -a <span style="color:#e6db74">&#34;/path/to/fire-and-forget-script.sh&#34;</span>
</code></pre></div><p><code>jid</code>를 통해 상태를 추적할 수 없지만 <code>fire-and-forget</code> 작업에는 유용하다.</p>

<div class="notices note" ><p>원격으로 추적이 불가능한 작업에 대해서는 task의 진행 경과를 log로 남기는 것, 실패 시 알람을 보내는 것은 좋은 방법이다.
특히, backup을 하는 background 작업이나 business-critical database 유지관리 작업에 유용할 것이다.</p>
</div>

<p>또한 <code>Ansible</code>의 playbook을 <code>async</code>와 <code>poll</code> 파라미터를 정의하여 background에서 asynchrnous로 동작할 수도 있다.
나중 챕터에서 playbook의 background 동작을 자세히 살펴볼 것이다.</p>
<h2 id="check-log-files">Check log files</h2>
<p>때로 application의 에러를 디버깅 할때 또는 다른 문제를 진단할 때 서버의 log 파일을 확인해야할 필요가 있다.
일반적인 log 명령(<code>tail</code>, <code>cat</code>, <code>grep</code> 등)은 <code>ansible</code> 명령어를 통해 할 수 있다.
여기엔 몇가지 경고가 있다.</p>
<ol>
<li>지속적으로 파일을 모니터링하는 <code>tail -f</code>같은 것은 <code>Ansible</code>을 통해서는 할 수 없다.
왜냐면 <code>Ansible</code>은 명령이 완료되었을때의 결과만 출력하기 때문이고, file을 following하는 것은 Control+C를 입력하기 전까지는 완료되지 않기 때문이다.
언젠가 <code>async</code> module이 이 기능을 가질지 모르지만 현재로썬 가능하지 않다.</li>
<li><code>Ansible</code>에서 명령어를 통해 방대한 양의 데이터를 stdout을 통해 리턴받는 것은 좋은 생각이 아니다.
수 KB 이상의 파일을 <code>cat</code>하려 한다면 각 서버에 개별적으로 로그인 해야한다.</li>
<li><code>Ansible</code>을 통해 실행된 명령어의 결과를 redirect 하거나 filtering 하려면 <code>Ansible</code>의 default <code>command</code> module이 아닌 <code>shell</code> module을 써야 한다.
(<code>-m shell</code>을 명령어에 추가한다.)</li>
</ol>
<p>간단한 예제를 통해 각 서버에서 메시지 로그 파일의 끝의 몇 줄을 확인해보자.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ansible multi -b -a <span style="color:#e6db74">&#34;tail /var/log/messages&#34;</span>
</code></pre></div><p>경고 사항에서 언급했듯이 <code>grep</code>같은 것으로 메시지 로그를 필터링 하고싶으면 <code>Ansible</code>의 default <code>command</code> module이 아닌 <code>shell</code>을 사용해라.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ansible multi -b -m shell -a <span style="color:#e6db74">&#34;tail /var/log/messages | grep ansible-command | wc -l&#34;</span>

192.168.60.5 | success | rc<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span> &gt;&gt;
<span style="color:#ae81ff">12</span>
192.168.60.4 | success | rc<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span> &gt;&gt;
<span style="color:#ae81ff">12</span>
192.168.60.6 | success | rc<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span> &gt;&gt;
<span style="color:#ae81ff">14</span>
</code></pre></div><p>이 명령어는 얼마나 많은 <code>Ansible</code> command가 각 서버에서 동작했었는지를 보여준다.
(숫자는 다를 수 있다)</p>
<h2 id="manage-cron-jobs">Manage cron jobs</h2>
<p>cron을 통한 주기적인 작업은 시스템의 crontab을 통해 할 수 있다.
일반적으로 서버에서의 cron job 설정을 변경하려면 서버에 접속하고 <code>crontab -e</code>를 cron job이 있는 계정에서 사용하여 간격과 작업을 입력한다.</p>
<p><code>Ansible</code>은 <code>cron</code> module을 통해 cron jobs를 관리할 수 있다.
매일 4 a.m.에 모든 서버에서 shell script를 실행하고 싶으면 다음과 같은 cron job을 추가하면 된다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ansible multi -b -m cron -a <span style="color:#e6db74">&#34;name=&#39;daily-cron-all-servers&#39; hour=4 job=&#39;/path/to/daily-script.sh&#39;&#34;</span>
</code></pre></div><p><code>Ansible</code>은 지정하지 않은 값에 대해서는 <code>*</code>이라고 가정할 것이다.
(유효한 값은 <code>day</code>, <code>hour</code>, <code>minute</code>, <code>month</code>, <code>weekday</code>이다)
또한 <code>special_time=[value]</code>를 사용하여 <code>reboot</code>, <code>yearly</code>, <code>monthly</code>같은 특정 시간을 설정할 수도 있다.
job을 특정 유저로 하고싶으면 <code>user=[user]</code>를 사용하면 되고 현재 crontab을 백업하고 싶으면 <code>backup=yes</code>를 사용하면 된다.</p>
<p>cron job을 제거하려면 어떻게 해야할까?
간단히 동일한 <code>cron</code> 명령어에다가 삭제하고 싶은 cron job 이름을 적고 <code>state=absent</code>를 사용하면 된다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ansible multi -b -m cron -a <span style="color:#e6db74">&#34;name=&#39;daily-cron-all-servers&#39; state=absent&#34;</span>
</code></pre></div><p>또한 <code>Ansible</code>로 custom crontab 파일을 관리할 수 있다.
앞선 syntax와 동일하게 사용하지만 cron file의 location을 <code>cron_file=cron_file_name</code>으로 설정하면 된다.
(<code>cron_file_name</code>은 <code>/etc/cron.d</code>에 위치한 cron file이다)</p>

<div class="notices note" ><p><code>Ansible</code>은 Ansible-managed crontab 목록을 바로 위에 <code>#Ansible: daily-cron-all-servers</code>같은 comment를 남겨서 나타낸다.
이 crontab은 이대로 남겨두는 것이 제일 좋고, 항상 ad-hoc command 또는 <code>Ansible</code>의 <code>cron</code> module을 사용하는 playbook으로 관리해야 한다.</p>
</div>

<h2 id="deploy-a-version-controlled-application">Deploy a version-controlled application</h2>
<p>git checkout으로 업데이트를 하거나 새로운 코드를 서버에서 복사한 뒤 배포를 위해 명령어를 실행시키는 간단한 어플리케이션의 배포에서 <code>Ansible</code>의 ad-hoc mode가 도움이 될 수 있다.
더 복잡한 배포에서 <code>Ansible</code> playbook과 rolling update 기능(이후에 더 설명할 것이다)을 사용하여 zero downtime으로 배포를 성공적으로 할 수 있다.</p>
<p>아래의 예시에서 하나 또는 두개의 서버에서 <code>/opt/myapp</code> 디렉토리에 있는 간단한 어플리케이션을 실행한다고 가정한다.
이 디렉토리는 중앙 서버 또는 GitHub같은 곳에서 clone한 git repository이고 어플리케이션의 배포와 업데이트는 clone을 업데이트 하고나서 <code>/opt/myapp/scripts/update.sh</code>에 있는 shell script를 실행시켜 진행된다.</p>
<p>먼저, 모든 app 서버에서 application의 새로운 branch인 1.2.4로 git checkout을 하여 업데이트 한다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ansible app -b -m git -a <span style="color:#e6db74">&#34;repo=git://example.com/path/to/repo.git dest=/opt/myapp update=yes version=1.2.4&#34;</span>
</code></pre></div><p><code>Ansible</code>의 git module은 branch, tag 또는 <code>version</code> parameter와 함께 특정한 commit을 지정할 수 있도록 한다.
(이 경우 우리는 1.2.4 tag로 checkout하지만 <code>prod</code>같은 brach 이름으로 명령어를 실행하고자 한다면 <code>Ansible</code>은 이를 해줄 것이다)
<code>Ansible</code>이 강제로 checked-out copy를 업데이트하도록 하려면 <code>update=yes</code>를 추가하면 된다.
<code>repo</code>와 <code>dest</code> 옵션은 의미가 명확하다.</p>
<p>그 다음 application의 <code>update.sh</code> shell script를 실행시킨다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ansible app -b -a <span style="color:#e6db74">&#34;/opt/myapp/update.sh&#34;</span>
</code></pre></div><p>ad-hoc command는 (위에서 본 예제와 같은)간단한 배포에 적합하지만 더 복잡한 어플리케이션 또는 복잡한 인프라를 필요로 할 경우 사용할 수 있는 <code>Ansible</code>의 더 강력하고 유연한 어플리케이션 배포 기능은 이 책의 뒷부분에 설명되어있다.
특히 <code>Rolling Updates</code> 섹션을 보아라.</p>
<h2 id="ansibles-ssh-connection-history">Ansible's SSH connection history</h2>
<p><code>Ansible</code>의 가장 좋은 기능 중 하나는 추가적인 어플리케이션이나 daemon을 관리하는 서버에서 실행시키지 않아도 된다는 것이다.
대신 서버와 적절한 프로토콜로 통신을 하며 <code>Ansible</code>은 거의 모든 Linux 서버에서 동작하는 일반적인 관리를 위해 표준화되고 안전한 SSH 연결을 사용한다.</p>
<p>안정적이고 빠르고 안전한 SSH 연결은 <code>Ansible</code> 통신 기능의 심장과도 같기 때문에 <code>Ansible</code>의 SSH 구현은 지난 몇년간 지속적으로 개선되어왔고 지금도 계속되고있다.</p>
<p><code>Ansible</code>의 SSH 연결 방법의 일반적인 것 중 하나는 <code>Ansible</code>이 연결을 통해 play나 command로 정의한 하나 또는 몇가지 파일을 원격 서버로 전송하고, play/command를 실행하고, 전송된 파일을 삭제하고, 결과를 리포트하는 것이다.
이런 이벤트 sequence는 나중의 <code>Ansible</code>에서는 변경될 수 있고 더 간단하고 직접적으로 변할 수 있다.
(아래 <code>Ansible</code> 1.5를 보아라)
하지만 빠르고, 안정적이고 안전한 SSH 연결은 <code>Ansible</code>에서 무엇보다도 중요하다.</p>
<h3 id="paramiko">Paramiko</h3>
<p>먼저 <code>Ansible</code>은 <code>paramiko</code>(Python에서 SSH2 implementaion을 한 open source)만을 사용한다.
하지만 단일 언어(Python)에 대한 단일 라이브러리로 <code>paramiko</code>의 개발은 OpenSSH의 개발을 따라잡지 못하고 있다.
(거의 모든 곳에서 사용되는 SSH의 표준 구현이다)
그리고 OpenSSH보다 퍼포먼스와 보안이 약간은 떨어진다.
최소한 작성자의 관점에서는 말이다.</p>
<p><code>Ansible</code>이 계속해서 <code>paramiko</code>를 지원하며, 그리고 이를 (OpenSSH 5.6 또는 이후버전에서 option으로 지원하는)ControlPersist에서는 지원하지 않는 system의 default로 선택하며(RHEL 5/6 처럼)
(ControlPersist는 서버의 SSH config에서 설정된 <code>ControlPersist</code> timeout이 될때까지 SSH 연결이 유지되도록 한다)</p>
<h3 id="openssh-default">OpenSSH (default)</h3>
<p><code>Ansible</code> 1.3부터 <code>Ansible</code>은 default로 <code>OpenSSH</code> 연결을 사용하여 ControlPersist를 지원하며 서버에 연결하도록 하였다.
<code>Ansible</code>은 이 기능을 0.5 버전부터 가지고 있었지만 1.3부터 default가 되었다.</p>
<p>대부분의 local SSH configuration parameters(hosts, key files, 등)은 사용되지만 22 포트(default SSH Port)가 아닌 포트로 연결을 해야한다면 inventory file(<code>ansible_ssh_port</code> 옵션)에 포트를 지정하거나 <code>ansible</code> command를 이용해야 한다.</p>
<p><code>OpenSSH</code>는 <code>paramiko</code>보다 빠르고 더 믿을 수 있다.
하지만 <code>Ansible</code>을 빠르게 하는 방법은 여전히 더 존재한다.</p>
<h3 id="accelerated-mode">Accelerated Mode</h3>
<p>ad-hoc command가 그렇게 도움이 되지 않더라도 <code>Ansible</code>의 Accelerated mode는 playbook에 보다 더 좋은 퍼포먼스를 보여준다.
반복적으로 SSH를 통해 연결하는 것 대신, <code>Ansible</code>은 SSH를 처음에 연결하고, 처음 연결에 사용한 AES key를 사용하여 나머지 명령어와 통신하고 분리된 포트를 통해 전송한다(5099가 default지만 설정 가능하다).</p>
<p>accelerated mode를 위해 필요한 추가적인 패키지는 <code>python-keyczar</code> 뿐이고 <code>OpenSSH</code>/<code>Paramiko</code> mode에서 사용가능한 대부분의 것은 <code>sudo</code>를 사용할 때 빼고 Accerlerated mode에서 사용 가능하다.</p>
<ul>
<li>sudoers 파일에 requiretty가 disabled 되어있다.
(여기서 주석을 해제하거나 각 유저에 대해 <code>Defaults:username !requiretty</code>로 줄을 변경한다)</li>
<li>sudoers 파일에서 <code>NOPASSWD</code> 설정을 하여 sudo password를 disable한다.</li>
</ul>
<p>Accelerated mode는 <code>OpenSSH</code>에 비해 2~4배 더 빠른 성능(특히 파일 전송같은 것들에서)을 보여주고 playbook에서 <code>accelerate: true</code>를 설정하여 활성화 할 수 있다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">---
- hosts: all
  accelerate: <span style="color:#66d9ef">true</span>
</code></pre></div><p>말할 것도 없이 accelerated mode를 사용하면 통신을 할 때 사용할 포트가 방화벽에서 뚫려있어야 한다.
(5099 port가 default이며 <code>accelerate</code> 뒤에 이은 <code>accelerate_port</code> 옵션을 통해 지정한 포트 어느것도 될 수 있다.)</p>
<p>accelerate mode는 <code>Ansible</code>의 통신을 가속화하는 비슷한 방법이지만 <code>ZeroMQ</code>가 controlled 서버에 설치(<code>Ansible</code>의 simple no-dependency와 no-daemon philosophy에 위배된다)되어야 하고 sudo command는 작동하지 않는, 지금은 deprecated된 <code>Fireball</code> mode에서 영감을 얻었다.</p>
<h3 id="faster-openssh-in-ansible-15">Faster OpenSSH in Ansible 1.5+</h3>
<p><code>Ansible</code> 1.5부터 <code>Ansible</code>의 default <code>OpenSSH</code> 구현에 매우 큰 개선이 있었다.</p>
<p>파일을 복사하는 대신 이를 원격 서버에서 실행하게 하고 이들을 지우는 새로운 OpenSSH 전송 방법은 SSH 통신을 통해 대부분의 <code>Ansible</code> module에 대한 명령어를 전송하고 실행할 것이다.</p>
<p>이 연결 방법은 <code>Ansible</code> 1.5+에서만 사용할 수 있고 <code>pipelining=True</code>를 <code>Ansible</code> configuration file(나중에 좀 더 자세히 설명할, <code>ansible.cfg</code>)의 <code>[ssh_connection]</code> 섹션 아래에 추가하여 활성화 할 수 있다.</p>

<div class="notices note" ><p><code>pipelining=True</code> 설정 옵션은 <code>/etc/sudoers</code>의 <code>Defaults requiretty</code> 옵션을 제거했거나 주석처리 했다면 도움되지 않을 것이다.
대부분의 OS에서 이는 default configuration으로 설정되어 있지만, 이 세팅을 다시 한번 확인하여 fastest connection이 가능할지 확인해라.</p>
</div>


<div class="notices note" ><p>Mac OS X, Ubuntu, Cygwin을 사용한 Windows나 다른 대부분의 OS의 최신 버전으로 <code>ansible</code>과 <code>ansible-playbook</code>을 실행하는 host를 사용한다면, <code>OpenSSH</code> 5.6 이후 버전을 실행해야 <code>Ansible</code>의 SSH connection 세팅과 함께 사용되는 <code>ControlPersist</code> setting과 잘 동작한다.<br>
만일 <code>Ansible</code>이 실행되고 있는 호스트가 RHEL이나 CentOS를 가지고 있다면 <code>OpenSSH</code> 버전을 최슨으로 업데이트 하여 빠르고/지속 가능한 연결 방법을 사용할 수 있다.
<code>OpenSSH</code> 5.6버전 이후는 전부 다 잘 작동한다.
이후의 버전들을 설치하려면 소스코드로부터 컴파일하거나 CentALT같은 다른 레파지토리를 사용하고 <code>yum update openssh</code>를 하면 된다.</p>
</div>

<h2 id="summary">Summary</h2>
<p>이 챕터에서 우리는 어떻게 local workstation에 test 목적을 위한 multi-server infrastructure를 <code>Vagrant</code>를 통해 구축하는지, 이를 설정하고 모니터링하고 인프라를 각 서버에 접속하지 않고도 관리하는 방법에 대해 배웠다.
또한 어떻게 <code>Ansible</code>이 원격 서버에 접속하는지에 대해 배웠고 어떻게 <code>ansible</code> 명령어가 많은 서버의 작업들을 빠르게 병렬적으로 수행할 수 있는지 하나씩 보았다.</p>
<p>이제 우리는 <code>Ansible</code>의 basic과 익숙해지게 되었고, 더 효과적으로 우리만의 infrastructure를 관리할 수 있게 되었다.</p>


<footer class=" footline" >
	
</footer>


        
        </div> 
        <div id="utterance">    
    <script src="https://utteranc.es/client.js"
            repo="kimmj/kimmj.github.io"
            issue-term="pathname"
            label="comments"
            theme="github-light"
            crossorigin="anonymous"
            async>
    </script>
</div>
      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
            
        
                    
            
        
        
        


	 
	 
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1583379995"></script>
    <script src="/js/perfect-scrollbar.min.js?1583379995"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1583379995"></script>
    <script src="/js/jquery.sticky.js?1583379995"></script>
    <script src="/js/featherlight.min.js?1583379995"></script>
    <script src="/js/highlight.pack.js?1583379995"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1583379995"></script>
    <script src="/js/learn.js?1583379995"></script>
    <script src="/js/hugo-learn.js?1583379995"></script>

    <link href="/mermaid/mermaid.css?1583379995" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1583379995"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>

