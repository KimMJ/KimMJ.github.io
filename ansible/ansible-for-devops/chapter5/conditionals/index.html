<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.62.2" />
    <meta name="description" content="Do Learn">
<meta name="author" content="Myeongjin Kim">

    <link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
    <title>if/then/when - Conditionals :: Ibiza</title>

    
    <link href="/css/nucleus.css?1584111799" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1584111799" rel="stylesheet">
    <link href="/css/hybrid.css?1584111799" rel="stylesheet">
    <link href="/css/featherlight.min.css?1584111799" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1584111799" rel="stylesheet">
    <link href="/css/auto-complete.css?1584111799" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1584111799" rel="stylesheet">
    <link href="/css/theme.css?1584111799" rel="stylesheet">
    <link href="/css/hugo-theme.css?1584111799" rel="stylesheet">
    
      <link href="/css/theme-mine.css?1584111799" rel="stylesheet">
    

    <script src="/js/jquery-3.3.1.min.js?1584111799"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-159865175-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

  </head>
  <body class="" data-url="/ansible/ansible-for-devops/chapter5/conditionals/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <div >
<img src="https://avatars3.githubusercontent.com/u/6358016?s=460&v=4" style="border-radius: 50%; opacity: 0;"  width="50%" height="50%"/>
</div>
<h3 margin="100px"><p style="color: white">Ibiza</p></h3>
<p style="color: white">기록하는 습관</p>
    </div>
    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/ibiza/" title="Ibiza" class="dd-item 
        
        
        
        ">
      <a href="/ibiza/">
          <i class='fas fa-angle-right'></i>&nbsp;Ibiza
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/ibiza/importance-of-record/" title="Importance of Record" class="dd-item ">
        <a href="/ibiza/importance-of-record/">
        <i class='fas fa-minus'></i>&nbsp;Importance of Record
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ibiza/2020-plan/" title="2020 Plan" class="dd-item ">
        <a href="/ibiza/2020-plan/">
        <i class='fas fa-minus'></i>&nbsp;2020 Plan
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ibiza/ibiza-project/" title="Ibiza Project" class="dd-item ">
        <a href="/ibiza/ibiza-project/">
        <i class='fas fa-minus'></i>&nbsp;Ibiza Project
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ibiza/2020-new-year-holiday-plans/" title="2020 New Year Holiday Plans" class="dd-item ">
        <a href="/ibiza/2020-new-year-holiday-plans/">
        <i class='fas fa-minus'></i>&nbsp;2020 New Year Holiday Plans
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/harbor/" title="Harbor" class="dd-item 
        
        
        
        ">
      <a href="/harbor/">
          <i class='fas fa-angle-right'></i>&nbsp;Harbor
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/harbor/install/" title="Harbor 설치" class="dd-item ">
        <a href="/harbor/install/">
        <i class='fas fa-minus'></i>&nbsp;Harbor 설치
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/git/" title="Git" class="dd-item 
        
        
        
        ">
      <a href="/git/">
          <i class='fas fa-angle-right'></i>&nbsp;Git
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/git/git-secret/" title="git-secret을 통한 github 파일 암호화" class="dd-item ">
        <a href="/git/git-secret/">
        <i class='fas fa-minus'></i>&nbsp;git-secret을 통한 github 파일 암호화
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/git/gitignore/" title="Gitignore 설정" class="dd-item ">
        <a href="/git/gitignore/">
        <i class='fas fa-minus'></i>&nbsp;Gitignore 설정
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/python/" title="Python" class="dd-item 
        
        
        
        ">
      <a href="/python/">
          <i class='fas fa-angle-right'></i>&nbsp;Python
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/python/python-beautiful-cli/" title="[번역]Python을 통해 이쁜 CLI 만들기" class="dd-item ">
        <a href="/python/python-beautiful-cli/">
        <i class='fas fa-minus'></i>&nbsp;[번역]Python을 통해 이쁜 CLI 만들기
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/docker/" title="Docker" class="dd-item 
        
        
        
        ">
      <a href="/docker/">
          <i class='fas fa-angle-right'></i>&nbsp;Docker
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/docker/use-docker-without-sudo/" title="Docker를 sudo없이 실행하기" class="dd-item ">
        <a href="/docker/use-docker-without-sudo/">
        <i class='fas fa-minus'></i>&nbsp;Docker를 sudo없이 실행하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docker/connect-container-to-container/" title="[docker-compose] container에서 다른 container로 접속하기" class="dd-item ">
        <a href="/docker/connect-container-to-container/">
        <i class='fas fa-minus'></i>&nbsp;[docker-compose] container에서 다른 container로 접속하기
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/jenkins/" title="Jenkins" class="dd-item 
        
        
        
        ">
      <a href="/jenkins/">
          <i class='fas fa-angle-right'></i>&nbsp;Jenkins
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/jenkins/install/" title="Jenkins Install" class="dd-item ">
        <a href="/jenkins/install/">
        <i class='fas fa-minus'></i>&nbsp;Install
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/iac/" title="IaC" class="dd-item 
        
        
        
        ">
      <a href="/iac/">
          <i class='fas fa-angle-right'></i>&nbsp;IaC
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/iac/translate-what-is-infrastructure-as-a-code/" title="[번역] What Is Infrastructure as a Code? How It Works, Best Practices, Tutorials" class="dd-item ">
        <a href="/iac/translate-what-is-infrastructure-as-a-code/">
        <i class='fas fa-minus'></i>&nbsp;[Translate] What Is Infrastructure as a Code
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/cicd/" title="CICD" class="dd-item 
        
        
        
        ">
      <a href="/cicd/">
          <i class='fas fa-angle-right'></i>&nbsp;CICD
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/cicd/deploy-strategy/" title="Deploy Strategy" class="dd-item ">
        <a href="/cicd/deploy-strategy/">
        <i class='fas fa-minus'></i>&nbsp;Deploy Strategy
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/css/" title="CSS" class="dd-item 
        
        
        
        ">
      <a href="/css/">
          <i class='fas fa-angle-right'></i>&nbsp;CSS
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/css/background-img-darken/" title="background image 어둡게 하기" class="dd-item ">
        <a href="/css/background-img-darken/">
        <i class='fas fa-minus'></i>&nbsp;background image 어둡게 하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/css/greater-than-sign/" title="Greater Than Sign" class="dd-item ">
        <a href="/css/greater-than-sign/">
        <i class='fas fa-minus'></i>&nbsp;Greater Than Sign
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/prometheus/" title="Prometheus" class="dd-item 
        
        
        
        ">
      <a href="/prometheus/">
          <i class='fas fa-angle-right'></i>&nbsp;Prometheus
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/prometheus/install/" title="Install Prometheus" class="dd-item ">
        <a href="/prometheus/install/">
        <i class='fas fa-minus'></i>&nbsp;Install
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/prometheus/federation/" title="Federation" class="dd-item ">
        <a href="/prometheus/federation/">
        <i class='fas fa-minus'></i>&nbsp;Federation
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/kubernetes/" title="Kubernetes" class="dd-item 
        
        
        
        ">
      <a href="/kubernetes/">
          <i class='fas fa-angle-right'></i>&nbsp;Kubernetes
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/kubernetes/installation/" title="Install" class="dd-item 
        
        
        
        ">
      <a href="/kubernetes/installation/">
          <i class='fas fa-angle-right'></i>&nbsp;Install
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/installation/overview/" title="Overview" class="dd-item ">
        <a href="/kubernetes/installation/overview/">
        <i class='fas fa-minus'></i>&nbsp;Overview
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/installation/install-kubeadm/" title="Install Kubeadm" class="dd-item ">
        <a href="/kubernetes/installation/install-kubeadm/">
        <i class='fas fa-minus'></i>&nbsp;Install Kubeadm
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/installation/create-a-single-control-plane-cluster-with-kubeadm/" title="Create a Single Control Plane Cluster With Kubeadm" class="dd-item ">
        <a href="/kubernetes/installation/create-a-single-control-plane-cluster-with-kubeadm/">
        <i class='fas fa-minus'></i>&nbsp;Create a Single Control Plane Cluster With Kubeadm
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/kubernetes/concepts/" title="Concepts" class="dd-item 
        
        
        
        ">
      <a href="/kubernetes/concepts/">
          <i class='fas fa-angle-right'></i>&nbsp;Concepts
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/concepts/controllers-overview/" title="Controllers Overview" class="dd-item ">
        <a href="/kubernetes/concepts/controllers-overview/">
        <i class='fas fa-minus'></i>&nbsp;Controllers Overview
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/concepts/pods/" title="Pods" class="dd-item ">
        <a href="/kubernetes/concepts/pods/">
        <i class='fas fa-minus'></i>&nbsp;Pods
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/stern/" title="Stern을 이용하여 여러 pod의 log를 한번에 확인하기" class="dd-item ">
        <a href="/kubernetes/stern/">
        <i class='fas fa-minus'></i>&nbsp;Stern을 이용하여 여러 pod의 log를 한번에 확인하기
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/hugo/" title="Hugo" class="dd-item 
        
        
        
        ">
      <a href="/hugo/">
          <i class='fas fa-angle-right'></i>&nbsp;Hugo
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/hugo/ibiza/" title="Ibiza" class="dd-item 
        
        
        
        ">
      <a href="/hugo/ibiza/">
          <i class='fas fa-angle-right'></i>&nbsp;Ibiza
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/hugo/ibiza/font-change/" title="Font Change" class="dd-item ">
        <a href="/hugo/ibiza/font-change/">
        <i class='fas fa-minus'></i>&nbsp;Font Change
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/hugo/google-analytics/" title="Hugo에 Google Analytics 적용하기" class="dd-item ">
        <a href="/hugo/google-analytics/">
        <i class='fas fa-minus'></i>&nbsp;Hugo에 Google Analytics 적용하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/hugo/insert-comment/" title="Hugo에 Comment 추가하기 (Utterance)" class="dd-item ">
        <a href="/hugo/insert-comment/">
        <i class='fas fa-minus'></i>&nbsp;Hugo에 Comment 추가하기 (Utterance)
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/hugo/hugo-with-html/" title="HUGO로 HTML이 되지 않을 때 가능하게 하는 방법" class="dd-item ">
        <a href="/hugo/hugo-with-html/">
        <i class='fas fa-minus'></i>&nbsp;hugo with html
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/spinnaker/" title="Spinnaker" class="dd-item 
        
        
        
        ">
      <a href="/spinnaker/">
          <i class='fas fa-angle-right'></i>&nbsp;Spinnaker
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/spinnaker/installation/" title="Installation" class="dd-item 
        
        
        
        ">
      <a href="/spinnaker/installation/">
          <i class='fas fa-angle-right'></i>&nbsp;Installation
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/spinnaker/installation/overview/" title="Overview" class="dd-item ">
        <a href="/spinnaker/installation/overview/">
        <i class='fas fa-minus'></i>&nbsp;Overview
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/spinnaker/installation/install-halyard/" title="Install Halyard" class="dd-item ">
        <a href="/spinnaker/installation/install-halyard/">
        <i class='fas fa-minus'></i>&nbsp;Install Halyard
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/spinnaker/installation/choose-cloud-providers/" title="Choose Cloud Providers" class="dd-item ">
        <a href="/spinnaker/installation/choose-cloud-providers/">
        <i class='fas fa-minus'></i>&nbsp;Choose Cloud Providers
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/spinnaker/installation/choose-your-environment/" title="Choose Your Environment" class="dd-item ">
        <a href="/spinnaker/installation/choose-your-environment/">
        <i class='fas fa-minus'></i>&nbsp;Choose Your Environment
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/spinnaker/installation/choose-a-storage-service/" title="Choose a Storage Service" class="dd-item ">
        <a href="/spinnaker/installation/choose-a-storage-service/">
        <i class='fas fa-minus'></i>&nbsp;Choose a Storage Service
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/spinnaker/installation/deploy-and-connect/" title="Deploy and Connect" class="dd-item ">
        <a href="/spinnaker/installation/deploy-and-connect/">
        <i class='fas fa-minus'></i>&nbsp;Deploy and Connect
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/spinnaker/installation/install-in-air-gaped-environment/" title="Install in Air Gaped Environment" class="dd-item ">
        <a href="/spinnaker/installation/install-in-air-gaped-environment/">
        <i class='fas fa-minus'></i>&nbsp;Install in Air Gaped Environment
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/spinnaker/canaryanalysis/" title="CanaryAnalysis" class="dd-item 
        
        
        
        ">
      <a href="/spinnaker/canaryanalysis/">
          <i class='fas fa-angle-right'></i>&nbsp;CanaryAnalysis
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/spinnaker/canaryanalysis/canary-analysis/" title="Canary Analysis" class="dd-item ">
        <a href="/spinnaker/canaryanalysis/canary-analysis/">
        <i class='fas fa-minus'></i>&nbsp;Canary Analysis
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/spinnaker/tips/" title="Tips" class="dd-item 
        
        
        
        ">
      <a href="/spinnaker/tips/">
          <i class='fas fa-angle-right'></i>&nbsp;Tips
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/spinnaker/tips/pipeline-expressions/" title="Pipeline Expressions" class="dd-item ">
        <a href="/spinnaker/tips/pipeline-expressions/">
        <i class='fas fa-minus'></i>&nbsp;Pipeline Expressions
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/ansible/" title="Ansible" class="dd-item 
        parent
        
        
        ">
      <a href="/ansible/">
          <i class='fas fa-angle-right'></i>&nbsp;Ansible
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/ansible/ansible-for-devops/" title="Ansible for DevOps" class="dd-item 
        parent
        
        
        ">
      <a href="/ansible/ansible-for-devops/">
          <i class='fas fa-angle-right'></i>&nbsp;Ansible for DevOps
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/ansible/ansible-for-devops/getting-started-with-ansible/" title="Chapter 1 - Getting Started With Ansible" class="dd-item ">
        <a href="/ansible/ansible-for-devops/getting-started-with-ansible/">
        <i class='fas fa-minus'></i>&nbsp;Getting Started With Ansible
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ansible/ansible-for-devops/local-infrastructure-development-ansible-and-vagrant/" title="Chapter 2 - Local Infrastructure Development: Ansible and Vagrant" class="dd-item ">
        <a href="/ansible/ansible-for-devops/local-infrastructure-development-ansible-and-vagrant/">
        <i class='fas fa-minus'></i>&nbsp;Local Infrastructure Development: Ansible and Vagrant
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ansible/ansible-for-devops/ad-hoc-commands/" title="Ad Hoc Commands" class="dd-item ">
        <a href="/ansible/ansible-for-devops/ad-hoc-commands/">
        <i class='fas fa-minus'></i>&nbsp;Ad Hoc Commands
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ansible/ansible-for-devops/ansible-playbooks/" title="Ansible Playbooks" class="dd-item ">
        <a href="/ansible/ansible-for-devops/ansible-playbooks/">
        <i class='fas fa-minus'></i>&nbsp;Ansible Playbooks
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/ansible/ansible-for-devops/chapter5/" title="Chapter5" class="dd-item 
        parent
        
        
        ">
      <a href="/ansible/ansible-for-devops/chapter5/">
          <i class='fas fa-angle-right'></i>&nbsp;Chapter5
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/ansible/ansible-for-devops/chapter5/ansible-playbooks-beyond-the-basics/" title="Ansible Playbooks Beyond the Basics" class="dd-item ">
        <a href="/ansible/ansible-for-devops/chapter5/ansible-playbooks-beyond-the-basics/">
        <i class='fas fa-minus'></i>&nbsp;Ansible Playbooks Beyond the Basics
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ansible/ansible-for-devops/chapter5/handover/" title="Handover" class="dd-item ">
        <a href="/ansible/ansible-for-devops/chapter5/handover/">
        <i class='fas fa-minus'></i>&nbsp;Handover
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ansible/ansible-for-devops/chapter5/environment-variables/" title="Environment Variables" class="dd-item ">
        <a href="/ansible/ansible-for-devops/chapter5/environment-variables/">
        <i class='fas fa-minus'></i>&nbsp;Environment Variables
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ansible/ansible-for-devops/chapter5/variables/" title="Variables" class="dd-item ">
        <a href="/ansible/ansible-for-devops/chapter5/variables/">
        <i class='fas fa-minus'></i>&nbsp;Variables
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ansible/ansible-for-devops/chapter5/conditionals/" title="if/then/when - Conditionals" class="dd-item active">
        <a href="/ansible/ansible-for-devops/chapter5/conditionals/">
        <i class='fas fa-minus'></i>&nbsp;if/then/when - Conditionals
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ansible/ansible-for-devops/chapter5/delegation-local-actions-and-pauses/" title="Delegation Local Actions and Pauses" class="dd-item ">
        <a href="/ansible/ansible-for-devops/chapter5/delegation-local-actions-and-pauses/">
        <i class='fas fa-minus'></i>&nbsp;Delegation Local Actions and Pauses
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ansible/ansible-for-devops/chapter5/prompts/" title="Prompts" class="dd-item ">
        <a href="/ansible/ansible-for-devops/chapter5/prompts/">
        <i class='fas fa-minus'></i>&nbsp;Prompts
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ansible/ansible-for-devops/chapter5/tags/" title="Tags" class="dd-item ">
        <a href="/ansible/ansible-for-devops/chapter5/tags/">
        <i class='fas fa-minus'></i>&nbsp;Tags
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ansible/ansible-for-devops/chapter5/summary/" title="Summary" class="dd-item ">
        <a href="/ansible/ansible-for-devops/chapter5/summary/">
        <i class='fas fa-minus'></i>&nbsp;Summary
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/ansible/ansible-for-devops/chapter6/" title="Chapter6" class="dd-item 
        
        
        
        ">
      <a href="/ansible/ansible-for-devops/chapter6/">
          <i class='fas fa-angle-right'></i>&nbsp;Chapter6
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ansible/create-vm-with-ansible-libvirt/" title="Create Vm With Ansible Libvirt" class="dd-item ">
        <a href="/ansible/create-vm-with-ansible-libvirt/">
        <i class='fas fa-minus'></i>&nbsp;Create Vm With Ansible Libvirt
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/ubuntu/" title="Ubuntu" class="dd-item 
        
        
        
        ">
      <a href="/ubuntu/">
          <i class='fas fa-angle-right'></i>&nbsp;Ubuntu
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/ubuntu/tools/" title="Tools" class="dd-item 
        
        
        
        ">
      <a href="/ubuntu/tools/">
          <i class='fas fa-angle-right'></i>&nbsp;Tools
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/tools/tmux/" title="Tmux" class="dd-item ">
        <a href="/ubuntu/tools/tmux/">
        <i class='fas fa-minus'></i>&nbsp;Tmux
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/ubuntu/network/" title="Network" class="dd-item 
        
        
        
        ">
      <a href="/ubuntu/network/">
          <i class='fas fa-angle-right'></i>&nbsp;Network
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/network/netplan/" title="Netplan으로 static IP 할당받기" class="dd-item ">
        <a href="/ubuntu/network/netplan/">
        <i class='fas fa-minus'></i>&nbsp;Netplan으로 static IP 할당받기
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/customize-login-message/" title="Ubuntu의 Login Message 수정하기" class="dd-item ">
        <a href="/ubuntu/customize-login-message/">
        <i class='fas fa-minus'></i>&nbsp;Ubuntu의 Login Message 수정하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/start-tmux-after-reboot/" title="reboot 후에 tmux를 실행시켜 원하는 작업을 하기" class="dd-item ">
        <a href="/ubuntu/start-tmux-after-reboot/">
        <i class='fas fa-minus'></i>&nbsp;reboot 후에 tmux를 실행시켜 원하는 작업을 하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/oh-my-zsh-home-end-key/" title="oh-my-zsh에서 home key와 end key가 안될 때 해결방법" class="dd-item ">
        <a href="/ubuntu/oh-my-zsh-home-end-key/">
        <i class='fas fa-minus'></i>&nbsp;oh-my-zsh에서 home key와 end key가 안될 때 해결방법
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/base64-encode-decode/" title="Ubuntu에서 Base64로 인코딩, 디코딩하기" class="dd-item ">
        <a href="/ubuntu/base64-encode-decode/">
        <i class='fas fa-minus'></i>&nbsp;Ubuntu에서 Base64로 인코딩, 디코딩하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/file-edit-without-editor/" title="Editor(vi)가 없을 때 파일 수정하기" class="dd-item ">
        <a href="/ubuntu/file-edit-without-editor/">
        <i class='fas fa-minus'></i>&nbsp;Editor(vi)가 없을 때 파일 수정하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/check-listen-port/" title="열려있는 포트 확인하기" class="dd-item ">
        <a href="/ubuntu/check-listen-port/">
        <i class='fas fa-minus'></i>&nbsp;열려있는 포트 확인하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/using-watch-with-pipes/" title="pipe를 사용한 명령어를 watch로 확인하기" class="dd-item ">
        <a href="/ubuntu/using-watch-with-pipes/">
        <i class='fas fa-minus'></i>&nbsp;pipe를 사용한 명령어를 watch로 확인하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/use-alias-in-watch/" title="watch를 사용할 때 alias 이용하기" class="dd-item ">
        <a href="/ubuntu/use-alias-in-watch/">
        <i class='fas fa-minus'></i>&nbsp;watch를 사용할 때 alias 이용하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/ssh-without-password/" title="password 없이 ssh 접속하기" class="dd-item ">
        <a href="/ubuntu/ssh-without-password/">
        <i class='fas fa-minus'></i>&nbsp;password 없이 ssh 접속하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/ssh-tunneling/" title="SSH Tunneling 사용법" class="dd-item ">
        <a href="/ubuntu/ssh-tunneling/">
        <i class='fas fa-minus'></i>&nbsp;SSH Tunneling 사용법
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/ssh-with-jump/" title="Gateway를 이용하여 SSH 접속하기" class="dd-item ">
        <a href="/ubuntu/ssh-with-jump/">
        <i class='fas fa-minus'></i>&nbsp;Gateway를 이용하여 SSH 접속하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/change-hostname/" title="Hostname 변경하기" class="dd-item ">
        <a href="/ubuntu/change-hostname/">
        <i class='fas fa-minus'></i>&nbsp;Hostname 변경하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/unattended-ubuntu/" title="추가 입력절차(prompt) 없이 Ubuntu 설치하는 이미지 만들기" class="dd-item ">
        <a href="/ubuntu/unattended-ubuntu/">
        <i class='fas fa-minus'></i>&nbsp;추가 입력절차(prompt) 없이 Ubuntu 설치하는 이미지 만들기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/how-to-edit-boot-parameter-during-install/" title="Ubuntu 설치 시 Boot Parameter를 수정하기" class="dd-item ">
        <a href="/ubuntu/how-to-edit-boot-parameter-during-install/">
        <i class='fas fa-minus'></i>&nbsp;Ubuntu 설치 시 Boot Parameter를 수정하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/how-to-use-sudo-without-password/" title="sudo를 password 없이 사용하기" class="dd-item ">
        <a href="/ubuntu/how-to-use-sudo-without-password/">
        <i class='fas fa-minus'></i>&nbsp;sudo를 password 없이 사용하기
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/english/" title="English" class="dd-item 
        
        
        
        ">
      <a href="/english/">
          <i class='fas fa-angle-right'></i>&nbsp;English
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/english/himym/" title="HIMYM" class="dd-item 
        
        
        
        ">
      <a href="/english/himym/">
          <i class='fas fa-angle-right'></i>&nbsp;HIMYM
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/english/himym/season1/" title="Season1" class="dd-item 
        
        
        
        ">
      <a href="/english/himym/season1/">
          <i class='fas fa-angle-right'></i>&nbsp;Season1
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/english/himym/season1/episode1/" title="Episode1" class="dd-item ">
        <a href="/english/himym/season1/episode1/">
        <i class='fas fa-minus'></i>&nbsp;Episode1
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="https://github.com/KimMJ"><i class='fab fa-github'></i> Github</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://gohugo.io/"><i class='fas fa-bookmark'></i> Hugo Documentation</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://learn.netlify.com/en/"><i class='fas fa-bookmark'></i> Hugo Theme Learn</a>
              </li>
          
              <li> 
                  <a class="padding" href="http://kimmj.github.io/tags"><i class='fas fa-tags'></i> Tags</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>




<div id="docsToc">
  <div class="pi-accordion">
    
    
    
    
    
      
      
    
    
  </div> 
 <button class="push-menu-close-button" onclick="kub.toggleToc()"></button>
</div> 
© 2020 GitHub, Inc.
        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            
            
          
          
            
            
          
          
            <a href='/'>Ibiza</a> > <a href='/ansible/'>Ansible</a> > <a href='/ansible/ansible-for-devops/'>Ansible for DevOps</a> > <a href='/ansible/ansible-for-devops/chapter5/'>Chapter5</a> > if/then/when - Conditionals
          
         
          
         
          
         
          
         
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#jinja2-expressions-python-built-ins-and-logic">Jinja2 Expressions, Python built-ins, and Logic</a>
      <ul>
        <li><a href="#register">register</a></li>
        <li><a href="#when">when</a></li>
        <li><a href="#changed_when-and-failed_when">changed_when and failed_when</a></li>
        <li><a href="#ignore_errors">ignore_errors</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
<div class="tags">

  <a class="tag-link" href="/tags/ansible">ansible</a>

  <a class="tag-link" href="/tags/ansible-for-devops">ansible-for-devops</a>

</div>

        </div>
        
        <div id="body-inner">
          
            <h1>
              
              if/then/when - Conditionals
            </h1>
          

        



<nav id="TableOfContents">
  <ul>
    <li><a href="#jinja2-expressions-python-built-ins-and-logic">Jinja2 Expressions, Python built-ins, and Logic</a>
      <ul>
        <li><a href="#register">register</a></li>
        <li><a href="#when">when</a></li>
        <li><a href="#changed_when-and-failed_when">changed_when and failed_when</a></li>
        <li><a href="#ignore_errors">ignore_errors</a></li>
      </ul>
    </li>
  </ul>
</nav>

<p>많은 task가 특정한 상황에서만 동작해야 하는 조건을 가지고 있다.
몇몇 task는 idempotence가 내장된 module(yum이나 apt 패키지가 설치되어 있는 경우)을 사용하고 우리는 보통 이 task에 대해 추가적인 행동을 정의할 필요가 없다.</p>
<p>하지만 많은 task에서 - 특히 Ansible의 <code>command</code>나 <code>shell</code> module을 사용하는 경우 - 이 module이 실행되고 나서 변화가 있는지 없는지에 따라 또는 실행했을때 실패되었던 경우, 언제 실행될지를 결정하는 추가적인 input을 필요로 하게 된다.</p>
<p>우리는 이런 모든 주된 conditional behavior를 Ansible task에 적용할 수 있도록 할 것이고 또한 Ansible에게 언제 play가 끝나는지 또는 실패하는지를 알려줄수도 있다.</p>
<h2 id="jinja2-expressions-python-built-ins-and-logic">Jinja2 Expressions, Python built-ins, and Logic</h2>
<p>Ansible에서의 conditional에 대해서 이야기하기 전에 Jinja2(Ansible이 template과 conditional 모두에서 사용하는 문법), Python function(보통 <code>built-ins</code>라고 불린다)의 일부분에 대해서 짚고 넘어가는 것이 좋을 것이다.
Ansible은 <code>when</code>, <code>changed_when</code>, <code>failed_when</code>과 함께 expressions와 built-ins를 사용하여 Ansible에게 가능한한 정확하게 설명할 수 있다.</p>
<p>Jinja2는 string(<code>string</code>), integer(<code>42</code>), float(<code>42.33</code>), list(<code>[1, 2, 3]</code>), tuple(list와 비슷하지만 수정할 수 없는 것), dictionary(<code>{key: value, key2: value2}</code>), boolean(<code>true</code>, <code>false</code>)과 같은 literal의 정의를 허용한다.</p>
<p>Jinja2는 또한 기본적인 사칙연산과 비교(<code>==</code>는 일치, <code>!=</code>는 불일치, <code>&gt;=</code>는 이상)를 허용한다.
logical operator는 <code>and</code>, <code>or</code>, <code>not</code>이 있고 괄호를 통해 그룹을 지을 수 있다.</p>
<p>어느 프로그래밍 언어라도 친숙한 것이 있다면 Jinja2 expression의 기본적인 사용법은 금방 배울 수 있을 것이다.</p>
<p>예를 들면 다음과 같다.</p>
<pre><code class="language-jinja2" data-lang="jinja2"># The following expressions evaluate to 'true':
1 in [1, 2, 3]
'see' in 'Can you see me?'
foo != bar
(1 &lt; 2) and ('a' not in 'best')

# The following expressions evaluate to 'false':
4 in [1, 2, 3]
foo == bar
(foo != foo) or (a in [1, 2, 3])
</code></pre><p>또한 Jinja2는 주어진 오브젝트에 대해서 테스트할 수 있는 <code>tests</code> 세트를 제공한다.
예를 들어 <code>foo</code> variable을 특정한 서버의 그룹에서만 정의했다면 <code>foo is defined</code>를 conditional로 사용하여 variable이 정의가 되었을 경우 <code>true</code>를, 아니면 <code>false</code>를 리턴하게 할 수 있다.</p>
<p>또한 <code>undefined</code>(<code>defined</code>의 반대), <code>equalto</code>(<code>==</code>와 비슷하게 동작하는 것), <code>even</code>(짝수일 경우 <code>true</code>를 리턴), <code>iterable</code>(오브젝트를 iterate할 수 있을 경우 <code>true</code>)과 같은 다른 체크들도 할 수 있다.
이 영역에 대해서는 이 책의 뒷부분에서 다룰 것이지만 지금은 Ansible conditional을 Jinja2 expression을 통해 많은 것을 할 수 있다는 것만 알면 된다.</p>
<p>Jinja2를 활용해서 해결할 수 없는 문제의 경우 Python의 built-in library function들(<code>string.split</code>, <code>[number].is_signed()</code>같은 것들)을 사용하여 variable을 조작하고 task가 실행할지 말지, 결과를 change로 할지 failed로 할지 등에 대해 결정할 수 있다.</p>
<p>예를 들면 때때로 version string을 파싱하여 특정 프로젝트의 major version을 찾아내야하는 경우가 있다.
<code>software_version</code>이 4.6.1로 설정되어있다고 가정하면 major version을 <code>.</code>으로 split 한 다음 array에서 첫번째 element를 사용하면 된다.
major version이 <code>4</code>인 경우를 확인하기 위해 <code>when</code>을 사용하고 특정한 task를 실행하도록(또는 실행하지 않도록) 설정한다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">- name: Do something only for version <span style="color:#ae81ff">4</span> of the software.
  [task here]
  when: software_version.split(<span style="color:#e6db74">&#39;.&#39;</span>)[<span style="color:#ae81ff">0</span>] == <span style="color:#e6db74">&#39;4&#39;</span>
</code></pre></div><p>Jinja2 filter와 variable만 사용하는 것이 일반적으로는 가장 좋지만 좀 더 variable을 조작하기 위해서는 Python을 이용하는 것도 나쁘지 않다.</p>
<h3 id="register"><code>register</code></h3>
<p>Ansible에서 어느 play든 variable을 <code>register</code>할 수 있고 한번 register 하고 나면 그 variable은 뒤의 모든 task에서 사용할 수 있게 된다.
register된 variable은 일반적인 variable이나 host fact처럼 사용할 수 있다.</p>
<p>많은 경우에 우리는 shell command의 ouput(stdout 또는 stderr)를 필요로 하고 이를 다음과 같은 syntax를 통해 variable에 넣을 수 있다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">- shell: my_command_here
  register: my_command_result
</code></pre></div><p>후에 우리는 stdout(string으로)을 <code>my_command_result.stdout</code>을 통해 접근할 수 있고 stderr를 <code>my_command_result.stderr</code>를 통해 접근할 수 있다.</p>
<p>registered fact는 많은 종류의 task에서 유용하게 사용되며 conditional(play가 실행되는 when과 how를 정의한 것)과 play의 어느 부분에서도 사용할 수 있다.
예를 들어 command가 <code>10.0.4</code>와 같은 version number string을 출력하고 이를 <code>version</code>으로 output을 register한다면 나중에 <code>{{ version.stdout }}</code>처럼 variable을 출력하여 체크해볼 수 있다.</p>

<div class="notices notes" ><p>특정 registered variable에 대한 다른 속성들을 보고싶다면 playbook을 <code>-v</code> 옵션을 통해 실항하면 play ouput을 확인할 수 있다.
보통 <code>changed</code>(play의 결과가 변경되었을 경우), <code>delta</code>(play를 실행하는데 걸린 시간), <code>stderr</code>, <code>stdout</code>과 같은 value에 접근할 수 있다.
몇몇 Ansible module(<code>stat</code>과 같은)들은 registered variable보다 더 많은 정보를 가지고 있기 때문에 <code>-v</code>를 통해 그 안에 무엇이 있는지 확인하는 것이 좋다.</p>
</div>

<h3 id="when"><code>when</code></h3>
<p>play에 추가할 수 있는 유용한 extra key중 하나는 <code>when</code> statement이다.
간단한 <code>when</code>의 사례를 보도록 하자.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">- yum: name=mysql-server state=present
  when: is_db_server
</code></pre></div><p>위의 statement는 <code>is_db_server</code> variable을 앞에서 boolean(<code>true</code>, <code>false</code>)으로 정의했다고 가정하고 value가 <code>true</code>이면 실행하고 <code>false</code>이면 건너뛰도록 한다.</p>
<p><code>is_db_server</code> variable을 database server에서만 정의했을 경우(variable이 아예 정의되지 않을 수도 있는 경우를 의미한다) 다음과 같이 task에 조건을 걸 수 있다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">- yum: name=mysql-server state=present
  when: (is_db_server is defined) and is_db_server
</code></pre></div><p><code>when</code>은 variable이 이전 task에서 등록이 됐는지 확인하는 절차를 함께 넣으면 더욱 강력하다.
예를 들어 실행중인 어플리케이션의 상태를 체크하기 원하고 그 어플리케이션이 <code>ready</code> output을 보고했을 때만 play를 실행하고 싶은 경우가 있다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">- command: my-app --status
  register: myapp_result

- command: do-something-to-my-app
  when: <span style="color:#e6db74">&#34;&#39;ready&#39; in myapp_result.stdout&#34;</span>
</code></pre></div><p>이 예시는 약간 부자연스럽긴 하지만 <code>when</code>이 task에서 보통 어떻게 쓰이는지에 대해서는 잘 묘사해주고 있다.
<code>when</code>을 실제 playbook에서 어떻게 사용하는지 예시를 확인해보자.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#75715e"># From our Node.js playbook - register a command&#39;s output, then see</span>
<span style="color:#75715e"># if the path to our app is in the output. Start the app if it&#39;s</span>
<span style="color:#75715e"># not present</span>
- command: forever list
  register: forever_list
- command: forever start /path/to/app/app.js
  when: <span style="color:#e6db74">&#34;forever_list.stdout.find(&#39;/path/to/app/app.js&#39;) == -1&#34;</span>

<span style="color:#75715e"># Run &#39;ping-hosts.sh&#39; script if &#39;ping_hosts&#39; variable is true.</span>
- command: /usr/local/bin/ping-hosts.sh
  when: ping_hosts

<span style="color:#75715e"># Run &#39;git-cleanup.sh&#39; script if a branch we&#39;re interested in is</span>
<span style="color:#75715e"># missing from git&#39;s list of branches in our project.</span>
- command: chdir=/path/to/project git branch
  register: git_branches
- command: /path/to/project/scripts/git-cleanup.sh
  when: <span style="color:#e6db74">&#34;(is_app_server == true) and (&#39;interesting-branch&#39; not in git_branches.stdout)&#34;</span>

<span style="color:#75715e"># Downgrade PHP version if the current version contains &#39;7.0&#39;.</span>
- shell: php --version
  register: php_version
- shell: yum -y downgrade php*
  when: <span style="color:#e6db74">&#34;&#39;7.0&#39; in php_version.stdout&#34;</span>

<span style="color:#75715e"># Copy a file to the remote server if the hosts file doesn&#39;t exist.</span>
- stat: path=/etc/hosts
  register: hosts_file
- copy: src=path/to/local/file dest=/path/to/remote/file
  when: hosts_file.stat.exists == <span style="color:#66d9ef">false</span>
</code></pre></div><h3 id="changed_when-and-failed_when"><code>changed_when</code> and <code>failed_when</code></h3>
<p><code>when</code>처럼 <code>changed_when</code>과 <code>failed_when</code>을 사용하여 특정 task가 changes 또는 failures일 경우 Ansible의 reporting에 영향을 줄 수 있다.</p>
<p>Ansible이 주어진 command의 결과가 change인지 확인하는 것은 어렵기 때문에 <code>comand</code>나 <code>shell</code> module을 <code>changed_when</code> 사용하지 않고 사용하고자 한다면 Ansible은 항상 change를 report할 것이다.
대부분의 Ansible module은 result가 올바르게 changes로 되던 안되던 report를 하지만 이 동작을 <code>changed_when</code>을 통해서 override할 수도 있다.</p>
<p>PHP Composer를 command로 사용하여 project dependency들을 설치할 때 Composer가 어떤것을 설치했는지 또는 언제부터 변경사항이 없는지를 알 때 유용하다.
다음은 이에 대한 예시이다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">- name: Install dependencies via Composer.
  command: <span style="color:#e6db74">&#34;/usr/local/bin/composer global require phpunit/phpunit --prefer-dist&#34;</span>
  register: composer
  changed_when: <span style="color:#e6db74">&#34;&#39;Nothing to install or update&#39; not in composer.stdout&#34;</span>
</code></pre></div><p><code>register</code>를 사용하여 command의 result를 저장한 것을 볼 수 있고 그 다음 특정 string이 registered variable의 stdout에 있는지를 확인한다.
Composer가 아무것도 안하면 <code>Nothing to install or update</code>를 출력할 것이고 우리는 그 string을 사용하여 Ansible에게 그 task가 change인지를 알려준다.</p>
<p>많은 command-line ultility가 stdout 대신 stderr를 프린트하기 때문에 <code>failed_when</code>은 Ansible에게 언제 task가 <em>실제로</em> failed되었는지, 그리고 이를 잘못된 방향으로 report하지 않도록 알려줄 수 있다.
다음은 Jenkins CLI command의 stderr를 파싱하여 Jenkins에서 실제로 우리가 요청한 command의 수행이 실패했는지를 확인해볼 수 있는 예시이다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">- name: Import a Jenkins job via CLI.
  shell: <span style="color:#e6db74">&gt;
</span><span style="color:#e6db74">   </span><span style="color:#e6db74"> </span><span style="color:#e6db74">java -jar /opt/jenkins-cli.jar -s http://localhost:8080/</span>
    create-job <span style="color:#e6db74">&#34;My Job&#34;</span> &lt; /usr/local/my-job.xml
  register: import
  failed_when: <span style="color:#e6db74">&#34;import.stderr and &#39;already exists&#39; not in import.stderr&#34;</span>
</code></pre></div><p>이 경우 우리는 command가 error를 리턴했을 때와 error가 <code>already exists</code>를 포함하지 않을 때에만 Ansible이 failure를 report하도록 하고 싶다.
command가 job이 이미 존재하는 것을 stderr로 report하는지 아니면 그냥 stdout으로 report하는지에 대해서는 논란의 소지가 많지만 command가 Ansible에 어떤것을 하는지는 설명하기가 쉽다.</p>
<h3 id="ignore_errors"><code>ignore_errors</code></h3>
<p>때로 항상 실행되어야 하는 명령어가 있고 이 명령어들이 대부분 error를 발생한다.
또는 실행하는 스크립트에서 error가 에러를 곳곳에서 발생시키고 에러가 사실상 문제점을 나타내는 것이 아지만 짜증나게 하는 경우(그래서 결국 playbook이 실행을 멈추게 되는 경우)가 있다.</p>
<p>이런 상황에서 <code>ignore_errors</code>를 task에 추가하며 Ansible은 특정 task를 실행하는 데 어떤 문제도 알아차리지 못할 것이다.
그러나 이를 사용하는 것은 항상 조심해야 한다.
task에서 에러가 발생하느 경우 playbook이 실제로 문제점을 나타낸다면 fail을 하도록 하고 아닌 경우에도 동작할 수 있는 방법을 찾는것이 가장 좋다.</p>


<footer class=" footline" >
	
</footer>


        
            <div id="utterance">    
    <script src="https://utteranc.es/client.js"
            repo="kimmj/kimmj.github.io"
            issue-term="pathname"
            label="comments"
            theme="github-light"
            crossorigin="anonymous"
            async>
    </script>
</div>
        
        </div> 
      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
            
        
                    
            
        
        
        


	 
	 
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1584111799"></script>
    <script src="/js/perfect-scrollbar.min.js?1584111799"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1584111799"></script>
    <script src="/js/jquery.sticky.js?1584111799"></script>
    <script src="/js/featherlight.min.js?1584111799"></script>
    <script src="/js/highlight.pack.js?1584111799"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1584111799"></script>
    <script src="/js/learn.js?1584111799"></script>
    <script src="/js/hugo-learn.js?1584111799"></script>

    <link href="/mermaid/mermaid.css?1584111799" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1584111799"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    
    

  </body>
</html>

