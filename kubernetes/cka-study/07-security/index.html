<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.62.2" />
    <meta name="description" content="Do Learn">
<meta name="author" content="Myeongjin Kim">

    <link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
    <title>07 Security :: Ibiza</title>

    
    <link href="/css/nucleus.css?1602316121" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1602316121" rel="stylesheet">
    <link href="/css/hybrid.css?1602316121" rel="stylesheet">
    <link href="/css/featherlight.min.css?1602316121" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1602316121" rel="stylesheet">
    <link href="/css/auto-complete.css?1602316121" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1602316121" rel="stylesheet">
    <link href="/css/theme.css?1602316121" rel="stylesheet">
    <link href="/css/hugo-theme.css?1602316121" rel="stylesheet">
    
      <link href="/css/theme-mine.css?1602316121" rel="stylesheet">
    

    <script src="/js/jquery-3.3.1.min.js?1602316121"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-159865175-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

<script data-ad-client="ca-pub-1788337254638181" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  </head>
  <body class="" data-url="/kubernetes/cka-study/07-security/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <div >
<img src="https://avatars3.githubusercontent.com/u/6358016?s=460&v=4" style="border-radius: 50%; opacity: 0;"  width="50%" height="50%"/>
</div>
<h3 margin="100px"><p style="color: white">Ibiza</p></h3>
<p style="color: white">기록하는 습관</p>
    </div>
    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/harbor/" title="Harbor" class="dd-item 
        
        
        
        ">
      <a href="/harbor/">
          <i class='fas fa-angle-right'></i>&nbsp;Harbor
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/harbor/install/" title="Harbor 설치" class="dd-item ">
        <a href="/harbor/install/">
        <i class='fas fa-minus'></i>&nbsp;Harbor 설치
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/git/" title="Git" class="dd-item 
        
        
        
        ">
      <a href="/git/">
          <i class='fas fa-angle-right'></i>&nbsp;Git
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/git/git-secret/" title="git-secret을 통한 github 파일 암호화" class="dd-item ">
        <a href="/git/git-secret/">
        <i class='fas fa-minus'></i>&nbsp;git-secret을 통한 github 파일 암호화
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/git/gitignore/" title="Gitignore 설정" class="dd-item ">
        <a href="/git/gitignore/">
        <i class='fas fa-minus'></i>&nbsp;Gitignore 설정
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/python/" title="Python" class="dd-item 
        
        
        
        ">
      <a href="/python/">
          <i class='fas fa-angle-right'></i>&nbsp;Python
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/python/python-beautiful-cli/" title="[번역]Python을 통해 이쁜 CLI 만들기" class="dd-item ">
        <a href="/python/python-beautiful-cli/">
        <i class='fas fa-minus'></i>&nbsp;[번역]Python을 통해 이쁜 CLI 만들기
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/docker/" title="Docker" class="dd-item 
        
        
        
        ">
      <a href="/docker/">
          <i class='fas fa-angle-right'></i>&nbsp;Docker
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/docker/insecure-registry/" title="http를 사용하는 docker registry를 위한 insecure registry 설정" class="dd-item ">
        <a href="/docker/insecure-registry/">
        <i class='fas fa-minus'></i>&nbsp;http를 사용하는 docker registry를 위한 insecure registry 설정
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docker/use-docker-without-sudo/" title="Docker를 sudo없이 실행하기" class="dd-item ">
        <a href="/docker/use-docker-without-sudo/">
        <i class='fas fa-minus'></i>&nbsp;Docker를 sudo없이 실행하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docker/connect-container-to-container/" title="[docker-compose] container에서 다른 container로 접속하기" class="dd-item ">
        <a href="/docker/connect-container-to-container/">
        <i class='fas fa-minus'></i>&nbsp;[docker-compose] container에서 다른 container로 접속하기
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/jenkins/" title="Jenkins" class="dd-item 
        
        
        
        ">
      <a href="/jenkins/">
          <i class='fas fa-angle-right'></i>&nbsp;Jenkins
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/jenkins/install/" title="Jenkins Install" class="dd-item ">
        <a href="/jenkins/install/">
        <i class='fas fa-minus'></i>&nbsp;Install
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/jenkins/workspace-list/" title="Workspace@2를 변경하기 - Workspace List 설정 변경" class="dd-item ">
        <a href="/jenkins/workspace-list/">
        <i class='fas fa-minus'></i>&nbsp;Workspace@2를 변경하기 - Workspace List 설정 변경
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/iac/" title="IaC" class="dd-item 
        
        
        
        ">
      <a href="/iac/">
          <i class='fas fa-angle-right'></i>&nbsp;IaC
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/iac/translate-what-is-infrastructure-as-a-code/" title="[번역] What Is Infrastructure as a Code? How It Works, Best Practices, Tutorials" class="dd-item ">
        <a href="/iac/translate-what-is-infrastructure-as-a-code/">
        <i class='fas fa-minus'></i>&nbsp;[Translate] What Is Infrastructure as a Code
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/cicd/" title="CICD" class="dd-item 
        
        
        
        ">
      <a href="/cicd/">
          <i class='fas fa-angle-right'></i>&nbsp;CICD
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/cicd/deploy-strategy/" title="Deploy Strategy" class="dd-item ">
        <a href="/cicd/deploy-strategy/">
        <i class='fas fa-minus'></i>&nbsp;Deploy Strategy
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/css/" title="CSS" class="dd-item 
        
        
        
        ">
      <a href="/css/">
          <i class='fas fa-angle-right'></i>&nbsp;CSS
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/css/background-img-darken/" title="background image 어둡게 하기" class="dd-item ">
        <a href="/css/background-img-darken/">
        <i class='fas fa-minus'></i>&nbsp;background image 어둡게 하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/css/greater-than-sign/" title="Greater Than Sign" class="dd-item ">
        <a href="/css/greater-than-sign/">
        <i class='fas fa-minus'></i>&nbsp;Greater Than Sign
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/prometheus/" title="Prometheus" class="dd-item 
        
        
        
        ">
      <a href="/prometheus/">
          <i class='fas fa-angle-right'></i>&nbsp;Prometheus
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/prometheus/install/" title="Install Prometheus" class="dd-item ">
        <a href="/prometheus/install/">
        <i class='fas fa-minus'></i>&nbsp;Install
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/prometheus/federation/" title="Federation" class="dd-item ">
        <a href="/prometheus/federation/">
        <i class='fas fa-minus'></i>&nbsp;Federation
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/kubernetes/" title="Kubernetes" class="dd-item 
        parent
        
        
        ">
      <a href="/kubernetes/">
          <i class='fas fa-angle-right'></i>&nbsp;Kubernetes
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/kubernetes/installation/" title="Install" class="dd-item 
        
        
        
        ">
      <a href="/kubernetes/installation/">
          <i class='fas fa-angle-right'></i>&nbsp;Install
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/installation/overview/" title="Overview" class="dd-item ">
        <a href="/kubernetes/installation/overview/">
        <i class='fas fa-minus'></i>&nbsp;Overview
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/installation/install-kubeadm/" title="Install Kubeadm" class="dd-item ">
        <a href="/kubernetes/installation/install-kubeadm/">
        <i class='fas fa-minus'></i>&nbsp;Install Kubeadm
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/installation/create-a-single-control-plane-cluster-with-kubeadm/" title="Create a Single Control Plane Cluster With Kubeadm" class="dd-item ">
        <a href="/kubernetes/installation/create-a-single-control-plane-cluster-with-kubeadm/">
        <i class='fas fa-minus'></i>&nbsp;Create a Single Control Plane Cluster With Kubeadm
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/kubernetes/cka-study/" title="CKA Study" class="dd-item 
        parent
        
        
        ">
      <a href="/kubernetes/cka-study/">
          <i class='fas fa-angle-right'></i>&nbsp;CKA Study
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/cka-study/02-core-concepts/" title="02 Core Concepts" class="dd-item ">
        <a href="/kubernetes/cka-study/02-core-concepts/">
        <i class='fas fa-minus'></i>&nbsp;02 Core Concepts
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/cka-study/03-scheduling/" title="03 Scheduling" class="dd-item ">
        <a href="/kubernetes/cka-study/03-scheduling/">
        <i class='fas fa-minus'></i>&nbsp;03 Scheduling
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/cka-study/04-logging-and-monitoring/" title="04 Logging and Monitoring" class="dd-item ">
        <a href="/kubernetes/cka-study/04-logging-and-monitoring/">
        <i class='fas fa-minus'></i>&nbsp;04 Logging and Monitoring
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/cka-study/05-application-lifecycle-management/" title="05 Application Lifecycle Management" class="dd-item ">
        <a href="/kubernetes/cka-study/05-application-lifecycle-management/">
        <i class='fas fa-minus'></i>&nbsp;05 Application Lifecycle Management
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/cka-study/06-cluster-maintenance/" title="06 Cluster Maintenance" class="dd-item ">
        <a href="/kubernetes/cka-study/06-cluster-maintenance/">
        <i class='fas fa-minus'></i>&nbsp;06 Cluster Maintenance
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/cka-study/07-security/" title="07 Security" class="dd-item active">
        <a href="/kubernetes/cka-study/07-security/">
        <i class='fas fa-minus'></i>&nbsp;07 Security
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/cka-study/08-storage/" title="08 Storage" class="dd-item ">
        <a href="/kubernetes/cka-study/08-storage/">
        <i class='fas fa-minus'></i>&nbsp;08 Storage
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/cka-study/09-networking/" title="09 Networking" class="dd-item ">
        <a href="/kubernetes/cka-study/09-networking/">
        <i class='fas fa-minus'></i>&nbsp;09 Networking
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/cka-study/10-kubernetes-the-hard-way/" title="10 Kubernetes the Hard Way" class="dd-item ">
        <a href="/kubernetes/cka-study/10-kubernetes-the-hard-way/">
        <i class='fas fa-minus'></i>&nbsp;10 Kubernetes the Hard Way
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/cka-study/12-end-to-end-tests-on-a-kubernetes-cluster/" title="12 End to End Tests on a Kubernetes Cluster" class="dd-item ">
        <a href="/kubernetes/cka-study/12-end-to-end-tests-on-a-kubernetes-cluster/">
        <i class='fas fa-minus'></i>&nbsp;12 End to End Tests on a Kubernetes Cluster
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/cka-study/13-troubleshooting/" title="13 Troubleshooting" class="dd-item ">
        <a href="/kubernetes/cka-study/13-troubleshooting/">
        <i class='fas fa-minus'></i>&nbsp;13 Troubleshooting
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/cka-study/14-other-topics/" title="14 Other Topics" class="dd-item ">
        <a href="/kubernetes/cka-study/14-other-topics/">
        <i class='fas fa-minus'></i>&nbsp;14 Other Topics
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/kubernetes/concepts/" title="Concepts" class="dd-item 
        
        
        
        ">
      <a href="/kubernetes/concepts/">
          <i class='fas fa-angle-right'></i>&nbsp;Concepts
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/concepts/controllers-overview/" title="Controllers Overview" class="dd-item ">
        <a href="/kubernetes/concepts/controllers-overview/">
        <i class='fas fa-minus'></i>&nbsp;Controllers Overview
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/concepts/services/" title="Services" class="dd-item ">
        <a href="/kubernetes/concepts/services/">
        <i class='fas fa-minus'></i>&nbsp;Services
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/concepts/pods/" title="Pods" class="dd-item ">
        <a href="/kubernetes/concepts/pods/">
        <i class='fas fa-minus'></i>&nbsp;Pods
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/cka-epilogue/" title="CKA: Certified Kubernetes Administrator 취득 후기" class="dd-item ">
        <a href="/kubernetes/cka-epilogue/">
        <i class='fas fa-minus'></i>&nbsp;CKA: Certified Kubernetes Administrator 취득 후기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/port-targetport-nodeport-in-kubernetes/" title="[번역] 쿠버네티스에서의 Port, TargetPort, NodePort" class="dd-item ">
        <a href="/kubernetes/port-targetport-nodeport-in-kubernetes/">
        <i class='fas fa-minus'></i>&nbsp;[번역] 쿠버네티스에서의 Port, TargetPort, NodePort
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/stern/" title="Stern을 이용하여 여러 pod의 log를 한번에 확인하기" class="dd-item ">
        <a href="/kubernetes/stern/">
        <i class='fas fa-minus'></i>&nbsp;Stern을 이용하여 여러 pod의 log를 한번에 확인하기
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/hugo/" title="Hugo" class="dd-item 
        
        
        
        ">
      <a href="/hugo/">
          <i class='fas fa-angle-right'></i>&nbsp;Hugo
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/hugo/ibiza/" title="Ibiza" class="dd-item 
        
        
        
        ">
      <a href="/hugo/ibiza/">
          <i class='fas fa-angle-right'></i>&nbsp;Ibiza
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/hugo/ibiza/font-change/" title="Font Change" class="dd-item ">
        <a href="/hugo/ibiza/font-change/">
        <i class='fas fa-minus'></i>&nbsp;Font Change
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/hugo/google-analytics/" title="Hugo에 Google Analytics 적용하기" class="dd-item ">
        <a href="/hugo/google-analytics/">
        <i class='fas fa-minus'></i>&nbsp;Hugo에 Google Analytics 적용하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/hugo/insert-comment/" title="Hugo에 Comment 추가하기 (Utterance)" class="dd-item ">
        <a href="/hugo/insert-comment/">
        <i class='fas fa-minus'></i>&nbsp;Hugo에 Comment 추가하기 (Utterance)
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/hugo/hugo-with-html/" title="HUGO로 HTML이 되지 않을 때 가능하게 하는 방법" class="dd-item ">
        <a href="/hugo/hugo-with-html/">
        <i class='fas fa-minus'></i>&nbsp;hugo with html
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/spinnaker/" title="Spinnaker" class="dd-item 
        
        
        
        ">
      <a href="/spinnaker/">
          <i class='fas fa-angle-right'></i>&nbsp;Spinnaker
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/spinnaker/installation/" title="Installation" class="dd-item 
        
        
        
        ">
      <a href="/spinnaker/installation/">
          <i class='fas fa-angle-right'></i>&nbsp;Installation
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/spinnaker/installation/overview/" title="Overview" class="dd-item ">
        <a href="/spinnaker/installation/overview/">
        <i class='fas fa-minus'></i>&nbsp;Overview
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/spinnaker/installation/install-halyard/" title="Install Halyard" class="dd-item ">
        <a href="/spinnaker/installation/install-halyard/">
        <i class='fas fa-minus'></i>&nbsp;Install Halyard
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/spinnaker/installation/choose-cloud-providers/" title="Choose Cloud Providers" class="dd-item ">
        <a href="/spinnaker/installation/choose-cloud-providers/">
        <i class='fas fa-minus'></i>&nbsp;Choose Cloud Providers
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/spinnaker/installation/choose-your-environment/" title="Choose Your Environment" class="dd-item ">
        <a href="/spinnaker/installation/choose-your-environment/">
        <i class='fas fa-minus'></i>&nbsp;Choose Your Environment
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/spinnaker/installation/choose-a-storage-service/" title="Choose a Storage Service" class="dd-item ">
        <a href="/spinnaker/installation/choose-a-storage-service/">
        <i class='fas fa-minus'></i>&nbsp;Choose a Storage Service
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/spinnaker/installation/deploy-and-connect/" title="Deploy and Connect" class="dd-item ">
        <a href="/spinnaker/installation/deploy-and-connect/">
        <i class='fas fa-minus'></i>&nbsp;Deploy and Connect
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/spinnaker/installation/install-in-air-gaped-environment/" title="Install in Air Gaped Environment" class="dd-item ">
        <a href="/spinnaker/installation/install-in-air-gaped-environment/">
        <i class='fas fa-minus'></i>&nbsp;Install in Air Gaped Environment
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/spinnaker/canaryanalysis/" title="CanaryAnalysis" class="dd-item 
        
        
        
        ">
      <a href="/spinnaker/canaryanalysis/">
          <i class='fas fa-angle-right'></i>&nbsp;CanaryAnalysis
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/spinnaker/canaryanalysis/canary-analysis/" title="Canary Analysis" class="dd-item ">
        <a href="/spinnaker/canaryanalysis/canary-analysis/">
        <i class='fas fa-minus'></i>&nbsp;Canary Analysis
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/spinnaker/tips/" title="Tips" class="dd-item 
        
        
        
        ">
      <a href="/spinnaker/tips/">
          <i class='fas fa-angle-right'></i>&nbsp;Tips
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/spinnaker/tips/pipeline-expressions/" title="Pipeline Expressions" class="dd-item ">
        <a href="/spinnaker/tips/pipeline-expressions/">
        <i class='fas fa-minus'></i>&nbsp;Pipeline Expressions
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/ansible/" title="Ansible" class="dd-item 
        
        
        
        ">
      <a href="/ansible/">
          <i class='fas fa-angle-right'></i>&nbsp;Ansible
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/ansible/create-vm-with-ansible-libvirt/" title="Create Vm With Ansible Libvirt" class="dd-item ">
        <a href="/ansible/create-vm-with-ansible-libvirt/">
        <i class='fas fa-minus'></i>&nbsp;Create Vm With Ansible Libvirt
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/ubuntu/" title="Ubuntu" class="dd-item 
        
        
        
        ">
      <a href="/ubuntu/">
          <i class='fas fa-angle-right'></i>&nbsp;Ubuntu
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/ubuntu/tools/" title="Tools" class="dd-item 
        
        
        
        ">
      <a href="/ubuntu/tools/">
          <i class='fas fa-angle-right'></i>&nbsp;Tools
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/tools/tmux/" title="Tmux" class="dd-item ">
        <a href="/ubuntu/tools/tmux/">
        <i class='fas fa-minus'></i>&nbsp;Tmux
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/ubuntu/network/" title="Network" class="dd-item 
        
        
        
        ">
      <a href="/ubuntu/network/">
          <i class='fas fa-angle-right'></i>&nbsp;Network
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/network/netplan/" title="Netplan으로 static IP 할당받기" class="dd-item ">
        <a href="/ubuntu/network/netplan/">
        <i class='fas fa-minus'></i>&nbsp;Netplan으로 static IP 할당받기
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/customize-login-message/" title="Ubuntu의 Login Message 수정하기" class="dd-item ">
        <a href="/ubuntu/customize-login-message/">
        <i class='fas fa-minus'></i>&nbsp;Ubuntu의 Login Message 수정하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/start-tmux-after-reboot/" title="reboot 후에 tmux를 실행시켜 원하는 작업을 하기" class="dd-item ">
        <a href="/ubuntu/start-tmux-after-reboot/">
        <i class='fas fa-minus'></i>&nbsp;reboot 후에 tmux를 실행시켜 원하는 작업을 하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/oh-my-zsh-home-end-key/" title="oh-my-zsh에서 home key와 end key가 안될 때 해결방법" class="dd-item ">
        <a href="/ubuntu/oh-my-zsh-home-end-key/">
        <i class='fas fa-minus'></i>&nbsp;oh-my-zsh에서 home key와 end key가 안될 때 해결방법
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/base64-encode-decode/" title="Ubuntu에서 Base64로 인코딩, 디코딩하기" class="dd-item ">
        <a href="/ubuntu/base64-encode-decode/">
        <i class='fas fa-minus'></i>&nbsp;Ubuntu에서 Base64로 인코딩, 디코딩하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/file-edit-without-editor/" title="Editor(vi)가 없을 때 파일 수정하기" class="dd-item ">
        <a href="/ubuntu/file-edit-without-editor/">
        <i class='fas fa-minus'></i>&nbsp;Editor(vi)가 없을 때 파일 수정하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/check-listen-port/" title="열려있는 포트 확인하기" class="dd-item ">
        <a href="/ubuntu/check-listen-port/">
        <i class='fas fa-minus'></i>&nbsp;열려있는 포트 확인하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/using-watch-with-pipes/" title="pipe를 사용한 명령어를 watch로 확인하기" class="dd-item ">
        <a href="/ubuntu/using-watch-with-pipes/">
        <i class='fas fa-minus'></i>&nbsp;pipe를 사용한 명령어를 watch로 확인하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/use-alias-in-watch/" title="watch를 사용할 때 alias 이용하기" class="dd-item ">
        <a href="/ubuntu/use-alias-in-watch/">
        <i class='fas fa-minus'></i>&nbsp;watch를 사용할 때 alias 이용하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/ssh-without-password/" title="password 없이 ssh 접속하기" class="dd-item ">
        <a href="/ubuntu/ssh-without-password/">
        <i class='fas fa-minus'></i>&nbsp;password 없이 ssh 접속하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/ssh-tunneling/" title="SSH Tunneling 사용법" class="dd-item ">
        <a href="/ubuntu/ssh-tunneling/">
        <i class='fas fa-minus'></i>&nbsp;SSH Tunneling 사용법
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/ssh-with-jump/" title="Gateway를 이용하여 SSH 접속하기" class="dd-item ">
        <a href="/ubuntu/ssh-with-jump/">
        <i class='fas fa-minus'></i>&nbsp;Gateway를 이용하여 SSH 접속하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/change-hostname/" title="Hostname 변경하기" class="dd-item ">
        <a href="/ubuntu/change-hostname/">
        <i class='fas fa-minus'></i>&nbsp;Hostname 변경하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/unattended-ubuntu/" title="추가 입력절차(prompt) 없이 Ubuntu 설치하는 이미지 만들기" class="dd-item ">
        <a href="/ubuntu/unattended-ubuntu/">
        <i class='fas fa-minus'></i>&nbsp;추가 입력절차(prompt) 없이 Ubuntu 설치하는 이미지 만들기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/how-to-edit-boot-parameter-during-install/" title="Ubuntu 설치 시 Boot Parameter를 수정하기" class="dd-item ">
        <a href="/ubuntu/how-to-edit-boot-parameter-during-install/">
        <i class='fas fa-minus'></i>&nbsp;Ubuntu 설치 시 Boot Parameter를 수정하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/how-to-use-sudo-without-password/" title="sudo를 password 없이 사용하기" class="dd-item ">
        <a href="/ubuntu/how-to-use-sudo-without-password/">
        <i class='fas fa-minus'></i>&nbsp;sudo를 password 없이 사용하기
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="https://github.com/KimMJ"><i class='fab fa-github'></i> Github</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://gohugo.io/"><i class='fas fa-bookmark'></i> Hugo Documentation</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://learn.netlify.com/en/"><i class='fas fa-bookmark'></i> Hugo Theme Learn</a>
              </li>
          
              <li> 
                  <a class="padding" href="http://kimmj.github.io/tags"><i class='fas fa-tags'></i> Tags</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>




<div id="docsToc">
  <div class="pi-accordion">
    
    
    
    
    
      
      
    
    
  </div> 
 <button class="push-menu-close-button" onclick="kub.toggleToc()"></button>
</div> 
© 2020 GitHub, Inc.
        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            
            
          
          
            <a href='/'>Ibiza</a> > <a href='/kubernetes/'>Kubernetes</a> > <a href='/kubernetes/cka-study/'>CKA Study</a> > 07 Security
          
         
          
         
          
         
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#kubernetes-security-primitives">Kubernetes Security Primitives</a></li>
    <li><a href="#authentication">Authentication</a></li>
    <li><a href="#tls-basics">TLS Basics</a></li>
    <li><a href="#tls-in-kubernetes---certificate-creation">TLS in Kubernetes - Certificate Creation</a></li>
    <li><a href="#view-certificate-details">View Certificate Details</a></li>
    <li><a href="#certificates-api">Certificates API</a></li>
    <li><a href="#kubeconfig">Kubeconfig</a></li>
    <li><a href="#api-groups">API Groups</a></li>
    <li><a href="#role-based-access-controls">Role Based Access Controls</a></li>
    <li><a href="#cluster-roles">Cluster Roles</a></li>
    <li><a href="#image-security">Image Security</a></li>
    <li><a href="#security-contexts">Security Contexts</a></li>
    <li><a href="#network-policy">Network Policy</a></li>
    <li><a href="#tips">Tips</a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
<div class="tags">

  <a class="tag-link" href="/tags/kubernetes">kubernetes</a>

  <a class="tag-link" href="/tags/cka">cka</a>

</div>

        </div>
        
        <div id="body-inner">
          
            <h1>
              
              07 Security
            </h1>
          

        



<nav id="TableOfContents">
  <ul>
    <li><a href="#kubernetes-security-primitives">Kubernetes Security Primitives</a></li>
    <li><a href="#authentication">Authentication</a></li>
    <li><a href="#tls-basics">TLS Basics</a></li>
    <li><a href="#tls-in-kubernetes---certificate-creation">TLS in Kubernetes - Certificate Creation</a></li>
    <li><a href="#view-certificate-details">View Certificate Details</a></li>
    <li><a href="#certificates-api">Certificates API</a></li>
    <li><a href="#kubeconfig">Kubeconfig</a></li>
    <li><a href="#api-groups">API Groups</a></li>
    <li><a href="#role-based-access-controls">Role Based Access Controls</a></li>
    <li><a href="#cluster-roles">Cluster Roles</a></li>
    <li><a href="#image-security">Image Security</a></li>
    <li><a href="#security-contexts">Security Contexts</a></li>
    <li><a href="#network-policy">Network Policy</a></li>
    <li><a href="#tips">Tips</a></li>
  </ul>
</nav>

<h2 id="kubernetes-security-primitives">Kubernetes Security Primitives</h2>
<ul>
<li>host와 cluster 자체의 security
<ul>
<li>당연히 host는 그 자체로 안전해야하고, root access는 disable 되어야 하며 password based authentication은 disabled되고 SSH key based authentication만 가능해야 한다.</li>
<li>Kubernetes를 실행시키고 있는 호스트에 대한 physical, virtual infrastructure에 대한 보안도 필요하다.</li>
</ul>
</li>
<li>쿠버네티스와 관련된 security
<ul>
<li><code>kube-apiserver</code>는 모든것을 하는 주체가 되기 때문에 이곳에 대한 보안부터 챙겨야 한다.</li>
<li>Who can access? / What can they do?</li>
<li>API 서버에 누가 접근을 할 수 있게 할 것인가?
<ul>
<li>Files - Username and Passwords</li>
<li>Files - Username and Tokens</li>
<li>Certificates</li>
<li>External Authentication providers - LDAP</li>
<li>Service Accounts</li>
</ul>
</li>
<li>What can they do
<ul>
<li>RBAC Authorization</li>
<li>ABAC Authorization</li>
<li>Node Authorization</li>
<li>Webhook Mode</li>
</ul>
</li>
<li>TLS Certificates
<ul>
<li>모든 controller component들은 TLS Encryption이 되어있다.</li>
</ul>
</li>
<li>Cluster 내의 application에서의 communication
<ul>
<li>모든 파드는 클러스터 내의 모든 파드로 access 할 수 있다.</li>
<li><code>Network Policies</code>를 통해 access를 제한할 수 있다.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="authentication">Authentication</h2>
<ul>
<li>Admin, Developers, End Users, Third Party가 클러스터에 접근한다.</li>
<li>내부 컴포넌트에서의 통신에 보안성을 추가하는 방법과 authentication, authorization 메카니즘으로 클러스터에 접근하는 것에 security management를 할 것이다.</li>
<li>그 중 authentication 메커니즘에 대해 집중할 것이다.</li>
<li>End user에 대한 보안은 어플리케이션 내에서 해야한다.</li>
<li>두가지 방식으로 구분해보면 관리자, 개발자같은 사람인 User와 자동화 프로세스 등을 하는 로봇인 Service Accounts로 구분지을 수 있다.</li>
<li>쿠버네티스는 유저관리같은 것을 원래 지원하지는 않는다.</li>
<li>하지만 Service Account는 쿠버네티스가 지원한다.</li>
<li><code>kube-apiserver</code>는 authenticate user -&gt; proccessing 의 순서로 동작한다.</li>
<li>authenticate machanisms
<ul>
<li>Static Password File</li>
<li>Static Token File</li>
<li>Certificates</li>
<li>Identity Services(LDAP)</li>
</ul>
</li>
<li>static password, token file
<ul>
<li><code>kube-apiserver</code>에 <code>csv</code>형태로 <code>&lt;password&gt;,&lt;user name&gt;,&lt;user ID&gt;</code>를 저장한뒤 전달하면 이를 사용할 수 있다.
<ul>
<li><code>--basic-auth-file=user-details.csv</code> 옵션을 <code>kube-apiserver</code>에 추가하여 적용. restart 필요</li>
<li><code>kubeadm</code>을 사용했다면 pod definition file을 수정해야 한다.</li>
<li>이는 <code>curl</code> 사용 시 <code>-u &quot;user1:password123&quot;</code>의 형태로 사용할 수 있다.</li>
<li><code>csv</code> 파일에 4번째 column을 추가할 수 있는데 이는 <code>&lt;group ID&gt;</code>를 의미한다.</li>
</ul>
</li>
<li>이와 비슷하게 <code>csv</code> 형태로 <code>&lt;token&gt;,&lt;user name&gt;,&lt;user ID&gt;,&lt;group ID&gt;</code>를 저장할 수 있다.
<ul>
<li><code>--token-auth-file=user-details.csv</code> 형태로 적용 가능</li>
<li><code>curl</code> 사용 시 <code>--header &quot;Authorization: Bearer &lt;token&gt;&quot;</code> 형태로 적용이 가능.</li>
</ul>
</li>
</ul>
</li>
<li>static file로 설정하는 것은 추천하는 방법은 아니다.</li>
<li>consider volume mount while providing the auth file in a kubeadm setup.</li>
</ul>
<h2 id="tls-basics">TLS Basics</h2>
<ul>
<li>transaction에서 두 party를 guarantee하기 위해 사용된다.</li>
<li>user가 web server에 접근한다고 생각해보면 둘 간의 통신이 encrypt 되었음을 보장하기 위해 TLS를 사용한다.</li>
<li>데이터를 서버에 전송할 때 key를 통해 encrypt 되기 때문에 이를 받는 서버 또한 key를 가지고 있어야 복호화가 능하다.
<ul>
<li>여기서 암호화/복호화에 동일한 key를 사용하는 것을 Symmetric Encription이라고 한다.</li>
<li>해커가 key를 전송하는 과정 중에 이를 탈취해서 복호화할 가능성이 있다.</li>
</ul>
</li>
<li>asymmetric encryption
<ul>
<li>private key와 public key 두개로 구성</li>
<li>간단하게 생각한다면 private key - public lock의 구성이라고 보면 된다.</li>
<li>private key는 나만 가지고 있고 public key는 공개하여 누구나 암호화할 수 있도록 한다.</li>
</ul>
</li>
<li>SSH를 asynmmetric으로 접근하기
<ul>
<li><code>ssh-keygen</code>을 통해 private key와 public key를 생성한다.</li>
<li>서버를 public key를 통해 암호화한다.
<ul>
<li>public key를 서버에 추가하면 된다.</li>
<li><code>~/.ssh/authorized_keys</code>에 추가.</li>
<li>그 뒤 <code>ssh -i &lt;private key file&gt; user@server</code>로 접속하면 된다.</li>
</ul>
</li>
<li>더 많은 서버에 접속한다면 pulic key만 서버들에 대해 복사하면 된다.</li>
<li>다른 사람도 접근하고자 한다면 private key를 추가하면 된다.</li>
</ul>
</li>
<li>symmetric encryption에서 key를 함께 보낼 때 key를 해커가 탐지할 수 있다.
<ul>
<li>이를 asymmetric encryption으로 key를 암호화한 뒤 보내면 해결 가능.</li>
<li>private key 생성: <code>openssl genrsa -out my-bank.key 1024</code></li>
<li>public key 생성: <code>openssl rsa -in my-bank.key -pubout &gt; mybank.pem</code></li>
</ul>
</li>
<li>유저가 https로 서버에 최초 접근하면 public key를 서버로부터 받게 된다.
<ul>
<li>이 때 자신의 symmetric key를 서버의 Public key로 encryption한 뒤 전송한다.</li>
<li>이를 받으면 서버는 자신의 private key로 복호화를 진행한다.</li>
<li>해커가 이를 가져가도 어떤것을 할 수 없다.</li>
<li>이를 통해 서버와 유저는 symmetric key를 통해 서로 통신한다.</li>
</ul>
</li>
<li>해커는 replica 서버를 만들어서 유저의 symmetric key를 탈취하려 할 것이다.
<ul>
<li>해커의 서버를 보면 key와 함께 certificate를 전송한다.</li>
<li>이 certificate 안에는 Issuer가 있다.
<ul>
<li>이는 그 서버의 identity의 유효성을 검증하는데 매우 중요하다.</li>
</ul>
</li>
<li>Subject은 그 certificate에서 인증하는 서버를 나타낸다.</li>
</ul>
</li>
<li>certificate는 누구나 만들 수 있기 때문에 누가 certificate를 sign하는지가 중요하다.
<ul>
<li>스스로 만들었다면 자신이 sign할 것이고 이를 self-signed certificates라고 한다.</li>
<li>이 self-signed certificates는 안전하지 않은 인증서이다.</li>
<li>따라서 해커가 사용하는 certificates도 self-signed certificates이다.</li>
</ul>
</li>
<li>웹 브라우저는 자동으로 이런 self-signed certificates에 대해 경고를 해준다.</li>
<li>다른 3자에게 인증을 받고자 한다면 Certificates Authority(CA)가 필요하다.
<ul>
<li>이를 위해서는 Certificate Signing Request(CSR)을 전송해야한다.</li>
<li><code>openssl req -new -key my-bank.key -out my-bank.csr -subj &quot;/C=US/ST=CA/O=MyOrg, Inc./CN=my-bank.com</code></li>
<li>CA는 이를 적절히 확인하고 sign 후 응답을 준다.</li>
<li>해커가 CA로부터 인증을 받으려 하면 validation에서 fail이 날 것이다.</li>
<li>그러면 web browser에서 올바른 certificate임을 간주한다.</li>
</ul>
</li>
<li>Web browser는 어떻게 CA가 올바른 CA라고 판정을 하는가
<ul>
<li>CA가 만약 fake CA라면?</li>
<li>어떻게 certificate에 서명된 CA가 진짜 CA라고 판정할 수 있는가.</li>
<li>CA는 private key를 브라우저 내에 심어놓는다.</li>
<li>이를 통해 web browser는 자신에게 온 sign이 진짜 CA가 전송한 것인지 확인이 가능해진다.</li>
</ul>
</li>
<li>PKI(Public Key Infrastructure)</li>
<li>nameing
<ul>
<li>Public Key는 보통 <code>*.crt</code>, <code>*.pem</code> 형식이다.</li>
<li>Private Key는 보통 <code>*.key</code>, <code>*-key.pm</code>
<ul>
<li>보통 key라는 단어를 섞는다.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="tls-in-kubernetes---certificate-creation">TLS in Kubernetes - Certificate Creation</h2>
<ul>
<li>certificate 생성 방법: <code>easyrsa</code>, <code>openssl</code>, <code>cfssl</code></li>
<li>certificate 생성 절차:
<ul>
<li>public key 생성: <code>openssl genrsa -out ca.key 2048</code></li>
<li>certificate signing request: <code>openssl req -new -key ca.key -subj &quot;/CN=KUBERNETES-CA&quot; -out ca.csr</code></li>
<li>sign certificates: <code>openssl x509 -req -in ca.csr -singkey ca.key -out ca.crt</code></li>
</ul>
</li>
<li>client certificate 생성 절차(admin user)
<ul>
<li>private key 생성: <code>openssl genrsa -out admin.key 2048</code></li>
<li>certificate signing request: <code>openssl req -new -key admin.key -subj &quot;/CN=kube-admin/O=system:masters&quot; -out admin.csr</code>
<ul>
<li>반드시 <code>kube-admin</code>일 필요는 없고 <code>kubectl</code>에 사용되는 이름이면 된다.</li>
</ul>
</li>
<li>sign certificates: <code>openssl x509 -req -in admin.csr -CA ca.crt -CAkey ca.key -out admin.crt</code>
<ul>
<li><code>ca.key</code>로 certificate를 validate한다.</li>
</ul>
</li>
<li>admin user라는 것을 certificate에 담으려면 group을 추가하면 된다.
<ul>
<li><code>system-master</code>를 사용해야 한다.</li>
<li>certificate sigining request에 <code>/O=system:masters</code>를 추가하여 나타냄.</li>
</ul>
</li>
</ul>
</li>
<li>system component들은 certificate에서 앞에 <code>SYSTEM:</code>이라는 prefix가 필요하다.
<ul>
<li><code>kube-scheduler</code></li>
<li><code>kube controller manager</code></li>
<li><code>kube-proxy</code></li>
</ul>
</li>
<li>여기서 생성한 certificate를 사용하는 방법
<ul>
<li><code>curl &lt;url&gt; --key &lt;private key&gt; --cert &lt;certificate&gt; --cacert ca.crt</code></li>
<li>또는 <code>kubeconfig</code>에 이 내용을 추가한다.</li>
</ul>
</li>
<li>CA certificate는 우리가 만든 것이기 때문에 파라미터로 넣을때 같이 넣어줘야 인증이 원할하게 된다.</li>
<li><code>kube-apiserver</code>는 IP, domain name이 다양하다.
<ul>
<li><code>kubernetes</code>, <code>kubernetes.default</code>, <code>kubernetes.default.svc</code>, <code>kubernetes.default.svc.cluster.local</code></li>
<li>이런 것들이 모두 certificate에 기록되어야 한다.</li>
<li>방법
<ul>
<li>certificate signing request시 config 파일을 두어 여기에다가 기록해둔다.</li>
<li>
<pre><code class="language-config" data-lang="config">[req]
req_extensions = v3_req
[v3_req]
basicConstraints = CA:FALSE
keyUsage = nonRepudiation,
subjectAltName = @alt_names
[alt_names]
DNS.1 = kubernetes
DNS.2 = kubernetes.default
DNS.3 = kubernetes.default.svc
DNS.4 = kubernetes.default.svc.cluster.local
IP.1 = 10.96.0.1
IP.2 = 172.17.0.87
</code></pre></li>
<li>그 다음 <code>openssl req -new -key apiserver.key -subj &quot;/CN=kube-apiserver&quot; -out apiserver.csr -config openssl.cnf</code>처럼 config 파일을 지정한다.</li>
</ul>
</li>
</ul>
</li>
<li><code>kubelet</code>의 경우 노드마다 떠있게 되는데 여기에 대한 certificate의 name은 노드의 이름을 따온다.
<ul>
<li><code>kubelet-config.yaml</code>에 certificate에 대한 정보를 지정한다.</li>
<li>또한 <code>system:node:</code> prefix를 넣는다.</li>
<li>그리고 <code>SYSTEM:NODES</code> 그룹에 넣어야 한다.</li>
</ul>
</li>
</ul>
<h2 id="view-certificate-details">View Certificate Details</h2>
<ul>
<li>이미 설치된 클러스터 내에서 certificate을 확인하는 방법</li>
<li>쿠버네티스가 어떤 방식으로 설치되어 있는지 알아야 한다.</li>
<li>scartch로 구성을 할 경우 모든 certificate을 스스로 생성한다.</li>
<li><code>kubeadm</code>같은 automation tool을 이용할 경우 모든 certificate을 알아서 구성해준다.</li>
<li><code>kubeadm</code>
<ul>
<li><code>/etc/kubernetes/manifests/kube-apiserver.yaml</code></li>
<li>여기서 <code>--client-ca-file</code>, <code>--etcd-cafile</code>, <code>--etcd-certfile</code>, <code>--etcd-keyfile</code>, <code>--kubelet-client-certificate</code>, <code>--kubelet-client-key</code>, <code>--tls-cert-file</code>, <code>--tls-private-key</code> 확인.</li>
<li><code>--tls-cert-file=/etc/kubernetes/pki/apiserver.crt</code>로 설정되어 있을 경우 다음의 명령어로 조회 가능.
<ul>
<li><code>openssl x509 -in /etc/kubernetes/pki/apiserver.crt -text -noout</code></li>
</ul>
</li>
</ul>
</li>
<li><code>journalctl -u etcd.service -l</code>로 로그 확인</li>
</ul>
<h2 id="certificates-api">Certificates API</h2>
<ul>
<li>새로운 admin이 들어오면, Certificates Request를 작성하게 한 뒤 기존 admin에게 전송하고, 이를 CA 서버에 전달하여 certificate을 생성한 뒤 되돌려준다.
<ul>
<li>이 경우 certificate이 expire되면 다시 이 프로세스대로 반복해야한다.</li>
</ul>
</li>
<li>CA 서버가 있으면 여기에 접속할 수 있는 사람들이 certificate를 마음껏 생성할 수 있다.
<ul>
<li>매우 안전한 서버에다가 구성해야한다.</li>
<li>certificate에 접속하고자 할 경우 반드시 그 서버를 통해야 한다.</li>
</ul>
</li>
<li>쿠버네티스는 Certificate API를 보유하고 있어서 다음과 같은 작업을 할 수 있다.
<ul>
<li>admin이 Certificate Singing Request를 받으면 마스터 노드에 접속해서 직접 sign을 받는 것이 아니라, API를 통해서 한다.</li>
<li><code>CertificateSigningRequest</code> Object를 생성한다.</li>
<li>이를 통해 Request를 받고 Approve한 뒤 User에게 Certificate를 전송한다.</li>
</ul>
</li>
<li>Flow
<ul>
<li><code>openssl genrsa -out jane.key 2048</code></li>
<li><code>openssl req -new -key jane.key -subj &quot;/CN=jane&quot; -out jane.csr</code></li>
<li>이를 <code>base64</code>로 인코딩해서 <code>request</code>에 담는다.</li>
<li><code>kubectl get csr</code>을 통해 조회해보면 <code>status.certificates</code>에 결과가 나온다.</li>
<li>이 결과를 <code>base64</code>로 decode한다.</li>
</ul>
</li>
<li>csr에 관련된 것은 controller manager에서 관리한다.</li>
</ul>
<h2 id="kubeconfig">Kubeconfig</h2>
<ul>
<li>일반적으로 curl 명령어를 통해 <code>kube-apiserver</code>와 통신을 할 수 있다.
*
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">curl https://my-kube-playground:6443/api/v1/pods <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --key admin.key <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --cert admin.crt <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --cacert ca.crt
</code></pre></div></li>
<li><code>kubectl</code>을 이용할 때는 다음과 같이 사용할 수 있다.
*
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl get pods --server my-kube-playground:6443 <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --client-key admin.key <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --client-certificate admin.crt <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --certificate-authority ca.crt
</code></pre></div><ul>
<li>이를 매번 치는 것은 귀찮으니 이를 <code>kubeconfig</code> 파일에 넣을 수 있다.</li>
</ul>
</li>
<li><code>kubeconfig</code>의 default directory는 <code>$HOME/.kube/config</code></li>
<li>3가지 섹션으로 나뉨.
<ul>
<li>cluster
<ul>
<li>접속할 클러스터</li>
</ul>
</li>
<li>users
<ul>
<li>클러스터에 접속하는 유저</li>
</ul>
</li>
<li>contexts
<ul>
<li>클러스터와 유저를 연결하는 것</li>
</ul>
</li>
</ul>
</li>
<li>이미 존재하는 user를 골라야 한다.</li>
<li><code>kubeconfig</code>에서 <code>contexts</code>에 특정한 네임스페이스를 사용하도록 지정할 수 있다.</li>
</ul>
<h2 id="api-groups">API Groups</h2>
<ul>
<li>쿠버네티스에서 api는 각각의 목적에 따라 그룹으로 구성되어 있다.</li>
<li>크게 <code>core</code> 그룹과 <code>named</code> 그룹으로 나뉜다.</li>
<li><code>core</code> group
<ul>
<li><code>/api</code> -&gt; <code>/v1</code> -&gt; <code>namespaces</code>, <code>pods</code> &hellip;</li>
</ul>
</li>
<li>새로운 feature같은 것들은 <code>named</code> 그룹
<ul>
<li><code>/apis</code> -&gt; <code>/apps</code>, <code>extensions</code>, <code>/networking.k8s.io</code>, <code>storage.k8s.io</code>, <code>/authentication.k8s.io</code>, <code>certificates.k8s.io</code></li>
<li>이 <code>/apps</code>, <code>/extensions</code> 등을 API group이라고 한다.</li>
<li>그 아래에 해당하는 api들을 resources라고 부르고, 각 resource는 특정한 verbs를 가지고 있다.</li>
</ul>
</li>
<li>api 문서를 보면 그룹에 관한 자세한 정보가 있다</li>
<li><code>kube-apiserver</code>로 요청을 보내면 사용할 수 있는 api 버전들을 보여준다.</li>
<li>그러나 certificates들을 기입해야 한다.</li>
<li>이를 안하려면 <code>kubectl proxy</code>를 사용하면 된다.</li>
<li>그러면 certificates를 사용하지 않을 수 있다.</li>
<li><code>kubeproxy</code>와 <code>kubectl proxy</code>는 다른 것이다.</li>
</ul>
<h2 id="role-based-access-controls">Role Based Access Controls</h2>
<ul>
<li><code>kind=Role</code>을 통해 어떤 api group, resources, verbs를 사용할 수 있는지 정의할 수 있다.</li>
<li><code>core</code> 그룹을 사용하려면 api group을 공백으로 두면 된다.</li>
<li>이렇게 정의한 role을 유저에게 적용시키려면 <code>kind=RoleBinding</code>이라는 것을 정의하면 된다.</li>
<li><code>kubectl get roles</code> 및 <code>kubectl get rolebindings</code>를 통해 확인할 수 있다.</li>
<li><code>kubectl auth can-i</code>를 통해 어떤 것을 할 수 있는지 확인할 수 있다.
<ul>
<li><code>--as</code>를 통해 user를 특정할 수 있다.</li>
<li><code>--namespace</code>를 통해 네임스페이스에 관해서도 볼 수 있다.</li>
</ul>
</li>
<li><code>resourceNames</code> 필드를 통해 role이 적용되는 resource의 이름을 지정할 수 있다.</li>
</ul>
<h2 id="cluster-roles">Cluster Roles</h2>
<ul>
<li><code>Role</code>과 <code>RoleBindings</code>는 네임스페이스 아래에 있다.</li>
<li>네임스페이스를 지정하지 않으면 default 네임스페이스에 대해서 적용된다.</li>
<li>노드는 clusterwide resource이기 때문에 특정 네임스페이스에 대해서 지정할 수 없다.</li>
<li>리소스는 네임스페이스 또는 클러스터 스코프로 정의된다.</li>
<li>cluster scoped
<ul>
<li><code>nodes</code>, <code>PV</code>, <code>clusterroles</code>, <code>clusterrolebindings</code>, <code>certificatesigningrequests</code> <code>namespaces</code></li>
</ul>
</li>
<li><code>kubectl api-resources --namespaced=true</code>, <code>kubectl api-resources --namespaced=false</code></li>
<li>cluster wide인 리소스에 대해서 <code>Role</code>과 <code>RoleBindings</code>를 설정하는 방법은?</li>
<li><code>ClusterRole</code>을 설정한다.
<ul>
<li>이걸로 전체 네임스페이스에 관한 resource에 대한 권한을 가지기 위해 설정할 수도 있다.</li>
</ul>
</li>
</ul>
<h2 id="image-security">Image Security</h2>
<ul>
<li>private repository를 구축해서 외부로 노출되지 않은 이미지 저장소를 만들 수 있다.</li>
<li>image path를 full path를 써서 사용하면 된다.</li>
<li>credential이 필요하다면 <code>secret</code>을 만들어 <code>docker-registry</code> type을 사용하면 된다. 이는 built-in type이다.
<ul>
<li>이를 <code>podSpec</code>의 <code>imagePullSecrets</code>에 추가하면 된다.</li>
</ul>
</li>
</ul>
<h2 id="security-contexts">Security Contexts</h2>
<ul>
<li><code>securityContexts</code>를 지정하면 기존 docker image에 정의된 security context를 overwrite할 수 있다.
<ul>
<li><code>capability</code>를 설정하여 특정한 capability를 부여할 수 있다.</li>
<li>이는 파드가 아닌 컨테이너 단위로만 설정 가능하다.</li>
</ul>
</li>
</ul>
<h2 id="network-policy">Network Policy</h2>
<ul>
<li>web - api - db가 있을 때 웹을 기준으로 user로부터 들어오는 트래픽을 <code>ingress traffic</code>, app server로 나가는 트래픽을 <code>egress traffic</code>이라고 한다.
<ul>
<li>요청에 대한 응답은 크게 관련 없음.</li>
</ul>
</li>
<li>파드는 라우팅같은 세팅을 통해 어떤 파드에도 접근할 수 있어야 한다.</li>
<li>network policy는 리소스로, 파드에 대해 특정한 룰을 통과하는 트래픽만 흐르게 해주고 나머지는 블럭처리한다.</li>
<li><code>labels</code>로 <code>network policy</code>와 <code>pod</code>를 연결시킨다.</li>
<li>Flannel은 <code>network policies</code>를 지원하지 않는다.</li>
</ul>
<h2 id="tips">Tips</h2>
<ul>
<li>Service Account는 CKAD의 영역.</li>
</ul>


<footer class=" footline" >
	
</footer>


        
            <div id="utterance">    
    <script src="https://utteranc.es/client.js"
            repo="kimmj/kimmj.github.io"
            issue-term="pathname"
            label="comments"
            theme="github-light"
            crossorigin="anonymous"
            async>
    </script>
</div>
        
        </div> 
      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


	 
	 
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1602316121"></script>
    <script src="/js/perfect-scrollbar.min.js?1602316121"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1602316121"></script>
    <script src="/js/jquery.sticky.js?1602316121"></script>
    <script src="/js/featherlight.min.js?1602316121"></script>
    <script src="/js/highlight.pack.js?1602316121"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1602316121"></script>
    <script src="/js/learn.js?1602316121"></script>
    <script src="/js/hugo-learn.js?1602316121"></script>

    <link href="/mermaid/mermaid.css?1602316121" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1602316121"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    
    

  </body>
</html>

