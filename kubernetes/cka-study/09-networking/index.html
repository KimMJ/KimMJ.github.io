<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.62.2" />
    <meta name="description" content="Do Learn">
<meta name="author" content="Myeongjin Kim">

    <link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
    <title>09 Networking :: Ibiza</title>

    
    <link href="/css/nucleus.css?1605889876" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1605889876" rel="stylesheet">
    <link href="/css/hybrid.css?1605889876" rel="stylesheet">
    <link href="/css/featherlight.min.css?1605889876" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1605889876" rel="stylesheet">
    <link href="/css/auto-complete.css?1605889876" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1605889876" rel="stylesheet">
    <link href="/css/theme.css?1605889876" rel="stylesheet">
    <link href="/css/hugo-theme.css?1605889876" rel="stylesheet">
    
      <link href="/css/theme-mine.css?1605889876" rel="stylesheet">
    

    <script src="/js/jquery-3.3.1.min.js?1605889876"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-159865175-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

<script data-ad-client="ca-pub-1788337254638181" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  </head>
  <body class="" data-url="/kubernetes/cka-study/09-networking/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <div >
<img src="https://avatars3.githubusercontent.com/u/6358016?s=460&v=4" style="border-radius: 50%; opacity: 0;"  width="50%" height="50%"/>
</div>
<h3 margin="100px"><p style="color: white">Ibiza</p></h3>
<p style="color: white">기록하는 습관</p>
    </div>
    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/coredns/" title="CoreDNS" class="dd-item 
        
        
        
        ">
      <a href="/coredns/">
          <i class='fas fa-angle-right'></i>&nbsp;CoreDNS
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/harbor/" title="Harbor" class="dd-item 
        
        
        
        ">
      <a href="/harbor/">
          <i class='fas fa-angle-right'></i>&nbsp;Harbor
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/harbor/what-is-harbor/" title="Private Docker Registry 오픈소스: Harbor란" class="dd-item ">
        <a href="/harbor/what-is-harbor/">
        <i class='fas fa-minus'></i>&nbsp;Private Docker Registry 오픈소스: Harbor란
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/harbor/install/" title="Harbor 설치" class="dd-item ">
        <a href="/harbor/install/">
        <i class='fas fa-minus'></i>&nbsp;Harbor 설치
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/git/" title="Git" class="dd-item 
        
        
        
        ">
      <a href="/git/">
          <i class='fas fa-angle-right'></i>&nbsp;Git
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/git/git-secret/" title="git-secret을 통한 github 파일 암호화" class="dd-item ">
        <a href="/git/git-secret/">
        <i class='fas fa-minus'></i>&nbsp;git-secret을 통한 github 파일 암호화
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/git/gitignore/" title="Gitignore 설정" class="dd-item ">
        <a href="/git/gitignore/">
        <i class='fas fa-minus'></i>&nbsp;Gitignore 설정
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/python/" title="Python" class="dd-item 
        
        
        
        ">
      <a href="/python/">
          <i class='fas fa-angle-right'></i>&nbsp;Python
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/python/python-beautiful-cli/" title="[번역]Python을 통해 이쁜 CLI 만들기" class="dd-item ">
        <a href="/python/python-beautiful-cli/">
        <i class='fas fa-minus'></i>&nbsp;[번역]Python을 통해 이쁜 CLI 만들기
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/docker/" title="Docker" class="dd-item 
        
        
        
        ">
      <a href="/docker/">
          <i class='fas fa-angle-right'></i>&nbsp;Docker
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/docker/insecure-registry/" title="http를 사용하는 docker registry를 위한 insecure registry 설정" class="dd-item ">
        <a href="/docker/insecure-registry/">
        <i class='fas fa-minus'></i>&nbsp;http를 사용하는 docker registry를 위한 insecure registry 설정
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docker/use-docker-without-sudo/" title="Docker를 sudo없이 실행하기" class="dd-item ">
        <a href="/docker/use-docker-without-sudo/">
        <i class='fas fa-minus'></i>&nbsp;Docker를 sudo없이 실행하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docker/connect-container-to-container/" title="[docker-compose] container에서 다른 container로 접속하기" class="dd-item ">
        <a href="/docker/connect-container-to-container/">
        <i class='fas fa-minus'></i>&nbsp;[docker-compose] container에서 다른 container로 접속하기
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/jenkins/" title="Jenkins" class="dd-item 
        
        
        
        ">
      <a href="/jenkins/">
          <i class='fas fa-angle-right'></i>&nbsp;Jenkins
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/jenkins/install/" title="Jenkins Install" class="dd-item ">
        <a href="/jenkins/install/">
        <i class='fas fa-minus'></i>&nbsp;Install
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/jenkins/workspace-list/" title="Workspace@2를 변경하기 - Workspace List 설정 변경" class="dd-item ">
        <a href="/jenkins/workspace-list/">
        <i class='fas fa-minus'></i>&nbsp;Workspace@2를 변경하기 - Workspace List 설정 변경
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/iac/" title="IaC" class="dd-item 
        
        
        
        ">
      <a href="/iac/">
          <i class='fas fa-angle-right'></i>&nbsp;IaC
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/iac/translate-what-is-infrastructure-as-a-code/" title="[번역] What Is Infrastructure as a Code? How It Works, Best Practices, Tutorials" class="dd-item ">
        <a href="/iac/translate-what-is-infrastructure-as-a-code/">
        <i class='fas fa-minus'></i>&nbsp;[Translate] What Is Infrastructure as a Code
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/cicd/" title="CICD" class="dd-item 
        
        
        
        ">
      <a href="/cicd/">
          <i class='fas fa-angle-right'></i>&nbsp;CICD
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/cicd/deploy-strategy/" title="Deploy Strategy" class="dd-item ">
        <a href="/cicd/deploy-strategy/">
        <i class='fas fa-minus'></i>&nbsp;Deploy Strategy
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/css/" title="CSS" class="dd-item 
        
        
        
        ">
      <a href="/css/">
          <i class='fas fa-angle-right'></i>&nbsp;CSS
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/css/background-img-darken/" title="background image 어둡게 하기" class="dd-item ">
        <a href="/css/background-img-darken/">
        <i class='fas fa-minus'></i>&nbsp;background image 어둡게 하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/css/greater-than-sign/" title="Greater Than Sign" class="dd-item ">
        <a href="/css/greater-than-sign/">
        <i class='fas fa-minus'></i>&nbsp;Greater Than Sign
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/prometheus/" title="Prometheus" class="dd-item 
        
        
        
        ">
      <a href="/prometheus/">
          <i class='fas fa-angle-right'></i>&nbsp;Prometheus
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/prometheus/install/" title="Install Prometheus" class="dd-item ">
        <a href="/prometheus/install/">
        <i class='fas fa-minus'></i>&nbsp;Install
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/prometheus/federation/" title="Federation" class="dd-item ">
        <a href="/prometheus/federation/">
        <i class='fas fa-minus'></i>&nbsp;Federation
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/kubernetes/" title="Kubernetes" class="dd-item 
        parent
        
        
        ">
      <a href="/kubernetes/">
          <i class='fas fa-angle-right'></i>&nbsp;Kubernetes
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/kubernetes/installation/" title="Install" class="dd-item 
        
        
        
        ">
      <a href="/kubernetes/installation/">
          <i class='fas fa-angle-right'></i>&nbsp;Install
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/installation/overview/" title="Overview" class="dd-item ">
        <a href="/kubernetes/installation/overview/">
        <i class='fas fa-minus'></i>&nbsp;Overview
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/installation/install-kubeadm/" title="Install Kubeadm" class="dd-item ">
        <a href="/kubernetes/installation/install-kubeadm/">
        <i class='fas fa-minus'></i>&nbsp;Install Kubeadm
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/installation/create-a-single-control-plane-cluster-with-kubeadm/" title="Create a Single Control Plane Cluster With Kubeadm" class="dd-item ">
        <a href="/kubernetes/installation/create-a-single-control-plane-cluster-with-kubeadm/">
        <i class='fas fa-minus'></i>&nbsp;Create a Single Control Plane Cluster With Kubeadm
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/kubernetes/cka-study/" title="CKA Study" class="dd-item 
        parent
        
        
        ">
      <a href="/kubernetes/cka-study/">
          <i class='fas fa-angle-right'></i>&nbsp;CKA Study
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/cka-study/02-core-concepts/" title="02 Core Concepts" class="dd-item ">
        <a href="/kubernetes/cka-study/02-core-concepts/">
        <i class='fas fa-minus'></i>&nbsp;02 Core Concepts
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/cka-study/03-scheduling/" title="03 Scheduling" class="dd-item ">
        <a href="/kubernetes/cka-study/03-scheduling/">
        <i class='fas fa-minus'></i>&nbsp;03 Scheduling
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/cka-study/04-logging-and-monitoring/" title="04 Logging and Monitoring" class="dd-item ">
        <a href="/kubernetes/cka-study/04-logging-and-monitoring/">
        <i class='fas fa-minus'></i>&nbsp;04 Logging and Monitoring
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/cka-study/05-application-lifecycle-management/" title="05 Application Lifecycle Management" class="dd-item ">
        <a href="/kubernetes/cka-study/05-application-lifecycle-management/">
        <i class='fas fa-minus'></i>&nbsp;05 Application Lifecycle Management
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/cka-study/06-cluster-maintenance/" title="06 Cluster Maintenance" class="dd-item ">
        <a href="/kubernetes/cka-study/06-cluster-maintenance/">
        <i class='fas fa-minus'></i>&nbsp;06 Cluster Maintenance
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/cka-study/07-security/" title="07 Security" class="dd-item ">
        <a href="/kubernetes/cka-study/07-security/">
        <i class='fas fa-minus'></i>&nbsp;07 Security
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/cka-study/08-storage/" title="08 Storage" class="dd-item ">
        <a href="/kubernetes/cka-study/08-storage/">
        <i class='fas fa-minus'></i>&nbsp;08 Storage
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/cka-study/09-networking/" title="09 Networking" class="dd-item active">
        <a href="/kubernetes/cka-study/09-networking/">
        <i class='fas fa-minus'></i>&nbsp;09 Networking
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/cka-study/10-kubernetes-the-hard-way/" title="10 Kubernetes the Hard Way" class="dd-item ">
        <a href="/kubernetes/cka-study/10-kubernetes-the-hard-way/">
        <i class='fas fa-minus'></i>&nbsp;10 Kubernetes the Hard Way
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/cka-study/12-end-to-end-tests-on-a-kubernetes-cluster/" title="12 End to End Tests on a Kubernetes Cluster" class="dd-item ">
        <a href="/kubernetes/cka-study/12-end-to-end-tests-on-a-kubernetes-cluster/">
        <i class='fas fa-minus'></i>&nbsp;12 End to End Tests on a Kubernetes Cluster
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/cka-study/13-troubleshooting/" title="13 Troubleshooting" class="dd-item ">
        <a href="/kubernetes/cka-study/13-troubleshooting/">
        <i class='fas fa-minus'></i>&nbsp;13 Troubleshooting
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/cka-study/14-other-topics/" title="14 Other Topics" class="dd-item ">
        <a href="/kubernetes/cka-study/14-other-topics/">
        <i class='fas fa-minus'></i>&nbsp;14 Other Topics
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/kubernetes/concepts/" title="Concepts" class="dd-item 
        
        
        
        ">
      <a href="/kubernetes/concepts/">
          <i class='fas fa-angle-right'></i>&nbsp;Concepts
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/concepts/controllers-overview/" title="Controllers Overview" class="dd-item ">
        <a href="/kubernetes/concepts/controllers-overview/">
        <i class='fas fa-minus'></i>&nbsp;Controllers Overview
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/concepts/services/" title="Services" class="dd-item ">
        <a href="/kubernetes/concepts/services/">
        <i class='fas fa-minus'></i>&nbsp;Services
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/concepts/pods/" title="Pods" class="dd-item ">
        <a href="/kubernetes/concepts/pods/">
        <i class='fas fa-minus'></i>&nbsp;Pods
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/cka-epilogue/" title="CKA: Certified Kubernetes Administrator 취득 후기" class="dd-item ">
        <a href="/kubernetes/cka-epilogue/">
        <i class='fas fa-minus'></i>&nbsp;CKA: Certified Kubernetes Administrator 취득 후기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/port-targetport-nodeport-in-kubernetes/" title="[번역] 쿠버네티스에서의 Port, TargetPort, NodePort" class="dd-item ">
        <a href="/kubernetes/port-targetport-nodeport-in-kubernetes/">
        <i class='fas fa-minus'></i>&nbsp;[번역] 쿠버네티스에서의 Port, TargetPort, NodePort
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/kubernetes/stern/" title="Stern을 이용하여 여러 pod의 log를 한번에 확인하기" class="dd-item ">
        <a href="/kubernetes/stern/">
        <i class='fas fa-minus'></i>&nbsp;Stern을 이용하여 여러 pod의 log를 한번에 확인하기
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/hugo/" title="Hugo" class="dd-item 
        
        
        
        ">
      <a href="/hugo/">
          <i class='fas fa-angle-right'></i>&nbsp;Hugo
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/hugo/ibiza/" title="Ibiza" class="dd-item 
        
        
        
        ">
      <a href="/hugo/ibiza/">
          <i class='fas fa-angle-right'></i>&nbsp;Ibiza
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/hugo/ibiza/font-change/" title="Font Change" class="dd-item ">
        <a href="/hugo/ibiza/font-change/">
        <i class='fas fa-minus'></i>&nbsp;Font Change
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/hugo/google-analytics/" title="Hugo에 Google Analytics 적용하기" class="dd-item ">
        <a href="/hugo/google-analytics/">
        <i class='fas fa-minus'></i>&nbsp;Hugo에 Google Analytics 적용하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/hugo/insert-comment/" title="Hugo에 Comment 추가하기 (Utterance)" class="dd-item ">
        <a href="/hugo/insert-comment/">
        <i class='fas fa-minus'></i>&nbsp;Hugo에 Comment 추가하기 (Utterance)
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/hugo/hugo-with-html/" title="HUGO로 HTML이 되지 않을 때 가능하게 하는 방법" class="dd-item ">
        <a href="/hugo/hugo-with-html/">
        <i class='fas fa-minus'></i>&nbsp;hugo with html
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/spinnaker/" title="Spinnaker" class="dd-item 
        
        
        
        ">
      <a href="/spinnaker/">
          <i class='fas fa-angle-right'></i>&nbsp;Spinnaker
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/spinnaker/installation/" title="Installation" class="dd-item 
        
        
        
        ">
      <a href="/spinnaker/installation/">
          <i class='fas fa-angle-right'></i>&nbsp;Installation
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/spinnaker/installation/overview/" title="Overview" class="dd-item ">
        <a href="/spinnaker/installation/overview/">
        <i class='fas fa-minus'></i>&nbsp;Overview
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/spinnaker/installation/install-halyard/" title="Install Halyard" class="dd-item ">
        <a href="/spinnaker/installation/install-halyard/">
        <i class='fas fa-minus'></i>&nbsp;Install Halyard
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/spinnaker/installation/choose-cloud-providers/" title="Choose Cloud Providers" class="dd-item ">
        <a href="/spinnaker/installation/choose-cloud-providers/">
        <i class='fas fa-minus'></i>&nbsp;Choose Cloud Providers
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/spinnaker/installation/choose-your-environment/" title="Choose Your Environment" class="dd-item ">
        <a href="/spinnaker/installation/choose-your-environment/">
        <i class='fas fa-minus'></i>&nbsp;Choose Your Environment
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/spinnaker/installation/choose-a-storage-service/" title="Choose a Storage Service" class="dd-item ">
        <a href="/spinnaker/installation/choose-a-storage-service/">
        <i class='fas fa-minus'></i>&nbsp;Choose a Storage Service
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/spinnaker/installation/deploy-and-connect/" title="Deploy and Connect" class="dd-item ">
        <a href="/spinnaker/installation/deploy-and-connect/">
        <i class='fas fa-minus'></i>&nbsp;Deploy and Connect
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/spinnaker/installation/install-in-air-gaped-environment/" title="Install in Air Gaped Environment" class="dd-item ">
        <a href="/spinnaker/installation/install-in-air-gaped-environment/">
        <i class='fas fa-minus'></i>&nbsp;Install in Air Gaped Environment
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/spinnaker/canaryanalysis/" title="CanaryAnalysis" class="dd-item 
        
        
        
        ">
      <a href="/spinnaker/canaryanalysis/">
          <i class='fas fa-angle-right'></i>&nbsp;CanaryAnalysis
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/spinnaker/canaryanalysis/canary-analysis/" title="Canary Analysis" class="dd-item ">
        <a href="/spinnaker/canaryanalysis/canary-analysis/">
        <i class='fas fa-minus'></i>&nbsp;Canary Analysis
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/spinnaker/tips/" title="Tips" class="dd-item 
        
        
        
        ">
      <a href="/spinnaker/tips/">
          <i class='fas fa-angle-right'></i>&nbsp;Tips
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/spinnaker/tips/pipeline-expressions/" title="Pipeline Expressions" class="dd-item ">
        <a href="/spinnaker/tips/pipeline-expressions/">
        <i class='fas fa-minus'></i>&nbsp;Pipeline Expressions
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/ansible/" title="Ansible" class="dd-item 
        
        
        
        ">
      <a href="/ansible/">
          <i class='fas fa-angle-right'></i>&nbsp;Ansible
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/ansible/create-vm-with-ansible-libvirt/" title="Create Vm With Ansible Libvirt" class="dd-item ">
        <a href="/ansible/create-vm-with-ansible-libvirt/">
        <i class='fas fa-minus'></i>&nbsp;Create Vm With Ansible Libvirt
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/ubuntu/" title="Ubuntu" class="dd-item 
        
        
        
        ">
      <a href="/ubuntu/">
          <i class='fas fa-angle-right'></i>&nbsp;Ubuntu
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/ubuntu/tools/" title="Tools" class="dd-item 
        
        
        
        ">
      <a href="/ubuntu/tools/">
          <i class='fas fa-angle-right'></i>&nbsp;Tools
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/tools/tmux/" title="Tmux" class="dd-item ">
        <a href="/ubuntu/tools/tmux/">
        <i class='fas fa-minus'></i>&nbsp;Tmux
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/ubuntu/network/" title="Network" class="dd-item 
        
        
        
        ">
      <a href="/ubuntu/network/">
          <i class='fas fa-angle-right'></i>&nbsp;Network
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/network/netplan/" title="Netplan으로 static IP 할당받기" class="dd-item ">
        <a href="/ubuntu/network/netplan/">
        <i class='fas fa-minus'></i>&nbsp;Netplan으로 static IP 할당받기
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/customize-login-message/" title="Ubuntu의 Login Message 수정하기" class="dd-item ">
        <a href="/ubuntu/customize-login-message/">
        <i class='fas fa-minus'></i>&nbsp;Ubuntu의 Login Message 수정하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/start-tmux-after-reboot/" title="reboot 후에 tmux를 실행시켜 원하는 작업을 하기" class="dd-item ">
        <a href="/ubuntu/start-tmux-after-reboot/">
        <i class='fas fa-minus'></i>&nbsp;reboot 후에 tmux를 실행시켜 원하는 작업을 하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/oh-my-zsh-home-end-key/" title="oh-my-zsh에서 home key와 end key가 안될 때 해결방법" class="dd-item ">
        <a href="/ubuntu/oh-my-zsh-home-end-key/">
        <i class='fas fa-minus'></i>&nbsp;oh-my-zsh에서 home key와 end key가 안될 때 해결방법
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/base64-encode-decode/" title="Ubuntu에서 Base64로 인코딩, 디코딩하기" class="dd-item ">
        <a href="/ubuntu/base64-encode-decode/">
        <i class='fas fa-minus'></i>&nbsp;Ubuntu에서 Base64로 인코딩, 디코딩하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/file-edit-without-editor/" title="Editor(vi)가 없을 때 파일 수정하기" class="dd-item ">
        <a href="/ubuntu/file-edit-without-editor/">
        <i class='fas fa-minus'></i>&nbsp;Editor(vi)가 없을 때 파일 수정하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/check-listen-port/" title="열려있는 포트 확인하기" class="dd-item ">
        <a href="/ubuntu/check-listen-port/">
        <i class='fas fa-minus'></i>&nbsp;열려있는 포트 확인하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/using-watch-with-pipes/" title="pipe를 사용한 명령어를 watch로 확인하기" class="dd-item ">
        <a href="/ubuntu/using-watch-with-pipes/">
        <i class='fas fa-minus'></i>&nbsp;pipe를 사용한 명령어를 watch로 확인하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/use-alias-in-watch/" title="watch를 사용할 때 alias 이용하기" class="dd-item ">
        <a href="/ubuntu/use-alias-in-watch/">
        <i class='fas fa-minus'></i>&nbsp;watch를 사용할 때 alias 이용하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/ssh-without-password/" title="password 없이 ssh 접속하기" class="dd-item ">
        <a href="/ubuntu/ssh-without-password/">
        <i class='fas fa-minus'></i>&nbsp;password 없이 ssh 접속하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/ssh-tunneling/" title="SSH Tunneling 사용법" class="dd-item ">
        <a href="/ubuntu/ssh-tunneling/">
        <i class='fas fa-minus'></i>&nbsp;SSH Tunneling 사용법
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/ssh-with-jump/" title="Gateway를 이용하여 SSH 접속하기" class="dd-item ">
        <a href="/ubuntu/ssh-with-jump/">
        <i class='fas fa-minus'></i>&nbsp;Gateway를 이용하여 SSH 접속하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/change-hostname/" title="Hostname 변경하기" class="dd-item ">
        <a href="/ubuntu/change-hostname/">
        <i class='fas fa-minus'></i>&nbsp;Hostname 변경하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/unattended-ubuntu/" title="추가 입력절차(prompt) 없이 Ubuntu 설치하는 이미지 만들기" class="dd-item ">
        <a href="/ubuntu/unattended-ubuntu/">
        <i class='fas fa-minus'></i>&nbsp;추가 입력절차(prompt) 없이 Ubuntu 설치하는 이미지 만들기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/how-to-edit-boot-parameter-during-install/" title="Ubuntu 설치 시 Boot Parameter를 수정하기" class="dd-item ">
        <a href="/ubuntu/how-to-edit-boot-parameter-during-install/">
        <i class='fas fa-minus'></i>&nbsp;Ubuntu 설치 시 Boot Parameter를 수정하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ubuntu/how-to-use-sudo-without-password/" title="sudo를 password 없이 사용하기" class="dd-item ">
        <a href="/ubuntu/how-to-use-sudo-without-password/">
        <i class='fas fa-minus'></i>&nbsp;sudo를 password 없이 사용하기
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="https://github.com/KimMJ"><i class='fab fa-github'></i> Github</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://gohugo.io/"><i class='fas fa-bookmark'></i> Hugo Documentation</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://learn.netlify.com/en/"><i class='fas fa-bookmark'></i> Hugo Theme Learn</a>
              </li>
          
              <li> 
                  <a class="padding" href="http://kimmj.github.io/tags"><i class='fas fa-tags'></i> Tags</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>




<div id="docsToc">
  <div class="pi-accordion">
    
    
    
    
    
      
      
    
    
  </div> 
 <button class="push-menu-close-button" onclick="kub.toggleToc()"></button>
</div> 
© 2020 GitHub, Inc.
        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            
            
          
          
            <a href='/'>Ibiza</a> > <a href='/kubernetes/'>Kubernetes</a> > <a href='/kubernetes/cka-study/'>CKA Study</a> > 09 Networking
          
         
          
         
          
         
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#switching-routing">Switching Routing</a></li>
    <li><a href="#dns">DNS</a></li>
    <li><a href="#network-namespaces">Network Namespaces</a></li>
    <li><a href="#docker-networking">Docker Networking</a></li>
    <li><a href="#cni">CNI</a></li>
    <li><a href="#cluster-netwrking">Cluster Netwrking</a></li>
    <li><a href="#pod-networking">Pod Networking</a></li>
    <li><a href="#cni-in-kubernetes">CNI in kubernetes</a></li>
    <li><a href="#cni-weave">CNI weave</a></li>
    <li><a href="#ip-address-management---weave">IP Address Management - Weave</a></li>
    <li><a href="#service-networking">Service Networking</a></li>
    <li><a href="#cluster-dns">Cluster DNS</a></li>
    <li><a href="#coredns-in-kubernetes">CoreDNS in Kubernetes</a></li>
    <li><a href="#ingress">Ingress</a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
<div class="tags">

  <a class="tag-link" href="/tags/kubernetes">kubernetes</a>

  <a class="tag-link" href="/tags/cka">cka</a>

</div>

        </div>
        
        <div id="body-inner">
          
            <h1>
              
              09 Networking
            </h1>
          

        



<nav id="TableOfContents">
  <ul>
    <li><a href="#switching-routing">Switching Routing</a></li>
    <li><a href="#dns">DNS</a></li>
    <li><a href="#network-namespaces">Network Namespaces</a></li>
    <li><a href="#docker-networking">Docker Networking</a></li>
    <li><a href="#cni">CNI</a></li>
    <li><a href="#cluster-netwrking">Cluster Netwrking</a></li>
    <li><a href="#pod-networking">Pod Networking</a></li>
    <li><a href="#cni-in-kubernetes">CNI in kubernetes</a></li>
    <li><a href="#cni-weave">CNI weave</a></li>
    <li><a href="#ip-address-management---weave">IP Address Management - Weave</a></li>
    <li><a href="#service-networking">Service Networking</a></li>
    <li><a href="#cluster-dns">Cluster DNS</a></li>
    <li><a href="#coredns-in-kubernetes">CoreDNS in Kubernetes</a></li>
    <li><a href="#ingress">Ingress</a></li>
  </ul>
</nav>

<h2 id="switching-routing">Switching Routing</h2>
<ul>
<li>Switching
<ul>
<li>컴퓨터 두대를 스위치를 통해 연결하는 방법.</li>
<li>연결된 스위치의 인터페이스에 ip를 할당한다.</li>
<li>동일한 네트워크로만 트래픽을 보내준다.</li>
</ul>
</li>
<li>Routing
<ul>
<li>라우터는 스위치로 연결된 두 네트워크 대역을 연결해준다.</li>
<li>각 네트워크 대역에 대해서 아이피를 동시에 가지고 있다.</li>
</ul>
</li>
<li>Gateway
<ul>
<li>어떤 아이피 대역에 대해서 어떤 라우터를 통해서 가게 할지 결정하는 것</li>
<li>외부 인터넷과 연결하고 싶다면 먼저 인터넷을 라우터에 연결하고, 이 곳으로 route 설정을 하면 된다.</li>
<li>default gateway는 <code>Destination=0.0.0.0</code>인 것.</li>
<li>gateway가 <code>0.0.0.0</code>이라면 라우터가 필요없다는 의미.</li>
</ul>
</li>
<li>기본적으로 <code>/proc/sys/net/ipv4/ip_forward</code>가 <code>0</code>으로 설정되어 자신에게 오는 트래픽이 아닌 경우 포워딩하지 않는다.</li>
</ul>
<h2 id="dns">DNS</h2>
<ul>
<li><code>/etc/hosts</code>에 domain name을 넣을 수 있다.</li>
<li>DNS server에 domain name을 정리하고, 각 컴퓨터에서 이를 조회하도록 한다.</li>
<li><code>/etc/resolv.conf</code>에 nameserver를 넣어서 서버에 있는 dns를 사용할 수 있다.</li>
<li>domain name lookup할 때 local 파일부터 찾고 그 다음에 nameserver에서 검색한다.</li>
<li>DNS server에 <code>Forward All to 8.8.8.8</code>로 public internet의 DNS를 default로 참조하도록 할 수 있다.</li>
<li><code>apps.google.com</code>으로 조회를 하면 <code>root DNS</code>, <code>.com DNS</code>, <code>Google DNS</code>의 순서로 조회하여 IP를 가져오고, 이를 캐싱하게 된다.</li>
<li><code>/etc/resolv.conf</code>에 <code>search</code>를 <code>mycompany.com</code>으로 등록하게 되면 <code>ping web</code>을 입력했을 때 <code>web.mycompany.com</code>으로 검색한다.</li>
<li>Record Types
<ul>
<li>A: IPv4</li>
<li>AAAA: IPv6</li>
<li>CNAME: name alias (name to name mapping)</li>
</ul>
</li>
</ul>
<h2 id="network-namespaces">Network Namespaces</h2>
<ul>
<li>쿠버네티스는 네임스페이스를 기준으로 나누어져 있다.</li>
<li>네임스페이스 안에서는 서로의 프로세스가 무엇인지 볼 수 있다.</li>
<li>컨테이너에서 실행한 것은 호스트에서 프로세스 확인이 가능하다.
<ul>
<li>process ID는 컨테이너 내부와 바깥이 서로 다르다.</li>
</ul>
</li>
<li>컨테이너가 생성되면 네트워크 네임스페이스를 호스트에서 생성한다.
<ul>
<li>컨테이너는 그 안에서 Routing Table과 ARP Table을 가진다.</li>
</ul>
</li>
<li>리눅스 호스트에서 network namespace를 생성하려면 <code>ip netns add red</code>와 같이 입력하면 된다.
<ul>
<li><code>ip netns</code>로 리스트 확인 가능.</li>
</ul>
</li>
<li><code>ip link</code>를 입력하면 interface를 볼 수 있는데 이를 네임스페이스 아래에서 실행하고자 한다면 다음과 같이 하면 된다.
<ul>
<li><code>ip netns exec red ip link</code></li>
<li>또는 <code>ip -n red link</code></li>
</ul>
</li>
<li>나머지도 비슷하다.
<ul>
<li><code>ip netns exec red arp</code></li>
<li><code>ip netns exec red route</code></li>
</ul>
</li>
<li>네트워크 네임스페이스 두개를 연결하려면 파이프를 연결하면 된다(가상의 랜선이라고 생각하면 된다.)
<ul>
<li><code>ip link add veth-red type veth peer name veth-blue</code></li>
<li><code>ip link set veth-red netns red</code></li>
<li><code>ip link set veth-blue netns blue</code></li>
<li><code>ip -n red addr add 192.168.15.1 dev veth-red</code></li>
<li><code>ip -n blue addr add 192.168.15.2 dev veth-blue</code></li>
<li><code>ip -n red link set veth-red up</code></li>
<li><code>ip -n blue link set veth-blue up</code></li>
<li><code>ip netns exec red ping 182.168.15.2</code></li>
</ul>
</li>
<li>virtual switch를 통해 네트워크 네임스페이스를 연결할 수 있다.
<ul>
<li><code>linux bridge</code>, <code>open vswitch</code>가 있다.</li>
<li><code>ip link add v-net-0 type bridge</code></li>
<li><code>ip link set dev v-net-0 up</code></li>
<li><code>ip -n red link del veth-red</code> &lt;- 위에서 생성한 연결을 끊는 것.</li>
<li><code>ip link add veth-red type veth peer name veth-red-br</code></li>
<li><code>ip link add veth-blue type veth peer name veth-blue -br</code></li>
<li><code>ip link set veth-red netns red</code></li>
<li><code>ip link set veth-red-br master v-net-0</code></li>
<li><code>ip link set veth-blue netns blue</code></li>
<li><code>ip link set veth-blue-br master v-net-0</code></li>
<li><code>ip -n red addr add 192.168.15.1 dev veth-red</code></li>
<li><code>ip -n blue addr add 192.168.15.2 dev veth-blue</code></li>
<li><code>ip -n red link set veth-red up</code></li>
<li><code>ip -n blued link set veth-blue up</code></li>
<li>이를 호스트의 네트워크와 연결할 수 있다.
<ul>
<li>virtual switch(bridge)는 호스트의 자원.</li>
<li><code>ip addr add 192.168.15.5/24 dev v-net-0</code>을 추가하면 연결이 가능</li>
</ul>
</li>
<li>외부 인터넷과 연결하려면 호스트의 <code>eth0</code>와 연결을 해야한다.</li>
<li><code>gateway</code>를 추가.</li>
<li><code>ip netns exec blue ip route add 192.168.1.0/24 via 192.168.15.5</code>
<ul>
<li>이 상태에서는 ping이 되지 않음.</li>
<li>private ip를 달고 나가기 때문에 외부에서는 인식하지 못하는 IP.</li>
<li>따라서 NAT를 해야한다.</li>
<li><code>iptables -t nat -A POSTROUTING -s 192.168.15.0/24 -j MASQUERADE</code></li>
</ul>
</li>
</ul>
</li>
<li>외부에서 network namespace로 들어오려면?
<ul>
<li>2가지 해법이 있음.
<ul>
<li>직접 ip 할당하고 라우팅하기</li>
<li><code>iptables -t nat -A PREROUTING --dport 80 --to-destination 192.168.15.2:80 -j DNAT</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="docker-networking">Docker Networking</h2>
<ul>
<li><code>docker run</code>에서 <code>--network none</code>을 하면 컨테이너는 어떤 곳과도 통신할 수 없다.</li>
<li><code>--network host</code>를 사용하여 port를 열면 host의 port가 열린다.</li>
<li><code>--network bridge</code>는 default로 도커 컨테이너끼리 통신이 가능하다.</li>
<li><code>docker</code>는 실행시 default로 brdige를 생성한다.</li>
<li><code>docker network ls</code>를 통해 확인 가능.
<ul>
<li><code>ip link</code>를 통해 <code>docker0</code>를 볼 수 있다.
<ul>
<li><code>ip link add docker0 type bridge</code>를 통해 생성한 것과 동일.</li>
</ul>
</li>
<li><code>ip addr</code>을 통해 보면 ip를 확인할 수 있다. (brdige의 ip)</li>
</ul>
</li>
<li><code>docker run</code>을 하면 도커는 네트워크 네임스페이스를 생성한다.
<ul>
<li><code>ip netns</code>를 보면 확인이 가능하다.</li>
<li><code>docker inspect &lt;container id&gt;</code>를 통해서 어떤 네트워크 네임스페이스인지 확인이 가능하다.</li>
</ul>
</li>
<li>host에서 <code>ip link</code>를 하면 네임스페이스와 bridge(<code>docker0</code>)를 연결한 것이 보인다.
<ul>
<li><code>ip -n &lt;network namespace&gt; link</code>를 하면 컨테이너에서 brdige에 연결한 것이 보인다.</li>
<li><code>ip -n &lt;network namespace&gt; addr</code>을 하면 컨테이너의 아이피를 확인할 수 있다.</li>
</ul>
</li>
<li>컨테이너의 port를 호스트의 port와 연결하려면 <code>-p 8080:80</code>과 같은 옵션을 사용하면 된다.
<ul>
<li>이는 <code>nat</code>를 사용하여 할 수 있다.</li>
<li><code>ip tables -t nat -A DOCKER -j DNAT --dport 8080 --to-destination 172.17.0.3:80</code></li>
<li><code>iptables -nvL -t nat</code>을 통해 확인 가능.</li>
</ul>
</li>
</ul>
<h2 id="cni">CNI</h2>
<ul>
<li>bridge program은 특정한 task를 쭉 실행해준다.</li>
<li><code>bridge add &lt;cid&gt; &lt;namespace&gt;</code>를 통해 할 수 있다.
<ul>
<li>쿠버네티스에서도 이 방식을 사용한다.</li>
</ul>
</li>
<li>container runtime간에 제대로 동작을 하는지 확인하기 위한 표준이 생겼다.
<ul>
<li><code>bridge</code>도 CNI의 plugin 중 하나이다.</li>
</ul>
</li>
<li>CNI 표준
<ul>
<li>Container Runtime은 반드시 network namespace를 생성해야한다.</li>
<li>container가 연결되어야 하는 network를 확인해야한다.</li>
<li>container runtime은 컨테이너가 생성될 때 network plugin(brdige)를 호출해야한다.</li>
<li>container runtime은 컨테이너가 삭제될 때 network plugin(brdige)를 호출해야한다.</li>
<li>JSON 형식으로 network configuration을 할 수 있어야 한다.</li>
</ul>
</li>
<li>Plugin 표준
<ul>
<li>add/del/check에 대한 command line arguments를 제공해야한다.</li>
<li>contianer id, network 등에 대한 파라미터를 제공해야한다.</li>
<li>파드에 할당되는 IP를 관리해야한다.</li>
<li>특정한 형식으로 결과를 리턴해야한다.</li>
</ul>
</li>
<li>Plugin에는 다음과 같은 것들이 있다.
<ul>
<li>bridge</li>
<li>vlan</li>
<li>ipvlan</li>
<li>macvlan</li>
<li>windows</li>
<li>dhcp</li>
<li>host-local</li>
</ul>
</li>
<li>그러나 docker는 CNI 표준을 지키지 않는다.
<ul>
<li>자신만의 독자적인 Container Network Model을 사용한다.</li>
<li>따라서 <code>docker run --network=cni-brdige nginx</code>와 같이 사용할 수는 없다.</li>
<li>하지만 그렇다고 해서 docker에서 아주 못사용하는 것은 아니다.
<ul>
<li><code>docker run --network=none nginx</code>처럼 우선 생성한 뒤 수동으로 plugin을 실행하면 된다.</li>
<li>이 방식을 쿠버네티스에서 사용한다.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="cluster-netwrking">Cluster Netwrking</h2>
<ul>
<li>쿠버네티스는 마스터, 워커 노드가 있고, 이들이 네트워크로 연결이 되어야 한다.</li>
<li>이들은 서로 <code>hostname</code>과 MAC address가 달라야 한다.</li>
<li>마스터 노드는 특정한 포트를 열어야 한다.
<ul>
<li><code>kube-apiserver</code>에서 사용하기 위한 6443 포트</li>
<li><code>kube-scheduler</code>에서 사용하기 위한 10251 포트</li>
<li><code>kube-controller-manager</code>에서 사용하기 위한 10252 포트</li>
<li><code>ETCD</code>에서 사용하기 위한 2379, multi-master일 경우 2380도 열어야 한다.</li>
</ul>
</li>
<li>또한 워커 노드는 <code>kubelet</code>을 위한 10250 포트를 열어야 한다.
<ul>
<li>그리고 service expose를 위한 30000-32767까지의 포트를 열 수 있어야 한다.</li>
</ul>
</li>
</ul>
<h2 id="pod-networking">Pod Networking</h2>
<ul>
<li>pod layer에서의 네트워킹이 중요하다.</li>
<li>파드는 수백개가 생성이 될 수 있는데 이들끼리 서로 통신이 되어야 하고, 아이피가 할당되어야 한다.</li>
<li>쿠버네티스는 built-in solution으로 이를 해결하지 않는다.</li>
<li>다음이 구현되어야 한다.
<ul>
<li>모든 파드는 IP address를 가지고 있다.</li>
<li>모든 파드는 같은 노드 안에서의 파드와 통신할 수 있어야 한다.</li>
<li>모든 파드는 다른 노드에 있는 파드와 NAT가 아닌 방법으로 통신할 수 있어야 한다.</li>
</ul>
</li>
<li>이를 구현한 네트워킹 모델들이 있다. (flannel, calico 등)</li>
<li>강의에서는 이전에 배운 네트워크 네임스페이스를 기반으로 어떻게 동작하는지를 알아볼 것이다.
<ul>
<li>각 노드들은 <code>192.168.1.0</code> 대역을 가지고 있다고 가정한다.</li>
<li>각각의 노드에 대해서 bridge를 생성한다.</li>
<li>그 다음 bridge를 up 한다.</li>
<li>각 노드에 대해서 <code>10.244.1.0/24</code>, <code>10.244.2.0/24</code>, <code>10.244.3.0/24</code>의 네트워크 대역을 가지도록 한다.</li>
<li>그 뒤 컨테이너가 생성될때마다 특정 스크립트를 생성해서 아이피를 할당하고 노드 내부 bridge와 연결한다.</li>
<li>그 다음 각 노드의 파드끼리 route 설정을 넣어준다.</li>
</ul>
</li>
<li>이런 것들을 CNI를 통해서 해결한다.</li>
<li><code>kubelet</code>은 각 노드에 있는 컨테이너의 생성/삭제를 관리한다.
<ul>
<li>따라서 컨테이너가 생성될 때 <code>kubelet</code>을 실행할 때 사용된 arguments에 있는 CNI를 확인하고, script를 실행한다.</li>
</ul>
</li>
</ul>
<h2 id="cni-in-kubernetes">CNI in kubernetes</h2>
<ul>
<li>CNI plugin은 각 <code>kubelet</code>을 실행할 대 arguments로 등록할 수 있다.</li>
<li><code>--cni-bin-dir</code>에서 설정한 디렉토리에는 CNI의 binary 파일들이 있다.</li>
<li><code>--cni-conf</code>에는 어떤 CNI를 사용할지 알파벳 순서로 골라서 사용한다.</li>
</ul>
<h2 id="cni-weave">CNI weave</h2>
<ul>
<li>파드에서 파드로 가는 트래픽은 노드 바깥의 router로 나간 뒤, 알맞은 노드로 들어가서 파드에 전달된다.
<ul>
<li>그러나 이는 수백개의 노드가 각각 수백개의 파드를 가지고 있는 상황에서는 제대로 작동할 수 없다.</li>
<li>라우팅 테이블이 모든것을 담을 수 없다.</li>
</ul>
</li>
<li>weave는 각각의 노드에 agent를 두고, 서로 통신하게 하여 서로의 위치를 확인한다.
<ul>
<li>agent는 다른 노드의 파드로 가는 트래픽을 가로채서 어디로 보낼지 확인한 뒤 트래픽을 감싼다.</li>
<li>해당 트래픽은 다른 노드로 전달된 뒤에 agent가 다시 가로채서 트래픽을 확인하고 원하는 파드로 전달한다.</li>
</ul>
</li>
</ul>
<h2 id="ip-address-management---weave">IP Address Management - Weave</h2>
<ul>
<li>어떻게 노드의 Virtual Brdige가 IP를 할당하는지에 대해 알아볼 것이다.</li>
<li>network plugin에 의존하여 CNI는 IP를 할당한다.
<ul>
<li>쿠버네티스는 할당한 IP의 관리에는 영향을 주지 않는다.</li>
</ul>
</li>
<li><code>/etc/cni/net.d/net-script.conf</code>에는 사용하는 CNI에 대한 정보가 적혀있다(<code>IPAM</code>).</li>
<li><code>weaveworks</code>는 <code>10.32.0.0/12</code>로 IP 대역을 파드에 할당하려 하고 각 노드에 <code>10.32.0.1</code>, <code>10.38.0.1</code>, <code>10.44.0.0</code>으로 IP 대역을 나누어 노드에 할당한다.</li>
<li>customization이 가능하다.</li>
</ul>
<h2 id="service-networking">Service Networking</h2>
<ul>
<li>서비스가 생성되었을 때에도 노드의 위치에 상관없이 모든 파드에서 접근이 가능해야한다.</li>
<li>서비스는 특정 노드에 bound되는 것이 아니라 노드 전역에 걸쳐 생성된다.</li>
<li>ClusterIP는 클러스터 내부에서만 연결이 된다.
<ul>
<li>DB처럼 클러스터 내부에서만 통신하려는 목적이면 ClusterIP를 사용하면 된다.</li>
</ul>
</li>
<li>외부로 노출하기 위해서는 NodePort를 사용한다.
<ul>
<li>IP를 가지는것 뿐만 아니라 노드에서 포트를 할당받기도 한다.</li>
</ul>
</li>
<li>service는 단순히 virtual object로 어딘가에 생성되는 것이 아니다.
<ul>
<li>쿠버네티스에 serivce를 생성하면 미리 설정된 범위에서 IP 주소를 할당받는다.</li>
<li>할당받은 IP 주소로 forwarding rule이 생성된다.</li>
<li>단순히 IP로 forwarding하지 않고 IP:port로 forwarding한다</li>
</ul>
</li>
<li><code>userspace</code>, <code>iptables</code>, <code>ipvs</code> 모드로 <code>kube-proxy</code>가 설정될 수 있으며 기본은 <code>iptables</code>이다.</li>
<li>service의 ip range는 <code>kube-api-server</code>에서 default로 <code>10.0.0.0/24</code>로 설정되어있다.</li>
<li>pod ip range와 service ip range는 겹치면 안된다.</li>
<li><code>kube-proxy</code>의 로그를 보면 어떻게 iptables를 조작했는지 볼 수 있다.</li>
</ul>
<h2 id="cluster-dns">Cluster DNS</h2>
<ul>
<li>쿠버네티스는 설치시 자신만의 DNS 서버를 가진다.</li>
<li>서비스가 생성이 될때, hostname과 IP 주스를 해당 서비스에 맞게 등록한다.</li>
<li>파드 내에서는 해당 domain을 통해 접근할 수 있다.</li>
<li>동일한 네임스페이스에서는 <code>service name</code>만 가지고 접근할 수 있다.</li>
<li>다른 네임스페이스에 있는 경우 <code>&lt;service name&gt;.&lt;namespace&gt;</code>로 접근해야한다.</li>
<li><code>apps</code> namespace 안의 <code>web-service</code>가 있는 경우
<ul>
<li><code>hostname</code>: <code>web-service</code></li>
<li><code>namespace</code>: <code>apps</code></li>
<li><code>type</code>: <code>svc</code></li>
<li><code>root</code>: <code>cluster.local</code></li>
</ul>
</li>
<li>pod에 대해서도 dns에 등록이 된다. 그러나 IP 주소를 <code>10-244-2-5</code>와 같이 dash를 통해 구분할 뿐이다.
<ul>
<li><code>type</code>: <code>pod</code></li>
</ul>
</li>
</ul>
<h2 id="coredns-in-kubernetes">CoreDNS in Kubernetes</h2>
<ul>
<li>여러 서비스 및 파드가 생성/삭제될 때 domain을 정리하기 위해 중앙의 DNS 서버를 사용한다.</li>
<li>파드 내에서는 <code>/etc/resolv.conf</code>에서 nameserver로 등록한다.</li>
<li>새로운 파드가 생기면 DNS 서버에 엔트리를 추가한다.</li>
<li>1.12 이전에는 <code>kube-dns</code>를 사용했지만 이후로는 <code>CoreDNS</code>를 권장한다.</li>
<li><code>CoreDNS</code>는 <code>kube-system</code> namespace에 파드로 배포되어있다.
<ul>
<li><code>Deployment</code>로 두개가 동작중이다.</li>
</ul>
</li>
<li><code>CoreDNS</code>는 <code>Corefile</code>이라는 파일을 이용한다.
<ul>
<li>여기에 <code>kubernetes</code>라는 plugin 구역을 보면 된다.</li>
<li>root domain이 적혀있다.</li>
<li><code>pods insecure</code> 부분은 파드에 대한 record를 관리할지를 결정한다.
<ul>
<li>default로 disable이다.</li>
</ul>
</li>
<li><code>proxy</code> 부분은 dns에 등록되지 않은 것들을 <code>/etc/resolv.conf</code>에서 검색하도록 설정되어있다.</li>
<li>이 파일은 <code>configmap</code>으로 전달된다.</li>
</ul>
</li>
<li>파드에서 DNS 서버에 접근할 떄는 service사용한다.
<ul>
<li>기본적으로 <code>CoreDNS</code>도 <code>kube-dns</code> 이름으로 사용한다.</li>
<li>이는 파드가 생성될 때 자동으로 IP를 기입한다. (<code>/etc/resolv.conf</code>)</li>
<li><code>kubelet</code>이 설정한다.
<ul>
<li>option으로 설정되어있음.</li>
</ul>
</li>
<li><code>/etc/resolv.conf</code>에 <code>search</code> 항목으로 <code>default.svc.cluster.local</code>, <code>svc.cluster.local</code>, <code>cluster.local</code>이 설정되어 있어서 간단하게 이름만 입력해도 근이 가능한 것이다.
<ul>
<li>그러나 pod는 정의되어있지 않아서 FQDN으로 접근해야한다.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="ingress">Ingress</h2>
<ul>
<li>service와 ingress의 차이점은 무엇인가?</li>
<li>일반적으로 NodePort로 expose하면 30000 이상의 port(ex: 38080)를 사용하게 된다.
<ul>
<li>유저가 80포트를 통해 접속하도록(http) 하려면 proxy server를 둬서 트래픽을 80에서 38080으로 전달해야 한다.</li>
<li>LoadBalancer를 사용할 때도 이와 비슷하다.</li>
</ul>
</li>
<li>Ingress는 유저가 하나의 external accessble URL을 통해 클러스터내의 서비스에 접속할 수 있게 해준다.
<ul>
<li>https설정도 할 수 있다.</li>
<li>ingress 또한 expose해야한다.</li>
<li>NodePort 또는 LoadBalancer.</li>
<li>그러나 서비스가 늘어나도 한번만 수행하면 된다.</li>
</ul>
</li>
<li>ingress controller, ingress resources로 ingress 설정을 한다.
<ul>
<li>default로 설치되어있지 않음.</li>
<li>GCE와 Nginx는 쿠버네티스 프로젝트에서 관리한다.</li>
</ul>
</li>
<li>nginx는 configmap으로 nginx의 설정을 한다.
<ul>
<li>ServiceAccount를 통해 적절한 권한을 줘야 한다.</li>
</ul>
</li>
<li>ingress resource는 url에 따라 다른 파드로 트래픽을 전달할 수 있다.</li>
<li>ingress에 backend로 serviceName과 servicePort를 지정하여 트래픽을 전달할 수 있다.
<ul>
<li>해당 ingress로 온 트래픽은 모두 serviceName으로 전달된다.</li>
</ul>
</li>
<li>각각의 rule을 지정하여 원하는 서비스에 트래픽을 전달할 수 있다.
<ul>
<li>host를 따로 지정하지 않으면 모든 트래픽에 대해 매칭이 된다.</li>
</ul>
</li>
</ul>


<footer class=" footline" >
	
</footer>


        
            <div id="utterance">    
    <script src="https://utteranc.es/client.js"
            repo="kimmj/kimmj.github.io"
            issue-term="pathname"
            label="comments"
            theme="github-light"
            crossorigin="anonymous"
            async>
    </script>
</div>
        
        </div> 
      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


	 
	 
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1605889876"></script>
    <script src="/js/perfect-scrollbar.min.js?1605889876"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1605889876"></script>
    <script src="/js/jquery.sticky.js?1605889876"></script>
    <script src="/js/featherlight.min.js?1605889876"></script>
    <script src="/js/highlight.pack.js?1605889876"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1605889876"></script>
    <script src="/js/learn.js?1605889876"></script>
    <script src="/js/hugo-learn.js?1605889876"></script>

    <link href="/mermaid/mermaid.css?1605889876" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1605889876"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    
    

  </body>
</html>

